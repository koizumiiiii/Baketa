{
  "Logging": {
    "LogLevel": {
      "Default": "Debug",
      "Microsoft.AspNetCore": "Warning",
      "Baketa.Infrastructure.Translation": "Debug",
      "Baketa.UI.Services": "Debug",
      "Baketa.Application.Services": "Debug",
      "Baketa.UI.ViewModels": "Debug",
      "Baketa.Core.Events.Handlers.PriorityAwareOcrCompletedHandler": "Information",
      "Baketa.Application.EventHandlers.TranslationWithBoundsCompletedHandler": "Information",
      "Baketa.Infrastructure.OCR": "Debug"
    },
    "DebugLogPath": "debug_app_logs.txt",
    "EnableDebugFileLogging": true,
    "MaxDebugLogFileSizeMB": 10,
    "DebugLogRetentionDays": 7
  },
  "Translation": {
    "DefaultEngine": "NLLB200",
    "EnabledEngines": ["NLLB200", "Gemini"],
    "AutoDetectSourceLanguage": false,
    "UseExternalServer": true,
    "UseConnectionPool": false,
    "PreventSameLanguageTranslation": true,
    "LogSkippedTranslations": true,
    "SameLanguageDetectionMode": "Strict",
    "DefaultSourceLanguage": "en",
    "DefaultTargetLanguage": "ja",
    "EnableServerAutoRestart": true,
    "MaxConsecutiveFailures": 3,
    "RestartBackoffMs": 5000,
    "ServerStartupTimeoutMs": 30000,
    "HealthCheckIntervalMs": 30000,
    "Languages": {
      "SupportedLanguages": [
        {
          "Code": "auto",
          "Name": "自動検出",
          "NativeName": "Auto Detect",
          "IsAutoDetect": true,
          "IsSupported": true
        },
        {
          "Code": "en",
          "Name": "English",
          "NativeName": "English",
          "RegionCode": "US",
          "IsSupported": true
        },
        {
          "Code": "ja",
          "Name": "日本語",
          "NativeName": "日本語",
          "RegionCode": "JP",
          "IsSupported": true
        },
        {
          "Code": "zh",
          "Name": "中国語（自動）",
          "NativeName": "中文（自动）",
          "OpusPrefix": "",
          "Variant": "Auto",
          "IsSupported": false
        },
        {
          "Code": "zh-Hans",
          "Name": "中国語（簡体字）",
          "NativeName": "中文（简体）",
          "OpusPrefix": ">>cmn_Hans<<",
          "Variant": "Simplified",
          "RegionCode": "CN",
          "IsSupported": false
        },
        {
          "Code": "zh-Hant",
          "Name": "中国語（繁体字）",
          "NativeName": "中文（繁體）",
          "OpusPrefix": ">>cmn_Hant<<",
          "Variant": "Traditional",
          "RegionCode": "TW",
          "IsSupported": false
        },
        {
          "Code": "yue",
          "Name": "広東語",
          "NativeName": "粵語",
          "OpusPrefix": ">>yue<<",
          "Variant": "Cantonese",
          "RegionCode": "HK",
          "IsSupported": false
        },
        {
          "Code": "ko",
          "Name": "韓国語",
          "NativeName": "한국어",
          "RegionCode": "KR",
          "IsSupported": false
        },
        {
          "Code": "es",
          "Name": "スペイン語",
          "NativeName": "Español",
          "RegionCode": "ES",
          "IsSupported": false
        },
        {
          "Code": "fr",
          "Name": "フランス語",
          "NativeName": "Français",
          "RegionCode": "FR",
          "IsSupported": false
        },
        {
          "Code": "de",
          "Name": "ドイツ語",
          "NativeName": "Deutsch",
          "RegionCode": "DE",
          "IsSupported": false
        },
        {
          "Code": "ru",
          "Name": "ロシア語",
          "NativeName": "Русский",
          "RegionCode": "RU",
          "IsSupported": false
        },
        {
          "Code": "ar",
          "Name": "アラビア語",
          "NativeName": "العربية",
          "RegionCode": "SA",
          "IsRightToLeft": true,
          "IsSupported": false
        }
      ],
      "EnableChineseVariantAutoDetection": false,
      "EnableLanguageDetection": true
    },
    "LanguagePairs": {
      "ja-en": {
        "Engine": "NLLB200",
        "ModelName": "facebook/nllb-200-distilled-600M",
        "Priority": 1,
        "IsSupported": true,
        "Description": "日本語→英語NLLB200高品質翻訳"
      },
      "en-ja": {
        "Engine": "NLLB200",
        "ModelName": "facebook/nllb-200-distilled-600M",
        "Priority": 1,
        "IsSupported": true,
        "Description": "英語→日本語NLLB200高品質翻訳"
      },
      "zh-en": {
        "Engine": "NLLB200",
        "ModelName": "facebook/nllb-200-distilled-600M",
        "Priority": 1,
        "IsSupported": false,
        "Description": "中国語→英語NLLB200高品質翻訳"
      },
      "en-zh": {
        "Engine": "NLLB200",
        "ModelName": "facebook/nllb-200-distilled-600M",
        "Priority": 1,
        "ChineseVariantSupport": true,
        "IsSupported": false,
        "Description": "英語→中国語NLLB200高品質翻訳（簡体字・繁体字対応）"
      },
      "zh-ja": {
        "Engine": "NLLB200",
        "ModelName": "facebook/nllb-200-distilled-600M",
        "Priority": 1,
        "IsSupported": false,
        "Description": "中国語→日本語NLLB200高品質翻訳"
      },
      "ja-zh": {
        "Engine": "NLLB200",
        "ModelName": "facebook/nllb-200-distilled-600M",
        "Priority": 1,
        "IsSupported": false,
        "Description": "日本語→中国語NLLB200高品質翻訳"
      },
      "ja-zh-Hans": {
        "Engine": "NLLB200",
        "ModelName": "facebook/nllb-200-distilled-600M",
        "TargetVariant": "Simplified",
        "Priority": 1,
        "IsSupported": false,
        "Description": "日本語→簡体字中国語NLLB200高品質翻訳"
      },
      "ja-zh-Hant": {
        "Engine": "NLLB200",
        "ModelName": "facebook/nllb-200-distilled-600M",
        "TargetVariant": "Traditional",
        "Priority": 1,
        "IsSupported": false,
        "Description": "日本語→繁体字中国語NLLB200高品質翻訳"
      }
    },
    "TwoStageTranslation": {
      "EnableFallback": true,
      "LogIntermediateResults": true,
      "MaxRetries": 2,
      "TimeoutSeconds": 30,
      "QualityThreshold": 0.7
    },
    "TranslationEngine": {
      "Strategies": {
        "LocalOnly": {
          "Description": "NLLB-200のみ使用（高品質・無料）",
          "UseCase": "短いテキスト、よく知られたフレーズ、一般的な翻訳",
          "Cost": "無料",
          "Speed": "高速（< 500ms）",
          "Quality": "高品質",
          "Offline": true
        },
        "CloudOnly": {
          "Description": "Gemini APIのみ使用（高品質・有料）",
          "UseCase": "複雑なテキスト、専門用語、文学的表現、高品質が必要な翻訳",
          "Cost": "有料（APIトークン使用量に応じて）",
          "Speed": "中速（< 2000ms）",
          "Quality": "高品質",
          "Offline": false
        }
      },
      "useExternalServer": true
    },
    "MaxConnections": 1,
    "MinConnections": 1,
    "OptimalChunksPerConnection": 4,
    "ConnectionTimeoutMs": 5000,
    "NLLB200": {
      "ServerHost": "127.0.0.1",
      "ServerPort": 5556,
      "ModelName": "facebook/nllb-200-distilled-600M",
      "HealthCheckIntervalSeconds": 30,
      "ConnectionTimeoutMs": 5000,
      "ResponseTimeoutMs": 10000,
      "MaxRetries": 3,
      "RetryDelayMs": 1000,
      "AutoStartServer": true,
      "ServerScriptPath": "scripts/nllb_translation_server.py",
      "ServerStartTimeoutMs": 60000,
      "EnableQualityLogging": true,
      "Description": "Meta NLLB-200高品質多言語翻訳モデル"
    }
  },
  "OCR": {
    "DetectionThreshold": 0.3,
    "RecognitionThreshold": 0.3,
    "LogPerformanceMetrics": true,
    "LogModelInfo": true,
    "EnableDebugLogging": true,
    "PaddleOCR": {
      "Language": "jpn",
      "EnableHybridMode": true,
      "UseGpu": false,
      "EnableMultiThread": true,
      "WorkerCount": 4,
      "UseLanguageModel": true,
      "EnablePreprocessing": true,
      "DetectionThreshold": 0.3,
      "RecognitionThreshold": 0.3
    },
    "HybridStrategy": {
      "FastDetectionModel": "V3",
      "HighQualityModel": "V5",
      "ImageQualityThreshold": 0.6,
      "RegionCountThreshold": 5,
      "FastDetectionTimeoutMs": 500,
      "HighQualityTimeoutMs": 3000
    }
  },
  "ImageChangeDetection": {
    "Stage1SimilarityThreshold": 0.92,
    "Stage2ChangePercentageThreshold": 0.05,
    "Stage3SSIMThreshold": 0.92,
    "RegionSSIMThreshold": 0.95,
    "EnableCaching": true,
    "MaxCacheSize": 1000,
    "CacheExpirationMinutes": 30,
    "EnablePerformanceLogging": true,
    "Description": "P0 画像変化検知システム設定 - 3段階フィルタリングパイプライン"
  },
  "DiagnosticsSettings": {
    "EnableRoiImageOutput": true,
    "RoiImageOutputPath": "%AppData%\\Baketa\\ROI\\Images",
    "RoiImageFormat": "PNG",
    "EnableAdvancedDiagnostics": true,
    "MaxImageFileRetentionDays": 7,
    "EnableMetadataOutput": true,
    "EnableAnnotatedImages": true,
    "EnableCaptureImageSaving": true,
    "CaptureImageOutputPath": "%AppData%\\Baketa\\Capture\\Images",
    "EnableScaledImageSaving": true,
    "AdvancedSettings": {
      "SaveOriginalImages": true,
      "SaveProcessedImages": false,
      "SaveErrorImages": true,
      "CompressImages": false,
      "ImageQuality": 95,
      "EnableTimestampPrefix": true,
      "EnableOperationIdSuffix": true
    }
  },
  "GeminiApi": {
    "ApiKey": "your-gemini-api-key-here",
    "ApiEndpoint": "https://generativelanguage.googleapis.com/v1/models/",
    "ModelName": "gemini-1.5-pro",
    "TimeoutSeconds": 30,
    "RetryCount": 3,
    "RetryDelaySeconds": 1,
    "RateLimitPerMinute": 60,
    "MaxTokens": 1000,
    "Temperature": 0.3,
    "EnableFallback": true,
    "EnableCache": true,
    "CacheExpirationMinutes": 60,
    "EnableUsageLogging": true,
    "EnableCostMonitoring": true,
    "MaxDailyCostUsd": 10.0,
    "EnablePromptOptimization": true,
    "EnableResponseValidation": true,
    "EnableDebugLogging": false
  },
  "HybridTranslation": {
    "ShortTextThreshold": 50,
    "LongTextThreshold": 500,
    "HighComplexityThreshold": 10.0,
    "LowComplexityThreshold": 3.0,
    "ShortTextStrategy": "LocalOnly",
    "LongTextStrategy": "CloudOnly",
    "HighComplexityStrategy": "CloudOnly",
    "LowComplexityStrategy": "LocalOnly",
    "DefaultStrategy": "LocalOnly",
    "EnableCache": true,
    "CacheExpirationMinutes": 60
  },
  "TranslationEngineStatus": {
    "MonitoringIntervalSeconds": 30,
    "NetworkTimeoutMs": 5000,
    "RateLimitWarningThreshold": 10,
    "EnableHealthChecks": true,
    "EnableRealTimeUpdates": true,
    "MaxRetries": 3,
    "RetryDelaySeconds": 5
  },
  "OpenVINO": {
    "Enabled": true,
    "NumThreads": 0,
    "CacheDirectory": "Models/OpenVINO/cache",
    "EnableDynamicShapes": false,
    "EnableCpuOptimization": true,
    "EnableGpuOptimization": true,
    "Priority": 80,
    "EnableFallback": true
  },
  "DirectML": {
    "Enabled": true,
    "DeviceId": 0,
    "EnableGraphCapture": true,
    "EnableDynamicGraphFusion": true,
    "EnableMetacommands": true,
    "EnableDebugLogging": false,
    "EnableFallback": true,
    "Priority": 75
  },
  "UnifiedGpu": {
    "Enabled": true,
    "EnableAutoSelection": true,
    "EnableFallback": true,
    "EnableBenchmarkOnStartup": false,
    "ProviderCacheExpirationMinutes": 60,
    "EnableDetailedLogging": false,
    "Note": "ProviderPrioritiesは参考値。実際の優先度はFactory設定を基準に環境別微調整が行われる"
  },
  "GpuBenchmark": {
    "EnableWarmup": true,
    "WarmupIterations": 3,
    "MonitorMemoryUsage": true,
    "IncludeDetailedMetrics": true,
    "MaxExecutionTimeMinutes": 10,
    "EnableParallelExecution": true
  },
  "ResourceMonitoring": {
    "MonitoringIntervalMs": 5000,
    "HistoryRetentionMinutes": 60,
    "CpuWarningThreshold": 85.0,
    "MemoryWarningThreshold": 90.0,
    "GpuWarningThreshold": 95.0,
    "EnableGpuMonitoring": true,
    "EnableEventPublishing": true
  },
  "GpuSettings": {
    "DedicatedGpuKeywords": [
      "RTX", "GTX", "Tesla", "Titan", "Quadro",
      "RX ", "Radeon RX", "Radeon VII",
      "Arc A", "Intel Arc"
    ],
    "IntegratedGpuKeywords": [
      "UHD", "Iris", "Intel(R) HD", "Intel HD",
      "AMD Radeon Graphics", "Radeon Graphics",
      "AMD Radeon(TM) Graphics", "Radeon(TM) Graphics"
    ],
    "FallbackToDedicated": true,
    "Note": "新しいGPUモデルは再コンパイル不要でここに追加可能。FallbackToDedicatedは未知GPUを専用として扱う設定。"
  },
  "HybridResourceManagement": {
    "OcrChannelCapacity": 100,
    "TranslationChannelCapacity": 50,
    "InitialOcrParallelism": 2,
    "MaxOcrParallelism": 4,
    "InitialTranslationParallelism": 1,
    "MaxTranslationParallelism": 2,
    "CpuLowThreshold": 50,
    "CpuHighThreshold": 70,
    "MemoryLowThreshold": 60,
    "MemoryHighThreshold": 85,
    "GpuLowThreshold": 40,
    "GpuHighThreshold": 75,
    "VramLowThreshold": 50,
    "VramHighThreshold": 80,
    "MaxCooldownMs": 500,
    "HysteresisTimeoutSeconds": 3,
    "SamplingIntervalMs": 1000,
    "EnableGpuMonitoring": true,
    "EnableDynamicParallelism": true,
    "EnableDetailedLogging": true,
    "Note": "Phase 2: ハイブリッドリソース管理システム - OCR⇔翻訳の動的リソース競合制御"
  },
  "SmartProcessingPipeline": {
    "EnableStaging": true,
    "EnableEarlyTermination": true,
    "StopOnFirstError": false,
    "Note": "P0 段階的フィルタリングシステム - 画像変化検知によるパイプライン制御"
  },
  
  "TimedAggregator": {
    "IsFeatureEnabled": true,
    "AggregationTimeoutMs": 2000,
    "MaxChunksPerAggregation": 10,
    "EnableChunkMerging": true,
    "EnableCoordinateBasedLineBreak": true,
    "LineBreakDistanceThreshold": 50.0,
    "EnableDebugLogging": true,
    "Note": "UltraThink: 時間軸統合システム - TextChunk集約による翻訳品質40-60%向上",
    "ProximityGrouping": {
      "Enabled": true,
      "VerticalDistanceFactor": 0.4,
      "HorizontalDistanceFactor": 3.0,
      "CrossRowHorizontalDistanceFactor": 2.0,
      "MaxCrossRowHorizontalGapPixels": 100,
      "EnableDetailedLogging": true,
      "MinChunkHeight": 8,
      "MaxChunkHeight": 200,
      "StatisticsLogInterval": 10
    }
  },
  
  "AutoOverlayCleanup": {
    "MinConfidenceScore": 0.7,
    "MaxCleanupPerSecond": 10,
    "TextDisappearanceChangeThreshold": 0.05,
    "StatisticsLogInterval": 100,
    "InitializationTimeoutMs": 10000,
    "_comment": "UltraThink Phase 1: オーバーレイ自動削除システム設定（Gemini Review対応：設定外部化）"
  },

  "CircuitBreaker": {
    "FailureThreshold": 5,
    "TimeoutMs": 120000,
    "RecoveryTimeoutMs": 60000,
    "_comment": "翻訳タイムアウト問題解決: NLLB-200初回モデルロード時間(最大90秒)を考慮して120秒に設定"
  }
}
