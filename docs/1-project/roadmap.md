# Baketa プロジェクト開発ロードマップ

## 1. プロジェクト開発方針

> **重要**: Baketaプロジェクトは、Windows専用アプリケーションとして開発され、OCR最適化にはOpenCVを使用します。

## 2. 全体計画

Baketaプロジェクトは以下のフェーズで開発を進めます：

### フェーズ1: 基盤システム
- コア機能とインフラ
- 基本的なデータモデルとインターフェース
- エラーハンドリング基盤
- 設定管理システム
- ロギングシステム基盤
- デバッグモード設定

### フェーズ2: OCR機能
- PaddleOCR統合
- 差分検出システム
- OCRテストと最適化（OpenCVベース）
- OCR設定UIとアーキテクチャ
- プレビュー・テスト機能

### フェーズ3: 翻訳機能
- 翻訳システム基盤
- 翻訳キャッシュ
- ONNXモデル管理システム
- トークナイザー実装
- ONNX翻訳エンジン実装
- 自動切り替え機能

### フェーズ4: UI実装
- Avalonia UIフレームワーク実装
- メインウィンドウとシステムトレイ
- オーバーレイウィンドウ
- 設定画面

### フェーズ5: アーキテクチャ改善
- 新アーキテクチャへの移行
- インターフェース階層の整理
- Windows依存コードの整理
- イベント集約機構の導入
- 依存性注入の最適化

### フェーズ6: 配布と運用
- インストーラー作成
- 更新システム
- エラー報告システム
- フィードバック収集

## 3. 重点目標

以下の重点目標で開発を進めます：

### 3.1 アーキテクチャ改善プロジェクト
- 新しいインターフェース定義の作成
- アダプターパターンの実装
- コアモジュールの移行
- Windows依存コードの整理
- アプリケーション層とUI層の構築

### 3.2 OCRシステムの強化
- OCRエンジン基盤の単体テスト
- OpenCVベースのOCR最適化
- OCRモデルの自動ダウンロード機能
- OCRシステムのドキュメンテーション

### 3.3 Windows機能拡張
- Windows 11最適化
- ハイDPI対応の強化
- マルチモニタサポートの改善
- パフォーマンス最適化

## 4. 優先項目

### 最優先項目
1. **新アーキテクチャインターフェース定義**
   - 新しい名前空間構造とインターフェース定義
   - クリーンアーキテクチャに基づく設計
   - 依存関係の明確化

2. **Windows依存コードの整理**
   - プラットフォーム抽象化レイヤーの実装
   - Windows APIラッパーの整理
   - インフラストラクチャ層への分離

3. **OCRエンジン基盤の単体テスト**
   - テストフレームワークの構築
   - コア機能のユニットテスト
   - モックと統合テスト

4. **OpenCVベースのOCR最適化**
   - 画像前処理パイプラインの強化
   - テキスト領域検出の改善
   - パフォーマンス最適化

5. **OCRモデルの自動ダウンロード機能**
   - モデル管理システムの構築
   - 自動ダウンロードと検証
   - モデルバージョン管理

## 5. マイルストーン

### マイルストーン1: アーキテクチャ改善基盤
- 内容:
  - 新しいインターフェース定義
  - アダプターパターンの実装
  - コアモジュールの移行
- 成果物:
  - 新アーキテクチャの基盤コード
  - 移行ガイドラインドキュメント

### マイルストーン2: OCRシステム強化
- 内容:
  - OCRエンジン基盤の単体テスト
  - OpenCVベースのOCR最適化
  - OCRモデルの自動ダウンロード機能
- 成果物:
  - 最適化されたOCRシステム
  - 自動モデルダウンロード機能付きアプリケーション

### マイルストーン3: Windows機能拡張
- 内容:
  - Windows 11最適化
  - ハイDPI対応の強化
  - マルチモニタサポートの改善
- 成果物:
  - Windows固有機能が強化されたアプリケーション

### マイルストーン4: 配布準備
- 内容:
  - インストーラー作成
  - 更新システム
  - エラー報告システム
- 成果物:
  - 配布可能なインストーラーパッケージ
  - 自動更新機能
  - ユーザーフィードバック収集システム

## 6. リスク分析と対策

### 6.1 技術的リスク

#### アーキテクチャ移行リスク
**リスク**: 新アーキテクチャへの移行による既存機能の不具合発生
**影響度**: 高
**対策**:
- 段階的な移行アプローチ
- 各フェーズでの単体テスト実施
- 機能回帰テストの自動化

#### OCR精度リスク
**リスク**: 特定のゲームでOCR精度が低い問題
**影響度**: 中
**対策**:
- OpenCVベースの画像前処理の最適化
- ゲーム別の最適化設定の実装
- 前処理オプションの拡充

#### リソース競合リスク
**リスク**: ゲームプレイ中のパフォーマンス低下
**影響度**: 中
**対策**:
- 差分検出による処理最適化
- サンプリングレートの調整機能
- 低リソース消費モードの実装

## 7. コード品質管理

### 7.1 コーディング規約

- **言語**: C# 12
- **規約文書**: `csharp-coding-standards.md`
- **自動チェック**: StyleCop, .editorconfig

### 7.2 テスト戦略

- **単体テスト**: xUnit
- **モック**: Moq
- **アサーション**: FluentAssertions
- **カバレッジ目標**: コア機能とOCRモジュールで80%以上

## 8. まとめ

Baketaプロジェクトは、Windows専用アプリケーションとしてのポジショニングを明確にし、アーキテクチャ改善を中心とした次のフェーズに移行します。改善されたアーキテクチャにより、メンテナンス性と拡張性が向上し、Windows固有機能の最適化がさらに進むことが期待されます。