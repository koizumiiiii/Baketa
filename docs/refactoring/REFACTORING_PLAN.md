# Baketaãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°è¨ˆç”»

## ğŸ“‹ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæƒ…å ±

- **ä½œæˆæ—¥**: 2025-10-03
- **å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: Phase 12.5å®Œäº†å¾Œ
- **æ¨å®šæœŸé–“**: 20-28æ—¥
- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: è¨ˆç”»ä¸­

---

## âœ… å®Ÿæ–½ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ

### Phase 0: ç¾çŠ¶åˆ†æãƒ»èª¿æŸ» (3-4æ—¥) - ğŸ”´ æœªç€æ‰‹

#### 0.1 é™çš„è§£æå®Ÿæ–½ (1æ—¥)
- [ ] Roslyn Analyzerã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- [ ] Visual Studio Code Metricså®Ÿè¡Œ
- [ ] ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰æ¤œå‡ºãƒ¬ãƒãƒ¼ãƒˆä½œæˆ
- [ ] å¾ªç’°ä¾å­˜æ¤œå‡º
- [ ] è¤‡é›‘åº¦æ¸¬å®šï¼ˆCyclomatic Complexity > 15ï¼‰
- [ ] é‡è¤‡ã‚³ãƒ¼ãƒ‰æ¤œå‡º
- [ ] æˆæœç‰©: `analysis_report.md` ä½œæˆ
- [ ] æˆæœç‰©: `deadcode_list.md` ä½œæˆ
- [ ] æˆæœç‰©: `refactoring_targets.md` ä½œæˆ

#### 0.2 å…¨ä½“ãƒ•ãƒ­ãƒ¼èª¿æŸ» (1-2æ—¥)
- [ ] ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ•ãƒ­ãƒ¼èª¿æŸ»ãƒ»æ–‡æ›¸åŒ–
- [ ] BaketaCaptureNative.dllé€£æºè©³ç´°ç¢ºèª
- [ ] P/Invokeå®£è¨€ã®æ­£ç¢ºæ€§æ¤œè¨¼
- [ ] SafeImageAdapterçµ±åˆçŠ¶æ³ç¢ºèª
- [ ] ObjectDisposedExceptionæ ¹æœ¬åŸå› ç‰¹å®š
- [ ] OCRãƒ•ãƒ­ãƒ¼èª¿æŸ»ãƒ»æ–‡æ›¸åŒ–
- [ ] ProximityGroupingå®Ÿè£…ç¢ºèª
- [ ] æ®µéšçš„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ çµ±åˆçŠ¶æ³ç¢ºèª
- [ ] ç¿»è¨³ãƒ•ãƒ­ãƒ¼èª¿æŸ»ãƒ»æ–‡æ›¸åŒ–
- [ ] StreamingTranslationServiceå®Ÿè£…çŠ¶æ³ç¢ºèª
- [ ] ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤ºãƒ•ãƒ­ãƒ¼èª¿æŸ»ãƒ»æ–‡æ›¸åŒ–
- [ ] METHOD_ENTRYãƒ­ã‚°ãŒå‡ºãªã„åŸå› ç‰¹å®š âš ï¸ é‡è¦
- [ ] ç¶™ç¶šç›£è¦–ãƒ•ãƒ­ãƒ¼èª¿æŸ»ãƒ»æ–‡æ›¸åŒ–
- [ ] æˆæœç‰©: `flow_analysis.md` ä½œæˆ
- [ ] æˆæœç‰©: `architecture_issues.md` ä½œæˆ
- [ ] æˆæœç‰©: `unused_components.md` ä½œæˆ

#### 0.3 ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ”ãƒ³ã‚° (1æ—¥)
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–“ä¾å­˜é–¢ä¿‚å¯è¦–åŒ–
- [ ] NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ•´ç†
- [ ] æœªä½¿ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç‰¹å®š
- [ ] ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸æ•´åˆç¢ºèª
- [ ] å¾ªç’°å‚ç…§ç¢ºèª
- [ ] æˆæœç‰©: `dependency_graph.png` ä½œæˆ
- [ ] æˆæœç‰©: `unused_packages.md` ä½œæˆ

---

### Phase 1: ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤ (2-3æ—¥) - ğŸ”´ æœªç€æ‰‹

#### 1.1 Phase 16é–¢é€£ã‚³ãƒ¼ãƒ‰å®Œå…¨å‰Šé™¤ (0.5æ—¥)
- [ ] Phase16UIOverlayModule.cs å‰Šé™¤ç¢ºèª
- [ ] AvaloniaOverlayRenderer.cs ä½¿ç”¨çŠ¶æ³ç¢ºèª
- [ ] é–¢é€£ã‚¤ãƒ™ãƒ³ãƒˆãƒ»ãƒãƒ³ãƒ‰ãƒ©ãƒ¼å‰Šé™¤
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª
- [ ] ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œï¼ˆå‰Šé™¤å¾Œï¼‰

#### 1.2 æœªä½¿ç”¨TranslationEngineå‰Šé™¤ (0.5æ—¥)
- [ ] MockTranslationEngineä½¿ç”¨çŠ¶æ³ç¢ºèª
- [ ] æ—§TCPé€šä¿¡ã‚³ãƒ¼ãƒ‰å®Œå…¨å‰Šé™¤ç¢ºèª
- [ ] æœªä½¿ç”¨ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰å‰Šé™¤
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª

#### 1.3 æœªä½¿ç”¨ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ»OCRã‚³ãƒ¼ãƒ‰å‰Šé™¤ (0.5æ—¥)
- [ ] PrintWindow fallbackä½¿ç”¨çŠ¶æ³ç¢ºèª
- [ ] Phase 3.1é–¢é€£ã®ä¸­é€”åŠç«¯ãªã‚³ãƒ¼ãƒ‰å‰Šé™¤
- [ ] æœªä½¿ç”¨ç”»åƒãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å‰Šé™¤
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª

#### 1.4 æœªä½¿ç”¨NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å‰Šé™¤ (0.5æ—¥)
- [ ] æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å‰Šé™¤
- [ ] æœªä½¿ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå‰Šé™¤
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª
- [ ] ã‚³ãƒ¼ãƒ‰å‰Šæ¸›é‡æ¸¬å®šï¼ˆç›®æ¨™: 2,000-3,000è¡Œï¼‰

---

### Phase 2: gRPCåŸºç›¤æ§‹ç¯‰ (5-7æ—¥) - ğŸ”´ æœªç€æ‰‹

#### 2.1 Protoãƒ•ã‚¡ã‚¤ãƒ«è¨­è¨ˆ (1æ—¥)
- [ ] translation.protoè¨­è¨ˆ
- [ ] TranslationServiceå®šç¾©
- [ ] TranslateRequest/Responseå®šç¾©
- [ ] BatchTranslateRequest/Responseå®šç¾©
- [ ] CancelRequest/Responseå®šç¾©
- [ ] HealthCheckRequest/Responseå®šç¾©
- [ ] Protoãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ç¢ºå®š

#### 2.2 Python gRPCã‚µãƒ¼ãƒãƒ¼å®Ÿè£… (2-3æ—¥)
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ä½œæˆï¼ˆgrpc_server/ï¼‰
- [ ] translation_server.pyå®Ÿè£…
- [ ] nllb_translator.pyå®Ÿè£…
- [ ] gemini_translator.pyå®Ÿè£…
- [ ] requirements.txtä½œæˆ
- [ ] start_server.pyå®Ÿè£…
- [ ] HealthCheckå‹•ä½œç¢ºèª
- [ ] å˜ä½“ç¿»è¨³å‹•ä½œç¢ºèª
- [ ] ãƒãƒƒãƒç¿»è¨³å‹•ä½œç¢ºèª

#### 2.3 C# gRPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£… (2-3æ—¥)
- [ ] ITranslationClient.csè¨­è¨ˆ
- [ ] TranslationResult recordå®šç¾©
- [ ] GrpcTranslationClient.cså®Ÿè£…
- [ ] TranslateAsyncå®Ÿè£…
- [ ] TranslateBatchAsyncå®Ÿè£…
- [ ] CancelTranslationAsyncå®Ÿè£…
- [ ] IsHealthyAsyncå®Ÿè£…
- [ ] StdinStdoutTranslationClient.csä¸¦è¡Œç¨¼åƒç¢ºèª
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆä½œæˆ
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

---

### Phase 3: é€šä¿¡å±¤æŠ½è±¡åŒ–ãƒ»ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— (3-4æ—¥) - ğŸ”´ æœªç€æ‰‹

#### 3.1 OptimizedPythonTranslationEngineå‰Šé™¤ (1æ—¥)
- [ ] GrpcTranslationEngineAdapter.cså®Ÿè£…
- [ ] DIç™»éŒ²åˆ‡ã‚Šæ›¿ãˆï¼ˆITranslationClientä½¿ç”¨ï¼‰
- [ ] OptimizedPythonTranslationEngine.cså‰Šé™¤ï¼ˆ1,500è¡Œï¼‰
- [ ] OperationIdæ‰‹å‹•ç®¡ç†ã‚³ãƒ¼ãƒ‰å‰Šé™¤
- [ ] TaskCompletionSourceè¤‡é›‘ãªåˆ¶å¾¡å‰Šé™¤
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª
- [ ] ç¿»è¨³æ©Ÿèƒ½å‹•ä½œç¢ºèª

#### 3.2 TranslationServiceéšå±¤æ•´ç† (1æ—¥)
- [ ] DefaultTranslationServiceè²¬ä»»æ˜ç¢ºåŒ–
- [ ] StreamingTranslationServiceè²¬ä»»æ˜ç¢ºåŒ–
- [ ] é‡è¤‡ã‚³ãƒ¼ãƒ‰å‰Šé™¤
- [ ] çµ±åˆå¯èƒ½æ€§æ¤œè¨
- [ ] ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Ÿæ–½

#### 3.3 stdin/stdoutå®Œå…¨å‰Šé™¤ (1æ—¥)
- [ ] StdinStdoutTranslationClient.cså‰Šé™¤
- [ ] Python stdin/stdoutã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ¼ãƒ‰å‰Šé™¤
- [ ] é–¢é€£è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
- [ ] ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰å‰Šé™¤
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª
- [ ] å…¨ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œ

---

### Phase 4: UIå±¤ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° (5-7æ—¥) - ğŸ”´ æœªç€æ‰‹

#### 4.1 InPlaceTranslationOverlayManageråˆ†å‰² (3-4æ—¥)
- [ ] IInPlaceOverlayFactory.csè¨­è¨ˆ
- [ ] InPlaceOverlayFactory.cså®Ÿè£…
- [ ] CreateOverlayå®Ÿè£…
- [ ] ConfigureOverlayå®Ÿè£…ï¼ˆWIDTH_FIXå«ã‚€ï¼‰
- [ ] IOverlayPositioningServiceçµ±åˆ
- [ ] InPlaceTranslationOverlayManager.csç°¡ç´ åŒ–ï¼ˆ1,067è¡Œ â†’ 300è¡Œï¼‰
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª
- [ ] ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤ºå‹•ä½œç¢ºèª

#### 4.2 WIDTH_FIXå•é¡Œã®å®Œå…¨è§£æ±º (1æ—¥)
- [ ] METHOD_ENTRYãƒ­ã‚°ãŒå‡ºãªã„åŸå› å®Œå…¨è§£æ˜
- [ ] å®Ÿéš›ã®å®Ÿè¡Œãƒ‘ã‚¹ç¢ºèª
- [ ] Factoryã§WIDTH_FIXç¢ºå®Ÿé©ç”¨
- [ ] ãƒ­ã‚°å‡ºåŠ›ç¢ºèª
- [ ] ç›®è¦–ç¢ºèªï¼ˆå¹…å›ºå®šã•ã‚Œã¦ã„ã‚‹ã‹ï¼‰
- [ ] è¤‡æ•°ãƒãƒ£ãƒ³ã‚¯ã§å‹•ä½œç¢ºèª

#### 4.3 ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼æ•´ç† (1-2æ—¥)
- [ ] AggregatedChunksReadyEventHandlerè²¬ä»»æ˜ç¢ºåŒ–
- [ ] CaptureCompletedHandlerè²¬ä»»æ˜ç¢ºåŒ–
- [ ] TranslationCompletedHandlerè²¬ä»»æ˜ç¢ºåŒ–
- [ ] ä¸è¦ãªãƒ­ã‚°å‰Šé™¤
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª

---

### Phase 5: çµ±åˆãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼ (2-3æ—¥) - ğŸ”´ æœªç€æ‰‹

#### 5.1 æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ (1æ—¥)
- [ ] ã‚­ãƒ£ãƒ—ãƒãƒ£ â†’ OCR â†’ ç¿»è¨³ â†’ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤º
- [ ] ã‚­ãƒ£ãƒ³ã‚»ãƒ«å‹•ä½œç¢ºèª
- [ ] ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‹•ä½œç¢ºèª
- [ ] WIDTH_FIXå‹•ä½œç¢ºèª
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç¢ºèª

#### 5.2 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ (1æ—¥)
- [ ] gRPC vs stdin/stdoutæ¯”è¼ƒæ¸¬å®š
- [ ] ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ç¢ºèª
- [ ] CPUä½¿ç”¨ç‡æ¸¬å®š
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ æ¸¬å®š
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ

#### 5.3 å›å¸°ãƒ†ã‚¹ãƒˆ (1æ—¥)
- [ ] æ—¢å­˜1,300+ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œ
- [ ] æ–°è¦ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 
- [ ] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š
- [ ] å…¨ãƒ†ã‚¹ãƒˆæˆåŠŸç¢ºèª

---

### Phase 6: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™ãƒ»å®Œäº† (1æ—¥) - ğŸ”´ æœªç€æ‰‹

#### 6.1 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
- [ ] CLAUDE.mdæ›´æ–°ï¼ˆgRPCç§»è¡Œåæ˜ ï¼‰
- [ ] CLAUDE.local.mdæ›´æ–°ï¼ˆPhase 12.2å•é¡Œè§£æ±ºè¨˜éŒ²ï¼‰
- [ ] README.mdæ›´æ–°
  - [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ã®æœ€æ–°åŒ–
  - [ ] gRPCã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³è¿½åŠ 
  - [ ] ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †æ›´æ–°ï¼ˆgRPCã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼‰
  - [ ] ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¿½åŠ 
- [ ] ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ä½œæˆï¼ˆMermaidï¼‰
- [ ] APIä»•æ§˜æ›¸ä½œæˆï¼ˆgRPCï¼‰

#### 6.2 æœ€çµ‚ç¢ºèª
- [ ] å…¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´åˆæ€§ç¢ºèª
- [ ] ã‚³ãƒ¼ãƒ‰å‰Šæ¸›é‡æœ€çµ‚æ¸¬å®š
- [ ] æŠ€è¡“çš„è² å‚µè§£æ¶ˆç¢ºèª
- [ ] ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Œäº†å®£è¨€

---

## ğŸ”¥ Geminiãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœ

**ãƒ¬ãƒ“ãƒ¥ãƒ¼æ—¥**: 2025-10-03
**ç·åˆè©•ä¾¡**: ğŸš¨ ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãªãƒªã‚¹ã‚¯ã¯é™å®šçš„ã ãŒã€é‡å¤§ãªè¦‹è½ã¨ã—ã‚ã‚Š

### âœ… é«˜è©•ä¾¡ãƒã‚¤ãƒ³ãƒˆ
1. **Phase 0ï¼ˆé™çš„è§£æï¼‰ã‹ã‚‰ç€æ‰‹ã™ã‚‹å„ªå…ˆé †ä½ä»˜ã‘** - ãƒªã‚¹ã‚¯ç®¡ç†ã¨ã—ã¦ç†æƒ³çš„
2. **gRPCç§»è¡Œåˆ¤æ–­** - æ¥­ç•Œæ¨™æº–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã€Œæœ€å¾Œã®é€šä¿¡å±¤å¤‰æ›´ã€ã«ã™ã‚‹æ–¹é‡ã¯å®Œå…¨ã«æ­£ã—ã„
3. **5ã¤ã®ãƒ•ã‚§ãƒ¼ã‚ºæ§‹æˆ** - æ®µéšçš„ãƒªã‚¹ã‚¯ç®¡ç†ãŒåŠ¹æœçš„
4. **å·¥æ•°è¦‹ç©ã‚‚ã‚Šï¼ˆ20-28æ—¥ï¼‰** - ç¾å®Ÿçš„ãªç¯„å›²

### ğŸš¨ ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãªãƒªã‚¹ã‚¯: BaketaCaptureNativeé€£æºã®è¦‹è½ã¨ã—

**GeminiæŒ‡æ‘˜**:
> ğŸš¨ **æœ€é‡è¦ãƒªã‚¹ã‚¯: `BaketaCaptureNative` (C++/WinRT) ã¨ã®é€£æº**
> - **ç¾çŠ¶**: ã“ã®ãƒã‚¤ãƒ†ã‚£ãƒ–DLLã¯ã€Windows Graphics Capture APIã‚’åˆ©ç”¨ã—ã€ã‚­ãƒ£ãƒ—ãƒãƒ£æ©Ÿèƒ½ã®å¿ƒè‡“éƒ¨ã§ã™ã€‚
> - **å•é¡Œ**: gRPCã¸ã®ç§»è¡Œå¾Œã€ã“ã®ãƒã‚¤ãƒ†ã‚£ãƒ–DLLã¨C#ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ¬ä½“ãŒã©ã®ã‚ˆã†ã«é€šä¿¡ã™ã‚‹ã®ã‹ãŒå…¨ãè€ƒæ…®ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚Pythonã‚µãƒ¼ãƒãƒ¼ã¨ã®é€šä¿¡ã¯gRPCã«ç½®ãæ›ã‚ã‚Šã¾ã™ãŒã€ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ—ãƒ­ã‚»ã‚¹ã¨ã®é€£æºã¯ã©ã†ãªã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ
> - **æ½œåœ¨çš„ãªå½±éŸ¿**: ã‚‚ã—ãƒã‚¤ãƒ†ã‚£ãƒ–DLLã¨ã®é€šä¿¡ã«ã‚‚å•é¡ŒãŒã‚ã‚Œã°ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ ¹å¹¹æ©Ÿèƒ½ãŒå‹•ä½œã—ãªããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

**å¯¾å¿œæ–¹é‡**:
- Phase 0.2ã®èª¿æŸ»å¯¾è±¡ã«ã€ŒBaketaCaptureNative.dllé€£æºã®è©³ç´°ç¢ºèªã€ã‚’è¿½åŠ 
- ãƒã‚¤ãƒ†ã‚£ãƒ–DLLã¨ã®é€šä¿¡ã¯**P/InvokeçµŒç”±**ã§ã‚ã‚Šã€gRPCç§»è¡Œã®å½±éŸ¿ã‚’å—ã‘ãªã„
- ã—ã‹ã—ã€SafeImageAdapterçµ±åˆå•é¡Œï¼ˆObjectDisposedExceptionï¼‰ãŒæ®‹å­˜ã—ã¦ãŠã‚Šã€ã“ã‚Œã‚’å„ªå…ˆè§£æ±ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹

---

## ğŸš¨ ç¾çŠ¶ã®å•é¡Œç‚¹

### 1. æŠ€è¡“çš„è² å‚µã®è“„ç©

çŸ­æœŸé–“ã§ã®æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯å¤‰æ›´ã«ã‚ˆã‚Šã€å¯¾ç—‡ç™‚æ³•çš„ãªä¿®æ­£ãŒç©ã¿é‡ãªã£ã¦ã„ã‚‹ã€‚

| æ™‚æœŸ | å¤‰æ›´å†…å®¹ | çµæœ | æ®‹å­˜ã™ã‚‹å•é¡Œ |
|------|---------|------|------------|
| Phase 12.5 | TCP â†’ stdin/stdout | SocketExceptionè§£æ¶ˆ | ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆåˆ¶å¾¡å›°é›£ï¼ˆ30ç§’å•é¡Œï¼‰ |
| Phase 12.2.1 | Task.Delayã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆä¿®æ­£ | 10ç§’ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå®Ÿè£… | ä¸Šä½å±¤CancellationTokenã¨å¹²æ¸‰ |
| Phase 12.2 | ãƒãƒƒãƒç¿»è¨³å•é¡Œ | å€‹åˆ¥å‡¦ç†ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ | å¿œç­”ãŒæ¥ãªã„åŸå› ä¸æ˜ |
| Phase 3.2 | SafeImageAdapterçµ±åˆ | ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ– | InvalidCastException |
| Phase 3.1 | WindowsImageFactoryä¿®æ­£ | çµ±åˆä¸å®Œå…¨ | ObjectDisposedExceptionç¶™ç¶š |

**å…±é€šãƒ‘ã‚¿ãƒ¼ãƒ³**: å•é¡Œç™ºç”Ÿ â†’ å±€æ‰€çš„ä¿®æ­£ â†’ æ–°ãŸãªå•é¡Œç™ºç”Ÿ â†’ ã•ã‚‰ã«å±€æ‰€çš„ä¿®æ­£ â†’ ...

### 2. OptimizedPythonTranslationEngine.cs (1,500è¡Œ)

**è²¬ä»»éå¤š**:
- TCPæ¥ç¶šç®¡ç†ï¼ˆå»ƒæ­¢æ¸ˆã¿ï¼‰
- stdin/stdouté€šä¿¡ï¼ˆç¾åœ¨ï¼‰
- JSON serialization/deserialization
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/å¿œç­”ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆOperationIdæ‰‹å‹•ç®¡ç†ï¼‰
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆåˆ¶å¾¡ï¼ˆ10ç§’ vs 30ç§’å•é¡Œï¼‰
- ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼
- ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ï¼ˆHybridResourceManagerï¼‰
- ãƒãƒƒãƒå‡¦ç†
- å€‹åˆ¥å‡¦ç†ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

**å•é¡Œ**: é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒå¤‰ã‚ã‚‹ãŸã³ã«ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã‚’æ›¸ãæ›ãˆã€‚ãƒ†ã‚¹ãƒˆå›°é›£ã€‚

### 3. InPlaceTranslationOverlayManager.cs (1,067è¡Œ)

**è²¬ä»»éå¤š**:
- ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
- ä½ç½®èª¿æ•´
- è¡çªå›é¿
- ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
- é‡è¤‡é˜²æ­¢
- WIDTH_FIXå®Ÿè£…ï¼ˆå®Ÿè¡Œãƒ•ãƒ­ãƒ¼ä¸æ˜ï¼‰

**å•é¡Œ**: UIå•é¡Œï¼ˆWIDTH_FIXï¼‰ã‚’ä¿®æ­£ã—ã‚ˆã†ã¨ã—ã¦ã‚‚ã€å®Ÿè¡Œãƒ•ãƒ­ãƒ¼ãŒè¿½ãˆãªã„ã€‚METHOD_ENTRYãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œãªã„è¬ã®å‹•ä½œã€‚

### 4. é€šä¿¡ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æŠ½è±¡åŒ–æ¬ å¦‚

**ç¾çŠ¶**:
```
TranslationService â†’ OptimizedPythonTranslationEngine â†’ stdin/stdoutç›´æ¥æ“ä½œ
```

**å•é¡Œ**:
- é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«å¤‰æ›´æ™‚ã®å½±éŸ¿ç¯„å›²ãŒåºƒã™ãã‚‹
- å˜ä½“ãƒ†ã‚¹ãƒˆå›°é›£ï¼ˆPythonã‚µãƒ¼ãƒãƒ¼èµ·å‹•å¿…é ˆï¼‰
- gRPCç§»è¡Œæ™‚ã«å¤§è¦æ¨¡æ›¸ãæ›ãˆãŒå¿…è¦

### 5. é™çš„è§£ææœªå®Ÿæ–½

**æ¨å®šã•ã‚Œã‚‹å•é¡Œ**:
- ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰ï¼ˆPhase 16é–¢é€£ã€æ—§TCPå®Ÿè£…ãªã©ï¼‰
- æœªä½¿ç”¨NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- å¾ªç’°ä¾å­˜
- è¤‡é›‘åº¦ã®é«˜ã„ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆCyclomatic Complexity > 15ï¼‰
- é‡è¤‡ã‚³ãƒ¼ãƒ‰

### 6. stdin/stdoutã®é™ç•Œ

**grpc.mdæŒ‡æ‘˜ã¨ã®ä¸€è‡´**:
- âœ… ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åŒºåˆ‡ã‚Šæ‰‹å‹•ç®¡ç†å¿…é ˆ
- âœ… ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/å¿œç­”å¯¾å¿œä»˜ã‘æ‰‹å‹•ç®¡ç†ï¼ˆTaskCompletionSourceè¤‡é›‘åŒ–ï¼‰
- âœ… ã‚­ãƒ£ãƒ³ã‚»ãƒ«å‡¦ç†è‡ªå‰å®Ÿè£…ï¼ˆCancellationTokenãŒåŠ¹ã‹ãªã„ï¼‰
- âœ… CPU/GCè² è·ï¼ˆJSON serialization/deserializationï¼‰
- âœ… è¤‡é›‘åŒ–ã§ã‚¹ãƒ‘ã‚²ãƒƒãƒ†ã‚£åŒ–ï¼ˆ1,500è¡Œãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

**å®Ÿéš›ã®å•é¡Œ**:
```csharp
// ç¾åœ¨: 200è¡Œä»¥ä¸Šã®è¤‡é›‘ãªåˆ¶å¾¡
var readTask = connection.Reader.ReadLineAsync(cancellationToken).AsTask();
var timeoutTask = Task.Delay(TimeSpan.FromSeconds(10));
var completedTask = await Task.WhenAny(readTask, timeoutTask);
if (completedTask == timeoutTask) {
    connection.TcpClient?.Close(); // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‡¦ç†
    throw new TimeoutException(...);
}
// + OperationIdç®¡ç†
// + TaskCompletionSourceç®¡ç†
// + JSON parse/serialize
```

---

## ğŸ¯ è§£æ±ºã—ãŸã„ã“ã¨

### 1. æŠ€è¡“çš„è² å‚µã®å®Œå…¨æ¸…ç®—

- **ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤**: Phase 16é–¢é€£ã€æ—§TCPå®Ÿè£…ã€æœªä½¿ç”¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç­‰
- **ã‚³ãƒ¼ãƒ‰å‰Šæ¸›**: æ¨å®š2,000-3,000è¡Œå‰Šé™¤
- **è¤‡é›‘åº¦å‰Šæ¸›**: 500è¡Œä»¥ä¸Šã®ã‚¯ãƒ©ã‚¹ã‚’200-300è¡Œã«åˆ†å‰²

### 2. é€šä¿¡å±¤ã®æŠ½è±¡åŒ–ã¨å®‰å®šåŒ–

- **gRPCç§»è¡Œ**: æ¥­ç•Œæ¨™æº–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã€Œæœ€å¾Œã®é€šä¿¡å±¤å¤‰æ›´ã€ã«ã™ã‚‹
- **æŠ½è±¡åŒ–**: ITranslationClientã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å°å…¥ã§ãƒ—ãƒ­ãƒˆã‚³ãƒ«éä¾å­˜
- **ç°¡ç´ åŒ–**: 1,500è¡Œ â†’ 100è¡Œç¨‹åº¦ã®ã‚·ãƒ³ãƒ—ãƒ«ãªé€šä¿¡å±¤

### 3. UIå±¤ã®è²¬ä»»åˆ†é›¢

- **ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³å°å…¥**: ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ç”Ÿæˆã¨è¨­å®šã‚’åˆ†é›¢
- **WIDTH_FIXå•é¡Œè§£æ±º**: ç¢ºå®Ÿã«TextBlock.MaxWidthã‚’è¨­å®šã™ã‚‹è¨­è¨ˆ
- **å®Ÿè¡Œãƒ•ãƒ­ãƒ¼å¯è¦–åŒ–**: ãªãœMETHOD_ENTRYãƒ­ã‚°ãŒå‡ºãªã„ã‹è§£æ˜ãƒ»ä¿®æ­£

### 4. ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ã®å‘ä¸Š

- **Mockå¯èƒ½ãªè¨­è¨ˆ**: ITranslationClientã§MockClientä½¿ç”¨å¯èƒ½
- **å˜ä½“ãƒ†ã‚¹ãƒˆè¿½åŠ **: é€šä¿¡å±¤ã€UIå±¤ã®å˜ä½“ãƒ†ã‚¹ãƒˆ
- **çµ±åˆãƒ†ã‚¹ãƒˆæ•´å‚™**: gRPC vs stdin/stdoutæ¯”è¼ƒãƒ†ã‚¹ãƒˆ

### 5. ä¿å®ˆæ€§ã®å‘ä¸Š

- **Clean Architectureæº–æ‹ **: å„å±¤ã®è²¬ä»»æ˜ç¢ºåŒ–
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™**: å…¨ä½“ãƒ•ãƒ­ãƒ¼å›³ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³
- **æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯å›ºå®š**: gRPCã§é€šä¿¡å±¤ã‚’å®‰å®šåŒ–

---

## ğŸ“‹ å®Ÿæ–½å†…å®¹

### Phase 0: ç¾çŠ¶åˆ†æãƒ»èª¿æŸ» (3-4æ—¥)

#### 0.1 é™çš„è§£æå®Ÿæ–½ (1æ—¥)

**ä½¿ç”¨ãƒ„ãƒ¼ãƒ«**:
- Roslyn Analyzerï¼ˆC#ï¼‰
- Visual Studio Code Metrics
- ReSharperï¼ˆåˆ©ç”¨å¯èƒ½ãªã‚‰ï¼‰

**å®Ÿæ–½é …ç›®**:
- ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰æ¤œå‡º
  - ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ¡ã‚½ãƒƒãƒ‰
  - ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‚¯ãƒ©ã‚¹
  - ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
  - æœªå‚ç…§ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- å¾ªç’°ä¾å­˜æ¤œå‡º
  - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–“å¾ªç’°ä¾å­˜
  - ã‚¯ãƒ©ã‚¹é–“å¾ªç’°ä¾å­˜
- è¤‡é›‘åº¦æ¸¬å®š
  - Cyclomatic Complexity > 15 ã®ãƒ¡ã‚½ãƒƒãƒ‰ç‰¹å®š
  - è¡Œæ•° > 500 ã®ã‚¯ãƒ©ã‚¹ç‰¹å®š
- é‡è¤‡ã‚³ãƒ¼ãƒ‰æ¤œå‡º
  - ã‚³ãƒ”ãƒšã‚³ãƒ¼ãƒ‰
  - é¡ä¼¼ãƒ­ã‚¸ãƒƒã‚¯

**æˆæœç‰©**:
- `analysis_report.md` - é™çš„è§£æãƒ¬ãƒãƒ¼ãƒˆ
- `deadcode_list.md` - å‰Šé™¤å¯¾è±¡ã‚³ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆ
- `refactoring_targets.md` - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å„ªå…ˆåº¦ãƒªã‚¹ãƒˆ

#### 0.2 å…¨ä½“ãƒ•ãƒ­ãƒ¼èª¿æŸ» (1-2æ—¥)

**èª¿æŸ»å¯¾è±¡**:

**â‘  ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ•ãƒ­ãƒ¼**
```
ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œï¼ˆStartãƒœã‚¿ãƒ³ï¼‰
  â†“
StartCaptureCommand (MainWindowViewModel)
  â†“
ICaptureService.StartCaptureAsync()
  â†“
Windows Graphics Capture API (BaketaCaptureNative.dll) â† P/InvokeçµŒç”±
  â†“
CaptureCompletedEventç™ºè¡Œ
```

**èª¿æŸ»ãƒã‚¤ãƒ³ãƒˆ**:
- ICaptureServiceã®å®Ÿè£…ã‚¯ãƒ©ã‚¹ç‰¹å®š
- SafeImageAdapterçµ±åˆçŠ¶æ³ç¢ºèª
- ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‚­ãƒ£ãƒ—ãƒãƒ£æ–¹å¼ã®ç‰¹å®šï¼ˆPrintWindow fallbackç­‰ï¼‰
- **ğŸš¨ [GEMINI_CRITICAL] BaketaCaptureNative.dllé€£æºã®è©³ç´°ç¢ºèª**:
  - P/Invokeå®£è¨€ï¼ˆNativeWindowsCapture.csï¼‰ã®æ­£ç¢ºæ€§
  - ãƒ¡ãƒ¢ãƒªç®¡ç†ï¼ˆSafeHandleä½¿ç”¨çŠ¶æ³ï¼‰
  - ObjectDisposedExceptionæ ¹æœ¬åŸå› ã®ç‰¹å®š
  - SafeImageAdapterçµ±åˆå•é¡Œã®è§£æ±ºæ–¹é‡ç­–å®š

**â‘¡ OCRãƒ•ãƒ­ãƒ¼**
```
CaptureCompletedEvent
  â†“
OcrRequestHandler
  â†“
SmartProcessingPipelineService
  â†“
PaddleOcrEngine
  â†“
TimedChunkAggregator
  â†“
AggregatedChunksReadyEventç™ºè¡Œ
```

**èª¿æŸ»ãƒã‚¤ãƒ³ãƒˆ**:
- ProximityGroupingå®Ÿè£…ç¢ºèª
- æ®µéšçš„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ çµ±åˆçŠ¶æ³
- ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç‰¹å®š

**â‘¢ ç¿»è¨³ãƒ•ãƒ­ãƒ¼**
```
AggregatedChunksReadyEvent
  â†“
AggregatedChunksReadyEventHandler
  â†“
StreamingTranslationService / DefaultTranslationService
  â†“
OptimizedPythonTranslationEngine (stdin/stdout)
  â†“
Python NLLB-200ã‚µãƒ¼ãƒãƒ¼
```

**èª¿æŸ»ãƒã‚¤ãƒ³ãƒˆ**:
- StreamingTranslationServiceã®å®Ÿè£…çŠ¶æ³
- DefaultTranslationServiceã¨ã®é–¢ä¿‚
- ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„TranslationEngineç‰¹å®šï¼ˆMockEngineç­‰ï¼‰

**â‘£ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤ºãƒ•ãƒ­ãƒ¼**
```
TranslationWithBoundsCompletedEvent
  â†“
AggregatedChunksReadyEventHandler.DisplayTranslationOverlayAsync()
  â†“
IInPlaceTranslationOverlayManager.ShowInPlaceOverlayAsync()
  â†“
CreateAndShowNewInPlaceOverlayAsync()
  â†“
InPlaceTranslationOverlayWindow.ShowInPlaceOverlayAsync()
  â†“
WIDTH_FIXå®Ÿè£…ï¼ˆã®ã¯ãšï¼‰
```

**èª¿æŸ»ãƒã‚¤ãƒ³ãƒˆ**:
- **ãªãœMETHOD_ENTRYãƒ­ã‚°ãŒå‡ºãªã„ã‹ç‰¹å®š** â† é‡è¦
- AvaloniaOverlayRendererã®ä½¿ç”¨çŠ¶æ³ç¢ºèª
- Phase16UIOverlayModuleã®å®Œå…¨å‰Šé™¤ç¢ºèª

**â‘¤ ç¶™ç¶šç›£è¦–ãƒ•ãƒ­ãƒ¼**
```
StartCaptureCommand
  â†“
Timer or Task-based polling
  â†“
å®šæœŸçš„ã«ã‚­ãƒ£ãƒ—ãƒãƒ£å®Ÿè¡Œ
  â†“
ç”»åƒå¤‰åŒ–æ¤œçŸ¥
  â†“
å¤‰åŒ–ãŒã‚ã‚Œã°OCRå®Ÿè¡Œ
```

**èª¿æŸ»ãƒã‚¤ãƒ³ãƒˆ**:
- ç”»åƒå¤‰åŒ–æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…çŠ¶æ³ï¼ˆP0ã‚¿ã‚¹ã‚¯ï¼‰
- ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”ã®æœ€é©å€¤
- ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ç¢ºèª

**æˆæœç‰©**:
- `flow_analysis.md` - å…¨ä½“ãƒ•ãƒ­ãƒ¼å›³ï¼ˆMermaidå½¢å¼ï¼‰
- `architecture_issues.md` - ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å•é¡Œãƒªã‚¹ãƒˆ
- `unused_components.md` - æœªä½¿ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒªã‚¹ãƒˆ

#### 0.3 ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ”ãƒ³ã‚° (1æ—¥)

**å®Ÿæ–½å†…å®¹**:
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–“ä¾å­˜é–¢ä¿‚å¯è¦–åŒ–
dotnet list package --include-transitive > dependencies.txt

# NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ•´ç†
# ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç‰¹å®š
```

**èª¿æŸ»ãƒã‚¤ãƒ³ãƒˆ**:
- æœªä½¿ç”¨NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸æ•´åˆ
- å¾ªç’°å‚ç…§

**æˆæœç‰©**:
- `dependency_graph.png` - ä¾å­˜é–¢ä¿‚å›³
- `unused_packages.md` - å‰Šé™¤å¯èƒ½ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒªã‚¹ãƒˆ

---

### Phase 1: ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤ (2-3æ—¥)

#### 1.1 Phase 16é–¢é€£ã‚³ãƒ¼ãƒ‰å®Œå…¨å‰Šé™¤ (0.5æ—¥)

**å‰Šé™¤å¯¾è±¡**:
- `Baketa.UI/DI/Modules/Phase16UIOverlayModule.cs` ï¼ˆç¢ºèªæ¸ˆã¿ç„¡åŠ¹åŒ–ï¼‰
- `Baketa.UI/Services/Overlay/AvaloniaOverlayRenderer.cs` ï¼ˆä½¿ç”¨çŠ¶æ³ç¢ºèªå¾Œï¼‰
- é–¢é€£ã™ã‚‹Phase 16ã‚¤ãƒ™ãƒ³ãƒˆãƒ»ãƒãƒ³ãƒ‰ãƒ©ãƒ¼

**ç¢ºèªäº‹é …**:
- AvaloniaOverlayRendererãŒæœ¬å½“ã«ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‹
- å‰Šé™¤å¾Œã®ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆæˆåŠŸç¢ºèª

#### 1.2 æœªä½¿ç”¨TranslationEngineå‰Šé™¤ (0.5æ—¥)

**å‰Šé™¤å€™è£œ**:
- MockTranslationEngineï¼ˆãƒ†ã‚¹ãƒˆç”¨ä»¥å¤–ã§ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„å ´åˆï¼‰
- æ—§TCPé€šä¿¡ã‚³ãƒ¼ãƒ‰ï¼ˆå®Œå…¨å‰Šé™¤ç¢ºèªï¼‰
- ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰

#### 1.3 æœªä½¿ç”¨ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ»OCRã‚³ãƒ¼ãƒ‰å‰Šé™¤ (0.5æ—¥)

**å‰Šé™¤å€™è£œ**:
- PrintWindow fallbackï¼ˆä½¿ç”¨ã•ã‚Œã¦ã„ãªã„å ´åˆï¼‰
- æ—§Phaseå®Ÿè£…ï¼ˆPhase 3.1é–¢é€£ã®ä¸­é€”åŠç«¯ãªã‚³ãƒ¼ãƒ‰ï¼‰
- ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ç”»åƒãƒ•ã‚£ãƒ«ã‚¿ãƒ¼

#### 1.4 æœªä½¿ç”¨NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å‰Šé™¤ (0.5æ—¥)

**å‰Šé™¤å€™è£œ**:
- æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

**æœŸå¾…åŠ¹æœ**:
- ã‚³ãƒ¼ãƒ‰å‰Šæ¸›é‡: **2,000-3,000è¡Œ**
- ãƒ“ãƒ«ãƒ‰æ™‚é–“çŸ­ç¸®
- ãƒ‡ãƒãƒƒã‚°å®¹æ˜“æ€§å‘ä¸Š

---

### Phase 2: gRPCåŸºç›¤æ§‹ç¯‰ (5-7æ—¥)

#### 2.1 Protoãƒ•ã‚¡ã‚¤ãƒ«è¨­è¨ˆ (1æ—¥)

**translation.proto**:
```protobuf
syntax = "proto3";

package baketa.translation;

service TranslationService {
  rpc Translate (TranslateRequest) returns (TranslateResponse);
  rpc TranslateBatch (stream BatchTranslateRequest) returns (stream BatchTranslateResponse);
  rpc CancelTranslation (CancelRequest) returns (CancelResponse);
  rpc HealthCheck (HealthCheckRequest) returns (HealthCheckResponse);
}

message TranslateRequest {
  string text = 1;
  string source_lang = 2;
  string target_lang = 3;
  string operation_id = 4;
}

message TranslateResponse {
  string translated_text = 1;
  string operation_id = 2;
  bool is_success = 3;
  string error_message = 4;
  int64 processing_time_ms = 5;
}

message BatchTranslateRequest {
  repeated string texts = 1;
  string source_lang = 2;
  string target_lang = 3;
  string batch_id = 4;
}

message BatchTranslateResponse {
  repeated string translated_texts = 1;
  string batch_id = 2;
  bool is_success = 3;
}

message CancelRequest {
  string operation_id = 1;
}

message CancelResponse {
  bool is_cancelled = 1;
}

message HealthCheckRequest {}

message HealthCheckResponse {
  bool is_healthy = 1;
  string version = 2;
}
```

#### 2.2 Python gRPCã‚µãƒ¼ãƒãƒ¼å®Ÿè£… (2-3æ—¥)

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ**:
```
python/
â”œâ”€â”€ grpc_server/
â”‚   â”œâ”€â”€ translation_server.py  # gRPCã‚µãƒ¼ãƒãƒ¼æœ¬ä½“
â”‚   â”œâ”€â”€ nllb_translator.py     # NLLB-200ãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â”œâ”€â”€ gemini_translator.py   # Gemini APIãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ protos/
â”‚   â””â”€â”€ translation.proto
â”œâ”€â”€ requirements.txt
â””â”€â”€ start_server.py
```

**ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«**: translation_server.py
```python
import grpc
from concurrent import futures
import translation_pb2
import translation_pb2_grpc
from nllb_translator import NLLBTranslator

class TranslationServicer(translation_pb2_grpc.TranslationServiceServicer):
    def __init__(self):
        self.translator = NLLBTranslator()

    def Translate(self, request, context):
        try:
            result = self.translator.translate(
                request.text,
                request.source_lang,
                request.target_lang
            )
            return translation_pb2.TranslateResponse(
                translated_text=result,
                operation_id=request.operation_id,
                is_success=True
            )
        except Exception as e:
            return translation_pb2.TranslateResponse(
                operation_id=request.operation_id,
                is_success=False,
                error_message=str(e)
            )

    def TranslateBatch(self, request_iterator, context):
        for request in request_iterator:
            yield self._translate_single(request)

    def HealthCheck(self, request, context):
        return translation_pb2.HealthCheckResponse(
            is_healthy=True,
            version="1.0.0"
        )

def serve():
    server = grpc.server(futures.ThreadPoolExecutor(max_workers=4))
    translation_pb2_grpc.add_TranslationServiceServicer_to_server(
        TranslationServicer(), server
    )
    server.add_insecure_port('[::]:50051')
    server.start()
    print("gRPC server started on port 50051")
    server.wait_for_termination()
```

#### 2.3 C# gRPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£… (2-3æ—¥)

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ**:
```
Baketa.Infrastructure/Translation/
â”œâ”€â”€ Clients/
â”‚   â”œâ”€â”€ ITranslationClient.cs          # æŠ½è±¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ GrpcTranslationClient.cs       # gRPCå®Ÿè£…
â”‚   â””â”€â”€ StdinStdoutTranslationClient.cs # æ—¢å­˜ï¼ˆç§»è¡ŒæœŸé–“ä¸­ã®ã¿ï¼‰
â”œâ”€â”€ Protos/
â”‚   â””â”€â”€ translation.proto
â””â”€â”€ Factories/
    â””â”€â”€ TranslationClientFactory.cs
```

**ITranslationClient.cs**:
```csharp
namespace Baketa.Infrastructure.Translation.Clients;

public interface ITranslationClient : IDisposable
{
    Task<TranslationResult> TranslateAsync(
        string text,
        string sourceLang,
        string targetLang,
        CancellationToken cancellationToken = default);

    Task<IEnumerable<TranslationResult>> TranslateBatchAsync(
        IEnumerable<string> texts,
        string sourceLang,
        string targetLang,
        CancellationToken cancellationToken = default);

    Task<bool> CancelTranslationAsync(string operationId);

    Task<bool> IsHealthyAsync();
}

public record TranslationResult(
    string TranslatedText,
    string OperationId,
    bool IsSuccess,
    string? ErrorMessage = null,
    long ProcessingTimeMs = 0);
```

**GrpcTranslationClient.cs**:
```csharp
using Grpc.Net.Client;
using Grpc.Core;

namespace Baketa.Infrastructure.Translation.Clients;

public class GrpcTranslationClient : ITranslationClient
{
    private readonly GrpcChannel _channel;
    private readonly TranslationService.TranslationServiceClient _client;

    public GrpcTranslationClient(string serverAddress = "http://localhost:50051")
    {
        _channel = GrpcChannel.ForAddress(serverAddress);
        _client = new TranslationService.TranslationServiceClient(_channel);
    }

    public async Task<TranslationResult> TranslateAsync(
        string text,
        string sourceLang,
        string targetLang,
        CancellationToken cancellationToken = default)
    {
        try
        {
            var request = new TranslateRequest
            {
                Text = text,
                SourceLang = sourceLang,
                TargetLang = targetLang,
                OperationId = Guid.NewGuid().ToString()
            };

            var response = await _client.TranslateAsync(
                request,
                deadline: DateTime.UtcNow.AddSeconds(10),
                cancellationToken: cancellationToken
            );

            return new TranslationResult(
                response.TranslatedText,
                response.OperationId,
                response.IsSuccess,
                response.ErrorMessage,
                response.ProcessingTimeMs
            );
        }
        catch (RpcException ex) when (ex.StatusCode == StatusCode.DeadlineExceeded)
        {
            return new TranslationResult(
                string.Empty,
                string.Empty,
                false,
                "Translation timeout"
            );
        }
    }

    public async Task<bool> IsHealthyAsync()
    {
        try
        {
            var response = await _client.HealthCheckAsync(
                new HealthCheckRequest(),
                deadline: DateTime.UtcNow.AddSeconds(2)
            );
            return response.IsHealthy;
        }
        catch
        {
            return false;
        }
    }

    public void Dispose()
    {
        _channel.Dispose();
    }
}
```

**æœŸå¾…åŠ¹æœ**:
- stdin/stdoutã¨ä¸¦è¡Œç¨¼åƒå¯èƒ½ãªgRPCãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- OptimizedPythonTranslationEngineã‚’å®Œå…¨å‰Šé™¤å¯èƒ½ãªæº–å‚™å®Œäº†

---

### Phase 3: é€šä¿¡å±¤æŠ½è±¡åŒ–ãƒ»ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— (3-4æ—¥)

#### 3.1 OptimizedPythonTranslationEngineå‰Šé™¤ (1æ—¥)

**ç½®ãæ›ãˆæ‰‹é †**:
```csharp
// Before
services.AddSingleton<ITranslationEngine, OptimizedPythonTranslationEngine>();

// After
services.AddSingleton<ITranslationClient, GrpcTranslationClient>();
services.AddSingleton<ITranslationEngine, GrpcTranslationEngineAdapter>();
```

**GrpcTranslationEngineAdapter.cs** (è»½é‡ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼):
```csharp
public class GrpcTranslationEngineAdapter : ITranslationEngine
{
    private readonly ITranslationClient _client;

    public GrpcTranslationEngineAdapter(ITranslationClient client)
    {
        _client = client;
    }

    public async Task<string> TranslateAsync(string text, CancellationToken ct)
    {
        var result = await _client.TranslateAsync(text, "ja", "en", ct);
        return result.IsSuccess ? result.TranslatedText : string.Empty;
    }
}
```

**å‰Šé™¤å¯¾è±¡**:
- `OptimizedPythonTranslationEngine.cs` (1,500è¡Œ)
- `StdinStdoutTranslationClient.cs`
- TCPé–¢é€£ã®å…¨ã‚³ãƒ¼ãƒ‰
- OperationIdæ‰‹å‹•ç®¡ç†ã‚³ãƒ¼ãƒ‰
- TaskCompletionSourceè¤‡é›‘ãªåˆ¶å¾¡

**æœŸå¾…åŠ¹æœ**:
- ã‚³ãƒ¼ãƒ‰å‰Šæ¸›: **1,500-2,000è¡Œ**
- ã‚·ãƒ³ãƒ—ãƒ«ãªé€šä¿¡å±¤ï¼ˆ100è¡Œç¨‹åº¦ï¼‰

#### 3.2 TranslationServiceéšå±¤æ•´ç† (1æ—¥)

**ç¾çŠ¶**:
- DefaultTranslationService
- StreamingTranslationService

**å®Ÿæ–½å†…å®¹**:
- ä¸¡è€…ã®è²¬ä»»ã‚’æ˜ç¢ºåŒ–
- é‡è¤‡ã‚³ãƒ¼ãƒ‰å‰Šé™¤
- çµ±åˆå¯èƒ½ã‹æ¤œè¨

#### 3.3 stdin/stdoutå®Œå…¨å‰Šé™¤ (1æ—¥)

**å‰Šé™¤å¯¾è±¡**:
- `StdinStdoutTranslationClient.cs`
- Python stdin/stdoutã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ¼ãƒ‰
- é–¢é€£è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
- ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰

---

### Phase 4: UIå±¤ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° (5-7æ—¥)

#### 4.1 InPlaceTranslationOverlayManageråˆ†å‰² (3-4æ—¥)

**ç¾çŠ¶**: 1,067è¡Œã®å˜ä¸€ã‚¯ãƒ©ã‚¹

**åˆ†å‰²å¾Œã®è¨­è¨ˆ**:

**â‘  IInPlaceOverlayFactory** (æ–°è¦ä½œæˆ)
```csharp
public interface IInPlaceOverlayFactory
{
    InPlaceTranslationOverlayWindow CreateOverlay(TextChunk textChunk);
    void ConfigureOverlay(InPlaceTranslationOverlayWindow overlay, TextChunk textChunk);
}

public class InPlaceOverlayFactory : IInPlaceOverlayFactory
{
    public InPlaceTranslationOverlayWindow CreateOverlay(TextChunk textChunk)
    {
        return new InPlaceTranslationOverlayWindow
        {
            ChunkId = textChunk.ChunkId,
            OriginalText = textChunk.CombinedText,
            TranslatedText = textChunk.TranslatedText,
        };
    }

    public void ConfigureOverlay(
        InPlaceTranslationOverlayWindow overlay,
        TextChunk textChunk)
    {
        var overlaySize = textChunk.GetOverlaySize();

        // ğŸ”§ [WIDTH_FIX] ã“ã“ã§ç¢ºå®Ÿã«è¨­å®š
        var textBlock = overlay.FindControl<TextBlock>("InPlaceTranslatedTextBlock");
        if (textBlock != null)
        {
            textBlock.MaxWidth = overlaySize.Width - 8; // Border Paddingè€ƒæ…®
        }

        overlay.Width = overlaySize.Width;
        overlay.Position = textChunk.GetBasicOverlayPosition();
    }
}
```

**â‘¡ IInPlaceOverlayManager** (ç°¡ç´ åŒ–)
```csharp
public class InPlaceTranslationOverlayManager : IInPlaceTranslationOverlayManager
{
    private readonly IInPlaceOverlayFactory _factory;
    private readonly IOverlayPositioningService _positioning;
    private readonly ConcurrentDictionary<int, InPlaceTranslationOverlayWindow> _overlays = new();

    public async Task ShowInPlaceOverlayAsync(
        TextChunk textChunk,
        CancellationToken ct)
    {
        // ã‚·ãƒ³ãƒ—ãƒ«ãªå‡¦ç†ãƒ•ãƒ­ãƒ¼
        var overlay = _factory.CreateOverlay(textChunk);
        _factory.ConfigureOverlay(overlay, textChunk);

        await Dispatcher.UIThread.InvokeAsync(() =>
        {
            overlay.Show();
            _overlays[textChunk.ChunkId] = overlay;
        });
    }
}
```

**æœŸå¾…åŠ¹æœ**:
- InPlaceOverlayFactory.cs (200è¡Œ)
- InPlaceTranslationOverlayManager.cs (300è¡Œ) â† ç°¡ç´ åŒ–
- IOverlayPositioningServiceçµ±åˆå¼·åŒ–

#### 4.2 WIDTH_FIXå•é¡Œã®å®Œå…¨è§£æ±º (1æ—¥)

**èª¿æŸ»å†…å®¹**:
1. ãªãœMETHOD_ENTRYãƒ­ã‚°ãŒå‡ºãªã„ã‹ç‰¹å®š
2. å®Ÿéš›ã®å®Ÿè¡Œãƒ‘ã‚¹ã‚’ç¢ºèª
3. Factoryã§WIDTH_FIXç¢ºå®Ÿé©ç”¨

**æ¤œè¨¼æ–¹æ³•**:
- ãƒ­ã‚°å‡ºåŠ›ç¢ºèª
- å®Ÿéš›ã«ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤å¹…ãŒå›ºå®šã•ã‚Œã‚‹ã‹ç›®è¦–ç¢ºèª
- è¤‡æ•°ãƒãƒ£ãƒ³ã‚¯ã§å‹•ä½œç¢ºèª

#### 4.3 ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼æ•´ç† (1-2æ—¥)

**å¯¾è±¡**:
- AggregatedChunksReadyEventHandler
- CaptureCompletedHandler
- TranslationCompletedHandler

**æ•´ç†å†…å®¹**:
- è²¬ä»»ã®æ˜ç¢ºåŒ–
- ä¸è¦ãªãƒ­ã‚°å‰Šé™¤
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–

---

### Phase 5: çµ±åˆãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼ (2-3æ—¥)

#### 5.1 æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ (1æ—¥)
- ã‚­ãƒ£ãƒ—ãƒãƒ£ â†’ OCR â†’ ç¿»è¨³ â†’ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤º
- ã‚­ãƒ£ãƒ³ã‚»ãƒ«å‹•ä½œç¢ºèª
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‹•ä½œç¢ºèª
- WIDTH_FIXå‹•ä½œç¢ºèª

#### 5.2 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ (1æ—¥)
- gRPC vs stdin/stdoutæ¯”è¼ƒ
- ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ç¢ºèª
- CPUä½¿ç”¨ç‡æ¸¬å®š

#### 5.3 å›å¸°ãƒ†ã‚¹ãƒˆ (1æ—¥)
- æ—¢å­˜1,300+ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œ
- æ–°è¦ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 

---

## ğŸ“Š æœŸå¾…åŠ¹æœ

| é …ç›® | ç¾åœ¨ | Phase 5å®Œäº†å¾Œ |
|------|------|--------------|
| **ç·ã‚³ãƒ¼ãƒ‰è¡Œæ•°** | ~15,000è¡Œ | **~10,000è¡Œ** (-33%) |
| **OptimizedPythonTranslationEngine** | 1,500è¡Œ | **å‰Šé™¤** |
| **InPlaceTranslationOverlayManager** | 1,067è¡Œ | **500è¡Œ** |
| **ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰** | ä¸æ˜ | **å®Œå…¨å‰Šé™¤** |
| **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå•é¡Œ** | ã‚ã‚Š | **è§£æ±º** |
| **WIDTH_FIXå•é¡Œ** | ä¸æ˜ | **è§£æ±º** |
| **æŠ€è¡“çš„è² å‚µ** | é«˜ | **æ¥µã‚ã¦ä½** |
| **ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§** | å›°é›£ | **å®¹æ˜“** |
| **ä¿å®ˆæ€§** | ä½ | **é«˜** |

---

## ğŸ¯ æœ€çµ‚æˆæœç‰©

1. âœ… **ã‚¯ãƒªãƒ¼ãƒ³ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**
2. âœ… **gRPCåŸºç›¤ï¼ˆæ¥­ç•Œæ¨™æº–ï¼‰**
3. âœ… **ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å®Œå…¨å‰Šé™¤**
4. âœ… **WIDTH_FIXå•é¡Œè§£æ±º**
5. âœ… **å…¨ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–**
6. âœ… **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œå‚™**

---

## âš ï¸ ãƒªã‚¹ã‚¯è©•ä¾¡ã¨Mitigation Strategy

### 1. BaketaCaptureNative.dllé€£æºãƒªã‚¹ã‚¯ (GeminiæŒ‡æ‘˜)

**ãƒªã‚¹ã‚¯**: ãƒã‚¤ãƒ†ã‚£ãƒ–DLLã¨ã®é€šä¿¡ãŒgRPCç§»è¡Œã®å½±éŸ¿ã‚’å—ã‘ã‚‹å¯èƒ½æ€§

**å®Ÿæ…‹**:
- ãƒã‚¤ãƒ†ã‚£ãƒ–DLLã¨ã®é€šä¿¡ã¯**P/InvokeçµŒç”±**ã§ã‚ã‚Šã€gRPCç§»è¡Œã¨**ç„¡é–¢ä¿‚**
- Pythonã‚µãƒ¼ãƒãƒ¼ã¨ã®é€šä¿¡ã®ã¿ãŒstdin/stdout â†’ gRPCã«å¤‰æ›´ã•ã‚Œã‚‹
- ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ•ãƒ­ãƒ¼: C# â†’ P/Invoke â†’ C++/WinRT DLL (å¤‰æ›´ãªã—)
- ç¿»è¨³ãƒ•ãƒ­ãƒ¼: C# â†’ gRPC â†’ Python (å¤‰æ›´ã‚ã‚Š)

**Mitigation**:
- Phase 0.2ã§P/Invokeå®£è¨€ã®æ­£ç¢ºæ€§ã‚’å†ç¢ºèª
- SafeImageAdapterçµ±åˆå•é¡Œï¼ˆObjectDisposedExceptionï¼‰ã‚’å„ªå…ˆè§£æ±º
- ãƒã‚¤ãƒ†ã‚£ãƒ–DLLé€£æºã®å˜ä½“ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 

**ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«**: ğŸŸ¡ ä¸­ï¼ˆå®Ÿéš›ã®å½±éŸ¿ã¯é™å®šçš„ã ãŒã€ç¢ºèªå¿…é ˆï¼‰

### 2. gRPCç§»è¡Œã«ä¼´ã†ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒªã‚¹ã‚¯

**ãƒªã‚¹ã‚¯**: stdin/stdoutã‚ˆã‚Šé…ã„å¯èƒ½æ€§

**Mitigation**:
- Phase 5.2ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿæ–½
- Protobufãƒã‚¤ãƒŠãƒªã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹é«˜é€ŸåŒ–æœŸå¾…
- HTTP/2ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªé€šä¿¡

**ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«**: ğŸŸ¢ ä½ï¼ˆç†è«–ä¸Šã¯é«˜é€ŸåŒ–ãŒæœŸå¾…ã§ãã‚‹ï¼‰

### 3. Phase 1ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤ã§ã®å½±éŸ¿ç¯„å›²

**ãƒªã‚¹ã‚¯**: æ„å›³ã—ãªã„æ©Ÿèƒ½å‰Šé™¤

**Mitigation**:
- Phase 0.1ã®é™çš„è§£æã§æ…é‡ã«ç‰¹å®š
- å‰Šé™¤å‰ã«å…¨ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œ
- å‰Šé™¤å¾Œã‚‚å…¨ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œ

**ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«**: ğŸŸ¡ ä¸­ï¼ˆé™çš„è§£æã¨ãƒ†ã‚¹ãƒˆã§ç®¡ç†å¯èƒ½ï¼‰

### 4. WIDTH_FIXå•é¡Œã®æ ¹æœ¬åŸå› ä¸æ˜

**ãƒªã‚¹ã‚¯**: Factory Patternã§è§£æ±ºã§ããªã„å¯èƒ½æ€§

**Mitigation**:
- Phase 0.2ã§METHOD_ENTRYãƒ­ã‚°ãŒå‡ºãªã„åŸå› ã‚’å®Œå…¨ç‰¹å®š
- å®Ÿè¡Œãƒ•ãƒ­ãƒ¼ã‚’å®Œå…¨ã«å¯è¦–åŒ–ã—ã¦ã‹ã‚‰å®Ÿè£…ç€æ‰‹

**ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«**: ğŸŸ¡ ä¸­ï¼ˆèª¿æŸ»æ¬¡ç¬¬ã§è§£æ±ºå¯èƒ½ï¼‰

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [grpc.md](C:\Users\suke0\OneDrive\ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—\grpc.md) - gRPC vs stdin/stdoutæ¯”è¼ƒ
- [CLAUDE.local.md](../../CLAUDE.local.md) - Phase 12.2å•é¡Œã®è©³ç´°
- [CLAUDE.md](../../CLAUDE.md) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

---

## ğŸ“ å‚™è€ƒ

- **ãƒªãƒªãƒ¼ã‚¹å‰**: ã¾ã ãƒªãƒªãƒ¼ã‚¹ã—ã¦ã„ãªã„ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚ˆã‚ŠæŠ€è¡“çš„è² å‚µæ¸…ç®—ã‚’å„ªå…ˆ
- **æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯æ›´æ–°é »åº¦**: çŸ­æœŸé–“ã§ã®å¤‰æ›´ã«ã‚ˆã‚Šè² å‚µè“„ç©
- **gRPCç§»è¡Œç†ç”±**: æ¥­ç•Œæ¨™æº–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã€Œæœ€å¾Œã®é€šä¿¡å±¤å¤‰æ›´ã€ã«ã™ã‚‹
