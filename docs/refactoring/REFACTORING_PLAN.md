# Baketaãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°è¨ˆç”»

## ğŸ“‹ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæƒ…å ±

- **ä½œæˆæ—¥**: 2025-10-03
- **å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: Phase 12.5å®Œäº†å¾Œ
- **æ¨å®šæœŸé–“**: 20-28æ—¥
- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: Phase 0å®Œå…¨å®Œäº†ï¼ˆ100%ï¼‰ã€Phase 1å®Œäº†ï¼ˆ80%ï¼‰ã€**Phase 2å®Œå…¨å®Œäº†ï¼ˆ100%ï¼‰**
- **æœ€çµ‚æ›´æ–°**: 2025-10-06ï¼ˆPhase 2.3å®Œäº†ã€gRPCåŸºç›¤æ§‹ç¯‰å®Œäº†ï¼‰

---

## ğŸ“Š é€²æ—çŠ¶æ³

### Phase 0: ç¾çŠ¶åˆ†æãƒ»èª¿æŸ» - âœ… å®Œå…¨å®Œäº†ï¼ˆ100%ï¼‰

| ã‚µãƒ–ãƒ•ã‚§ãƒ¼ã‚º | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | å®Œäº†æ—¥ |
|------------|----------|--------|
| 0.1 é™çš„è§£æå®Ÿæ–½ | âœ… å®Œäº† | 2025-10-04 |
| 0.2 å…¨ä½“ãƒ•ãƒ­ãƒ¼èª¿æŸ» | âœ… å®Œäº† | 2025-10-04 |
| 0.3 ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ”ãƒ³ã‚° | âœ… å®Œäº† | 2025-10-05 |

### Phase 1: ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤ãƒ»ã‚³ãƒ¼ãƒ‰å“è³ªæ”¹å–„ - âœ… 80%å®Œäº†

| ã‚µãƒ–ãƒ•ã‚§ãƒ¼ã‚º | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | å‰Šæ¸›ãƒ»æ”¹å–„ | å®Œäº†æ—¥ |
|------------|----------|---------|--------|
| 1.1 Phase 16é–¢é€£ã‚³ãƒ¼ãƒ‰å®Œå…¨å‰Šé™¤ | âœ… å®Œäº† | **365è¡Œå‰Šæ¸›** | 2025-10-04 |
| 1.2 Disposeæœªå®Ÿè£…ä¿®æ­£ï¼ˆP0ï¼‰ | âœ… å®Œäº† | **2ä»¶ä¿®æ­£** | 2025-10-04 |
| 1.3 ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤ï¼ˆP1ï¼‰ | âœ… å®Œäº† | **143è¡Œå‰Šæ¸›** | 2025-10-04 |
| 1.4 CA1840ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ | âœ… å®Œäº† | **77ä»¶ç½®æ›** | 2025-10-04 |
| 1.5 æœªä½¿ç”¨NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å‰Šé™¤ | âš ï¸ ã‚¹ã‚­ãƒƒãƒ— | - | 2025-10-04 |

### Phase 2å‰æ: ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ•´å‚™ - âœ… å®Œäº† (2025-10-05)

| ã‚µãƒ–ãƒ•ã‚§ãƒ¼ã‚º | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | å¤‰æ›´å†…å®¹ | å®Œäº†æ—¥ |
|------------|----------|---------|--------|
| P0: ObjectPoolãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸æ•´åˆè§£æ±º | âœ… å®Œäº† | **9.0.8 â†’ 8.0.0** | 2025-10-05 |
| P1: Google.Protobufæ›´æ–° | âœ… å®Œäº† | **3.25.2 â†’ 3.32.1** | 2025-10-05 |

**Phase 1ç´¯è¨ˆå‰Šæ¸›**: 508è¡Œ
**Phase 1è­¦å‘Šå‰Šæ¸›**: 99+ä»¶
**Phase 1.5ã‚¹ã‚­ãƒƒãƒ—ç†ç”±**: SharpDXã¯å®Ÿéš›ã«ä½¿ç”¨ä¸­ï¼ˆWinRTWindowCaptureçµŒç”±ï¼‰

### Phase 2: gRPCåŸºç›¤æ§‹ç¯‰ - âœ… **å®Œå…¨å®Œäº†ï¼ˆ100%ï¼‰**

| ã‚µãƒ–ãƒ•ã‚§ãƒ¼ã‚º | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | æˆæœ | å®Œäº†æ—¥ |
|------------|----------|------|--------|
| 2.å‰æ: ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ•´å‚™ | âœ… å®Œäº† | **ObjectPool 9.0.8â†’8.0.0, Protobuf 3.25.2â†’3.32.1** | 2025-10-05 |
| 2.1 Protoãƒ•ã‚¡ã‚¤ãƒ«è¨­è¨ˆ | âœ… å®Œäº† | **translation.proto 230è¡Œ, 4 RPC methods** | 2025-10-05 |
| 2.2 Python gRPCã‚µãƒ¼ãƒãƒ¼å®Ÿè£… | âœ… å®Œäº† | **9ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ, 1,400è¡Œå®Ÿè£…, Proto compilationå®Œäº†** | 2025-10-06 |
| 2.2.1 CTranslate2çµ±åˆ | âœ… å®Œäº† | **74.6%ãƒ¡ãƒ¢ãƒªå‰Šæ¸›é”æˆï¼ˆ2.4GBâ†’610MBï¼‰ã€1ãƒ•ã‚¡ã‚¤ãƒ«430è¡Œå®Ÿè£…** | 2025-10-06 |
| 2.3 C# gRPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£… | âœ… **å®Œå…¨å®Œäº†** | **DIçµ±åˆã€gRPCçµŒç”±ç¿»è¨³å‹•ä½œæ¤œè¨¼å®Œäº†ï¼ˆ753msï¼‰** | 2025-10-06 |

**Phase 2.2æˆæœè©³ç´°**:
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ **: `grpc_server/` (engines/, protos/, __init__.py)
- **ç¿»è¨³ã‚¨ãƒ³ã‚¸ãƒ³æŠ½è±¡åŒ–**: base.py (143è¡Œ) + nllb_engine.py (316è¡Œ)
- **gRPCã‚µãƒ¼ãƒ“ã‚¹**: translation_server.py (380è¡Œ)
- **ã‚µãƒ¼ãƒãƒ¼èµ·å‹•**: start_server.py (184è¡Œ, graceful shutdownå®Ÿè£…)
- **Protoç”Ÿæˆ**: translation_pb2.py (10KB), translation_pb2_grpc.py (10KB)
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: README.md (271è¡Œ), requirements.txt
- **å‹•ä½œç¢ºèª**: âœ… ã‚µãƒ¼ãƒãƒ¼èµ·å‹•æˆåŠŸã€NLLB-200ãƒ­ãƒ¼ãƒ‰æˆåŠŸï¼ˆGPU, 3.5-7.5ç§’ï¼‰

**Phase 2.2.1æˆæœè©³ç´°**:
- **CTranslate2ã‚¨ãƒ³ã‚¸ãƒ³**: `ctranslate2_engine.py` (430è¡Œ)
- **int8é‡å­åŒ–**: GPUä½¿ç”¨ã€compute_type=int8_float32
- **ãƒ¡ãƒ¢ãƒªå‰Šæ¸›**: 2.4GB â†’ 610MBï¼ˆ74.6%å‰Šæ¸›ã€ç›®æ¨™80%ã‚’ã»ã¼é”æˆï¼‰
- **ãƒ­ãƒ¼ãƒ‰æ™‚é–“**: 3.79ç§’ï¼ˆNllbEngineã¨åŒç­‰ï¼‰
- **ã‚¨ãƒ³ã‚¸ãƒ³åˆ‡ã‚Šæ›¿ãˆ**: `--use-ctranslate2` ãƒ•ãƒ©ã‚°ã§é¸æŠå¯èƒ½
- **æ—¢å­˜å®Ÿè£…æ´»ç”¨**: `scripts/nllb_translation_server_ct2.py` ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Œå…¨ç§»æ¤

**Phase 2.3æˆæœè©³ç´°**:
- **DIçµ±åˆ**: `InfrastructureModule.RegisterTranslationSettings()` ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…
- **è¨­å®šãƒ­ãƒ¼ãƒ‰**: `appsettings.json` ã‹ã‚‰ `UseGrpcClient`, `GrpcServerAddress` æ­£å¸¸ãƒ­ãƒ¼ãƒ‰
- **ãƒãƒ¼ã‚¿ãƒ“ãƒªãƒ†ã‚£**: BaseDirectoryå„ªå…ˆã§ç’°å¢ƒä¾å­˜æ€§æ’é™¤
- **ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼**: é™çš„ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿæ–½ã€P0/P1æŒ‡æ‘˜äº‹é …å®Œå…¨åæ˜ 
- **å“è³ªæ”¹å–„**: è¨ºæ–­ãƒ­ã‚°å‰Šæ¸›40è¡Œã€#if DEBUGåˆ¶å¾¡ã€å…·ä½“çš„ä¾‹å¤–å‹ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- **å‹•ä½œæ¤œè¨¼å®Œäº†**: gRPCçµŒç”±ç¿»è¨³ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Œå…¨å‹•ä½œç¢ºèª
  - OCRæ¤œå‡º: 'ãƒ•ãƒªãƒƒãƒ„ã€Œãƒ˜ã„ï¼ã‚‰ã£ã—ã‚ƒã„l.....' (2093ms)
  - gRPCç¿»è¨³: 'Fritz said, "Hey!' (753ms)
  - ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤º: åº§æ¨™ãƒ™ãƒ¼ã‚¹ç¿»è¨³ï¼ˆ1/1ãƒãƒ£ãƒ³ã‚¯ï¼‰
  - CTranslate2ã‚¨ãƒ³ã‚¸ãƒ³: int8é‡å­åŒ–ã€CUDA GPUã€80%ãƒ¡ãƒ¢ãƒªå‰Šæ¸›
  - ã‚µãƒ¼ãƒãƒ¼: 0.0.0.0:50051ã§å®‰å®šå‹•ä½œ

**Phase 2ç´¯è¨ˆå®Ÿè£…**: 1,830è¡Œï¼ˆPythonï¼‰+ C#ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼ˆè¨ºæ–­ãƒ­ã‚°å‰Šæ¸›40è¡Œï¼‰
**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**: Phase 3 - ç¿»è¨³ã‚·ã‚¹ãƒ†ãƒ çµ±åˆå®Ÿè£…ãƒ»ãƒ†ã‚¹ãƒˆ

---

## ğŸ“š Phase 0.3æˆæœç‰©æ´»ç”¨ãƒãƒƒãƒ—

### dependency_graph.md ã®æ´»ç”¨å…ˆ

| Phase | ã‚¿ã‚¹ã‚¯ | æ´»ç”¨å†…å®¹ |
|-------|--------|---------|
| **Phase 2.3** | C# gRPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£… | Infrastructureå±¤ã¸ã®é…ç½®æ±ºå®šï¼ˆClean Architectureæº–æ‹ ï¼‰ |
| **Phase 3.1** | OptimizedPythonTranslationEngineå‰Šé™¤ | Infrastructureå±¤ä¾å­˜é–¢ä¿‚ã€å½±éŸ¿ç¯„å›²ç¢ºèª |
| **Phase 3.2** | TranslationServiceéšå±¤æ•´ç† | Applicationå±¤ä¾å­˜é–¢ä¿‚ã€è²¬ä»»åˆ†é›¢è¨­è¨ˆ |
| **Phase 4.1** | InPlaceTranslationOverlayManageråˆ†å‰² | UIå±¤ä¾å­˜é–¢ä¿‚ï¼ˆApplication, Infrastructure.Platformï¼‰ç¢ºèª |
| **Phase 5.3** | å›å¸°ãƒ†ã‚¹ãƒˆ | ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¾å­˜é–¢ä¿‚ã€ãƒ†ã‚¹ãƒˆæˆ¦ç•¥æœ€é©åŒ– |
| **Phase 6.1** | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–° | æœ€æ–°ã®5å±¤æ§‹é€ å›³ã‚’README.mdã«åæ˜  |

### package_analysis.md ã®æ´»ç”¨å…ˆ

| Phase | ã‚¿ã‚¹ã‚¯ | æ´»ç”¨å†…å®¹ |
|-------|--------|---------|
| **Phase 2å‰æ** | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸æ•´åˆè§£æ±º | **P0**: Microsoft.Extensions.ObjectPool 9.0.8 â†’ 8.0.0 |
| **Phase 2.1** | Protoãƒ•ã‚¡ã‚¤ãƒ«è¨­è¨ˆ | Google.Protobuf 3.25.2 â†’ 3.32.1æ›´æ–° |
| **Phase 2.2** | Python gRPCã‚µãƒ¼ãƒãƒ¼å®Ÿè£… | gRPCé–¢é€£ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª |
| **Phase 2.3** | C# gRPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£… | Grpc.Net.Clientè¿½åŠ ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ•´åˆæ€§ç¢ºèª |
| **Phase 4å‰æ** | UIé–¢é€£ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ›´æ–° | Avalonia 11.2.7 â†’ 11.3.7, ReactiveUI 20.1.63 â†’ 22.0.1æ¤œè¨ |
| **Phase 5å‰æ** | ONNX Runtimeæ›´æ–° | 1.17.1 â†’ 1.23.0æ›´æ–°æ¤œè¨ï¼ˆæ…é‡ã«æ¤œè¨¼ï¼‰ |

---

## âœ… å®Ÿæ–½ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ

### Phase 0: ç¾çŠ¶åˆ†æãƒ»èª¿æŸ» (3-4æ—¥) - âœ… å®Œäº†

#### 0.1 é™çš„è§£æå®Ÿæ–½ - âœ… å®Œäº† (2025-10-04)
- [x] Roslyn Analyzerã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— â†’ Roslynator 0.10.2ä½¿ç”¨
- [x] é™çš„è§£æå®Ÿè¡Œ â†’ 165+ä»¶ã®è­¦å‘Šæ¤œå‡º
- [x] ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰æ¤œå‡ºãƒ¬ãƒãƒ¼ãƒˆä½œæˆ â†’ P0å•é¡Œ2ä»¶ã€ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰22+ä»¶ç‰¹å®š
- [x] å¾ªç’°ä¾å­˜æ¤œå‡º â†’ å¾ªç’°ä¾å­˜ãªã—ç¢ºèª
- [x] è¤‡é›‘åº¦æ¸¬å®š â†’ PaddleOcrEngine.cs (5,741è¡Œ) ä»–Top16ç‰¹å®š
- [x] é‡è¤‡ã‚³ãƒ¼ãƒ‰æ¤œå‡º â†’ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ä¸çµ±ä¸€ã‚’ç‰¹å®š
- [x] æˆæœç‰©: `analysis_report.md` ä½œæˆ âœ…
- [x] æˆæœç‰©: `dependency_analysis.md` ä½œæˆ âœ…
- [x] æˆæœç‰©: `complexity_report.md` ä½œæˆ âœ…
- [x] æˆæœç‰©: `phase0_summary.md` ä½œæˆ âœ…
- [x] **ä¸»è¦ç™ºè¦‹**: CA1001 (Disposeæœªå®Ÿè£…2ä»¶)ã€CS0162 (åˆ°é”ä¸èƒ½20+ä»¶)ã€å‰Šæ¸›è¦‹è¾¼ã¿485-585è¡Œ

#### 0.2 å…¨ä½“ãƒ•ãƒ­ãƒ¼èª¿æŸ» - âœ… å®Œäº† (2025-10-04)
- [x] ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ•ãƒ­ãƒ¼èª¿æŸ»ãƒ»æ–‡æ›¸åŒ– â†’ UltraThinkæ–¹æ³•è«–ã§å®Œå…¨èª¿æŸ»
- [x] BaketaCaptureNative.dllé€£æºè©³ç´°ç¢ºèª â†’ P/InvokeçµŒç”±ã€gRPCç§»è¡Œã¨ç„¡é–¢ä¿‚
- [x] P/Invokeå®£è¨€ã®æ­£ç¢ºæ€§æ¤œè¨¼ â†’ NativeWindowsCaptureWrapperä½¿ç”¨ç¢ºèª
- [x] SafeImageAdapterçµ±åˆçŠ¶æ³ç¢ºèª â†’ Phase 3.1çµ±åˆå•é¡Œã‚’ç‰¹å®š
- [x] ObjectDisposedExceptionæ ¹æœ¬åŸå› ç‰¹å®š â†’ å‹ã‚­ãƒ£ã‚¹ãƒˆäº’æ›æ€§å•é¡Œ
- [x] OCRãƒ•ãƒ­ãƒ¼èª¿æŸ»ãƒ»æ–‡æ›¸åŒ– â†’ PaddleOcrEngine (5,695è¡Œ) P0å•é¡Œç‰¹å®š
- [x] ProximityGroupingå®Ÿè£…ç¢ºèª â†’ å®Ÿè£…æ¸ˆã¿ç¢ºèª
- [x] æ®µéšçš„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ çµ±åˆçŠ¶æ³ç¢ºèª â†’ Phase 1ã§90.5%å‰Šæ¸›å®Ÿç¾
- [x] ç¿»è¨³ãƒ•ãƒ­ãƒ¼èª¿æŸ»ãƒ»æ–‡æ›¸åŒ– â†’ OptimizedPythonTranslationEngine (2,765è¡Œ) å‰Šé™¤å¯¾è±¡ç¢ºèª
- [x] StreamingTranslationServiceå®Ÿè£…çŠ¶æ³ç¢ºèª â†’ ãƒãƒƒãƒå‡¦ç†ãƒ•ãƒ­ãƒ¼ã‚’ç¢ºèª
- [x] ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤ºãƒ•ãƒ­ãƒ¼èª¿æŸ»ãƒ»æ–‡æ›¸åŒ– â†’ InPlaceTranslationOverlayManager (1,067è¡Œ) åˆ†å‰²å¯¾è±¡ç¢ºèª
- [x] METHOD_ENTRYãƒ­ã‚°ãŒå‡ºãªã„åŸå› ç‰¹å®š âš ï¸ â†’ WIDTH_FIXå®Ÿè£…ãƒ‘ã‚¹èª¿æŸ»å¿…è¦
- [x] ç¶™ç¶šç›£è¦–ãƒ•ãƒ­ãƒ¼èª¿æŸ»ãƒ»æ–‡æ›¸åŒ– â†’ 4æ®µéšé©å¿œå‹ã‚­ãƒ£ãƒ—ãƒãƒ£æˆ¦ç•¥ç¢ºèª
- [x] æˆæœç‰©: `phase0.2_flow_analysis.md` ä½œæˆ âœ…
- [x] **ä¸»è¦ç™ºè¦‹**: PaddleOcrEngine (P0, 5,695è¡Œ), WIDTH_FIXå•é¡Œ (P1), 4æ®µéšé©å¿œå‹æˆ¦ç•¥

#### 0.3 ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ”ãƒ³ã‚° - âœ… å®Œäº† (2025-10-05)
- [x] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–“ä¾å­˜é–¢ä¿‚å¯è¦–åŒ– â†’ Mermaidå½¢å¼ã‚°ãƒ©ãƒ•ä½œæˆã€Clean Architectureæº–æ‹ ç¢ºèª
- [x] NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ•´ç† â†’ ç´„70å€‹ã®ç›´æ¥å‚ç…§ã€2,069è¡Œåˆ†ã®æ¨ç§»çš„ä¾å­˜ã‚’åˆ†æ
- [x] æœªä½¿ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç‰¹å®š â†’ Google.Protobufï¼ˆPhase 2ã§ä½¿ç”¨äºˆå®šï¼‰ã€SharpDXï¼ˆä½¿ç”¨ä¸­ï¼‰ç¢ºèª
- [x] ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸æ•´åˆç¢ºèª â†’ Microsoft.Extensions.ObjectPoolï¼ˆ9.0.8ï¼‰ã®ã¿ä¸æ•´åˆã‚’æ¤œå‡º
- [x] å¾ªç’°å‚ç…§ç¢ºèª â†’ å¾ªç’°ä¾å­˜ãªã—ï¼ˆdependency_analysis.mdã§å†ç¢ºèªï¼‰
- [x] æˆæœç‰©: `dependency_graph.md` ä½œæˆ âœ…ï¼ˆMermaidå½¢å¼ã€5å±¤æ§‹é€ å›³ï¼‰
- [x] æˆæœç‰©: `package_analysis.md` ä½œæˆ âœ…ï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸æ•´åˆP0ã€æ›´æ–°ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ï¼‰
- [x] **ä¸»è¦ç™ºè¦‹**: Microsoft.Extensions.ObjectPoolä¸æ•´åˆï¼ˆP0ï¼‰ã€Google.Protobufæœªä½¿ç”¨ï¼ˆPhase 2ã§ä½¿ç”¨ï¼‰ã€ç´„100ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ›´æ–°å¯èƒ½

---

### Phase 1: ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤ãƒ»ã‚³ãƒ¼ãƒ‰å“è³ªæ”¹å–„ - âœ… 80%å®Œäº†

#### 1.1 Phase 16é–¢é€£ã‚³ãƒ¼ãƒ‰å®Œå…¨å‰Šé™¤ - âœ… å®Œäº† (2025-10-04)
- [x] Phase16UIOverlayModule.cs å‰Šé™¤ç¢ºèª â†’ å‰Šé™¤å®Œäº† (140è¡Œ)
- [x] AvaloniaOverlayRenderer.cs ä½¿ç”¨çŠ¶æ³ç¢ºèª â†’ ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®ã¿ã§ä½¿ç”¨ã€å‰Šé™¤å®Œäº†
- [x] é–¢é€£ã‚¤ãƒ™ãƒ³ãƒˆãƒ»ãƒãƒ³ãƒ‰ãƒ©ãƒ¼å‰Šé™¤ â†’ UnifiedSystemIntegrationTest.cså‰Šé™¤ (112è¡Œ)
- [x] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª â†’ æˆåŠŸ (0ã‚¨ãƒ©ãƒ¼ã€55è­¦å‘Š)
- [x] ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œï¼ˆå‰Šé™¤å¾Œï¼‰ â†’ å½±éŸ¿ãªã—
- [x] ã‚³ãƒ¡ãƒ³ãƒˆæ›´æ–° â†’ Program.cs, Phase15OverlayModule.csæ›´æ–°
- [x] å‰Šæ¸›åŠ¹æœæ¸¬å®š: **365è¡Œå‰Šæ¸›** (5ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã€4æŒ¿å…¥ã€365å‰Šé™¤)

#### 1.2 Disposeæœªå®Ÿè£…ä¿®æ­£ï¼ˆP0ï¼‰ - âœ… å®Œäº† (2025-10-04)
- [x] BackgroundTaskQueue.cs IDisposableå®Ÿè£… â†’ Disposeå®Ÿè£…å®Œäº†
- [x] SmartConnectionEstablisher.cs IDisposableå®Ÿè£… â†’ å…¨Strategy disposalå®Ÿè£…å®Œäº†
- [x] HttpHealthCheckStrategy disposalå®Ÿè£… â†’ IDisposableé©åˆ‡å®Ÿè£…
- [x] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª â†’ æˆåŠŸ (0ã‚¨ãƒ©ãƒ¼)
- [x] ãƒªã‚½ãƒ¼ã‚¹ãƒªãƒ¼ã‚¯ä¿®æ­£: **2ä»¶å®Œäº†**

#### 1.3 ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤ï¼ˆP1ï¼‰ - âœ… å®Œäº† (2025-10-04)
- [x] CS0162 åˆ°é”ä¸èƒ½ã‚³ãƒ¼ãƒ‰å‰Šé™¤ â†’ 20+ç®‡æ‰€å‰Šé™¤å®Œäº†
  - GameOptimizedPreprocessingService.cs: 78è¡Œ
  - BatchOcrProcessor.cs: 6è¡Œ
  - PortManagementService.cs: 2è¡Œ
  - ModelCacheManager.cs: 6è¡Œ
  - CacheManagementService.cs: 4è¡Œ
  - PaddleOcrEngine.cs: 47è¡Œ
- [x] CS0618 éæ¨å¥¨APIç§»è¡Œ â†’ IImageFactory namespaceæ›´æ–° (Imaging â†’ Factories)
- [x] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª â†’ æˆåŠŸ (0ã‚¨ãƒ©ãƒ¼)
- [x] å‰Šæ¸›åŠ¹æœæ¸¬å®š: **143è¡Œå‰Šæ¸›**

#### 1.4 CA1840ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ - âœ… å®Œäº† (2025-10-04)
- [x] Thread.CurrentThread.ManagedThreadId â†’ Environment.CurrentManagedThreadIdä¸€æ‹¬ç½®æ›
- [x] å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ç‰¹å®š â†’ 7ãƒ•ã‚¡ã‚¤ãƒ«ã€77ç®‡æ‰€ç‰¹å®š
- [x] ä¸€æ‹¬ç½®æ›å®Ÿè¡Œ:
  - WindowsImageFactory.cs: 4ç®‡æ‰€
  - AggregatedChunksReadyEventHandler.cs: 2ç®‡æ‰€
  - StreamingTranslationService.cs: 16ç®‡æ‰€
  - DefaultTranslationService.cs: 4ç®‡æ‰€
  - OptimizedPythonTranslationEngine.cs: 35ç®‡æ‰€
  - FixedSizeConnectionPool.cs: 14ç®‡æ‰€
  - TimedChunkAggregator.cs: 2ç®‡æ‰€
- [x] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª â†’ æˆåŠŸ (0ã‚¨ãƒ©ãƒ¼)
- [x] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„: **77ä»¶ç½®æ›å®Œäº†**

#### 1.5 æœªä½¿ç”¨NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å‰Šé™¤ - âš ï¸ ã‚¹ã‚­ãƒƒãƒ— (2025-10-04)
- [x] SharpDXä½¿ç”¨çŠ¶æ³èª¿æŸ» â†’ **å®Ÿéš›ã«ä½¿ç”¨ä¸­ã¨åˆ¤æ˜**
- [x] WinRTWindowCapture.csç²¾æŸ» â†’ 24ç®‡æ‰€ã§SharpDXä½¿ç”¨ç¢ºèª
- [x] GdiScreenCapturerçµŒç”±ã®å®Ÿè¡Œæ™‚ä½¿ç”¨ç¢ºèª â†’ IGdiScreenCapturerã¨ã—ã¦DIç™»éŒ²ç¢ºèª
- [x] **çµè«–**: SharpDXå‰Šé™¤ã«ã¯ä»¥ä¸‹ã®å‰æä½œæ¥­ãŒå¿…è¦ï¼ˆPhase 2ä»¥é™ï¼‰:
  1. GdiScreenCapturer â†’ WindowsGraphicsCapturerçµ±åˆ
  2. WinRTWindowCapture.cså»ƒæ­¢
  3. IGdiScreenCapturerã‚’NativeWindowsCaptureWrapperãƒ™ãƒ¼ã‚¹ã«å¤‰æ›´

---

### Phase 2: gRPCåŸºç›¤æ§‹ç¯‰ (5-7æ—¥) - ğŸŸ¡ é€²è¡Œä¸­ (2/3å®Œäº†)

**ğŸ“‹ å‰ææ¡ä»¶ï¼ˆPhase 0.3æˆæœç‰©æ´»ç”¨ï¼‰** - âœ… å®Œäº† (2025-10-05):
- [x] **P0**: `package_analysis.md`å‚ç…§ â†’ Microsoft.Extensions.ObjectPool 9.0.8 â†’ 8.0.0 ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ âœ…
- [x] **P1**: `package_analysis.md`å‚ç…§ â†’ Google.Protobuf 3.25.2 â†’ 3.32.1 æ›´æ–° âœ…

#### 2.1 Protoãƒ•ã‚¡ã‚¤ãƒ«è¨­è¨ˆ (1æ—¥) - âœ… å®Œäº† (2025-10-05)
- [x] **å‚ç…§**: `package_analysis.md` - Google.Protobufæœ€æ–°ç‰ˆï¼ˆ3.32.1ï¼‰ã§è¨­è¨ˆ âœ…
- [x] translation.protoè¨­è¨ˆ âœ… (`Baketa.Infrastructure/Translation/Protos/translation.proto`, 230è¡Œ)
- [x] TranslationServiceå®šç¾© âœ… (4 RPC methods: Translate, TranslateBatch, HealthCheck, IsReady)
- [x] TranslateRequest/Responseå®šç¾© âœ…
- [x] BatchTranslateRequest/Responseå®šç¾© âœ…
- [x] ~~CancelRequest/Responseå®šç¾©~~ â†’ Phase 12.2ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å®Ÿè£…æ™‚ã«å®Ÿæ–½
- [x] HealthCheckRequest/Responseå®šç¾© âœ…
- [x] IsReadyRequest/Responseå®šç¾© âœ… (æº–å‚™çŠ¶æ…‹ç¢ºèªç”¨)
- [x] Protoãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ç¢ºå®š âœ… (Geminiãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿæ–½)

**ğŸ“Š å®Ÿè£…ã‚µãƒãƒªãƒ¼**:
- **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸**: `baketa.translation.v1` (ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°å¯¾å¿œ)
- **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å®šç¾©**: 9ç¨®é¡ï¼ˆEnum 1, Basic 2, Complex 2, Main 2, Batch 2, Utility 4ï¼‰
- **å‹ãƒãƒƒãƒ”ãƒ³ã‚°**: Guidâ†’string, DateTimeâ†’Timestamp, Dictionaryâ†’map<string,string>, Exceptionâ†’3 strings
- **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ç•ªå·æˆ¦ç•¥**: 1-15ç•ª=1ãƒã‚¤ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ï¼ˆé »å‡ºï¼‰ã€16ç•ªä»¥é™=2ãƒã‚¤ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ï¼ˆæ‹¡å¼µç”¨ï¼‰
- **C#çµ±åˆ**: Grpc.Net.Client 2.70.0, Grpc.Tools 2.69.0 è¿½åŠ ã€`<Protobuf Include>` è¨­å®šå®Œäº†
- **ç”Ÿæˆã‚³ãƒ¼ãƒ‰**: Translation.cs, TranslationGrpc.cs (Baketa.Translation.V1 namespace)
- **ãƒ“ãƒ«ãƒ‰çµæœ**: âœ… æˆåŠŸ (è­¦å‘Šã®ã¿ã€ã‚¨ãƒ©ãƒ¼0ä»¶)

**ğŸ¯ Geminiãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœ**:
- **ç·è©•**: â­â­â­â­â­ éå¸¸ã«è³ªã®é«˜ã„è¨­è¨ˆã€ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«æº–æ‹ 
- **é«˜è©•ä¾¡**: Proto3ä»•æ§˜æº–æ‹ ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ç•ªå·æœ€é©é…ç½®ã€å¾Œæ–¹äº’æ›æ€§è€ƒæ…®ã€ãƒãƒ¼ãƒŸãƒ³ã‚°ä¸€è²«æ€§
- **æ”¹å–„ææ¡ˆ** (Phase 2.2/2.3ã§å¯¾å¿œ):
  1. `TranslationErrorType` enumé‡è¤‡å€¤çµ±åˆï¼ˆNETWORK vs NETWORK_ERRORç­‰ï¼‰
  2. `map<string, string>` â†’ `google.protobuf.Struct` æ´»ç”¨ï¼ˆå‹å®‰å…¨æ€§ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šï¼‰
  3. `<GenerateDocumentation>true</GenerateDocumentation>` è¿½åŠ ï¼ˆXML Docã‚³ãƒ¡ãƒ³ãƒˆç”Ÿæˆï¼‰

**ğŸ”® å°†æ¥æ‹¡å¼µãƒã‚¤ãƒ³ãƒˆ**:
- Phase 12.2: `rpc TranslateStream(stream TranslateRequest) returns (stream TranslateResponse);` äºˆç´„æ¸ˆã¿ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰

#### 2.2 Python gRPCã‚µãƒ¼ãƒãƒ¼å®Ÿè£… (2-3æ—¥) - âš ï¸ å®Œäº†ï¼ˆCTranslate2æœªçµ±åˆï¼‰ (2025-10-06)
- [x] **å‚ç…§**: `package_analysis.md` - gRPCé–¢é€£ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª âœ…
- [x] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ä½œæˆï¼ˆgrpc_server/ï¼‰ âœ… (`grpc_server/`, `engines/`, `protos/`)
- [x] translation_server.pyå®Ÿè£… âœ… (TranslationServicer, 4 RPC methods, ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆæ¸ˆã¿)
- [x] engines/base.pyå®Ÿè£… âœ… (TranslationEngineæŠ½è±¡ã‚¯ãƒ©ã‚¹, Strategy Pattern)
- [x] engines/nllb_engine.pyå®Ÿè£… âœ… (NLLB-200å®Ÿè£…, GPUæœ€é©åŒ–, ãƒãƒƒãƒå‡¦ç†)
- [ ] ~~gemini_translator.pyå®Ÿè£…~~ â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æ±‚ã«ã‚ˆã‚Šæœªå®Ÿè£…ï¼ˆå°†æ¥å¯¾å¿œï¼‰
- [x] requirements.txtä½œæˆï¼ˆgrpcio, grpcio-toolsï¼‰ âœ…
- [x] start_server.pyå®Ÿè£… âœ… (ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆ, graceful shutdown)
- [x] README.mdä½œæˆ âœ… (ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †, ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°, 280è¡Œ)
- [ ] HealthCheckå‹•ä½œç¢ºèª â†’ Proto compilationå¾Œã«å®Ÿæ–½
- [ ] å˜ä½“ç¿»è¨³å‹•ä½œç¢ºèª â†’ Proto compilationå¾Œã«å®Ÿæ–½
- [ ] ãƒãƒƒãƒç¿»è¨³å‹•ä½œç¢ºèª â†’ Proto compilationå¾Œã«å®Ÿæ–½

**ğŸ“Š å®Ÿè£…ã‚µãƒãƒªãƒ¼**:
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ **: `grpc_server/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆã€3ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (`engines/`, `protos/`, `__init__.py`)
- **ç¿»è¨³ã‚¨ãƒ³ã‚¸ãƒ³æŠ½è±¡åŒ–**: `TranslationEngine` æŠ½è±¡ã‚¯ãƒ©ã‚¹ï¼ˆStrategy Patternï¼‰ã§å°†æ¥ã®Geminiçµ±åˆã«å¯¾å¿œ
  - `engines/base.py` (152è¡Œ): æŠ½è±¡ãƒ¡ã‚½ãƒƒãƒ‰5ã¤ã€ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–5ç¨®é¡
  - `engines/nllb_engine.py` (310è¡Œ): NLLB-200å®Ÿè£…ã€GPUæœ€é©åŒ–ã€ãƒãƒƒãƒå‡¦ç†ï¼ˆmax 32ï¼‰
- **gRPCã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…**: `translation_server.py` (344è¡Œ)
  - `TranslationServicer` ã‚¯ãƒ©ã‚¹: 4 RPCãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆTranslate, TranslateBatch, HealthCheck, IsReadyï¼‰
  - ã‚¨ãƒ©ãƒ¼ãƒãƒƒãƒ”ãƒ³ã‚°: Pythonä¾‹å¤– â†’ grpc.StatusCode
  - **æ³¨**: Proto compilationå¾…ã¡ã®ãŸã‚ã‚³ãƒ¼ãƒ‰å¤§éƒ¨åˆ†ãŒã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
- **ã‚µãƒ¼ãƒãƒ¼èµ·å‹•**: `start_server.py` (173è¡Œ)
  - CLIå¼•æ•°ãƒ‘ãƒ¼ã‚¹ï¼ˆ--port, --host, --heavy-model, --debugï¼‰
  - Graceful shutdownå®Ÿè£…ï¼ˆSIGINT/SIGTERMå¯¾å¿œï¼‰
  - NLLBã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–ï¼†ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—
- **ä¾å­˜é–¢ä¿‚**: `requirements.txt` (grpcio>=1.60.0, transformers>=4.30.0, torch>=2.0.0ç­‰)
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: `README.md` (280è¡Œ) - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€è¨€èªã‚µãƒãƒ¼ãƒˆè¡¨

**ğŸ¯ æŠ€è¡“çš„ãƒã‚¤ãƒ©ã‚¤ãƒˆ**:
- **è¨€èªãƒãƒƒãƒ”ãƒ³ã‚°**: ISO 639-1 â†’ NLLB-200 BCP-47 (enâ†’eng_Latn, jaâ†’jpn_Jpanç­‰ã€10è¨€èªå¯¾å¿œ)
- **ãƒ¢ãƒ‡ãƒ«é¸æŠ**: è»½é‡ç‰ˆ600Mï¼ˆ2.4GBï¼‰vs é‡é‡ç‰ˆ1.3Bï¼ˆ5GBï¼‰ã€ãƒ¡ãƒ¢ãƒªãƒ™ãƒ¼ã‚¹è‡ªå‹•é¸æŠ
- **GPUæœ€é©åŒ–**: CUDA/CPUè‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€torch.float16ã§ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡åŠæ¸›
- **éåŒæœŸå‡¦ç†**: `asyncio.to_thread()` ã§PyTorchã®åŒæœŸå‡¦ç†ã‚’éãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°åŒ–
- **Strategy Pattern**: å°†æ¥ã®Gemini APIçµ±åˆã‚’è¦‹æ®ãˆãŸæŠ½è±¡åŒ–è¨­è¨ˆ

**ğŸ“ æœªå®Ÿè£…é …ç›®ã¨ç†ç”±**:
- **Gemini APIçµ±åˆ**: ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºçš„æŒ‡ç¤ºã€Œç¿»è¨³ã®Gemini APIã¯ã¾ã å®Ÿè£…ã—ãªã„ã®ã§ä»Šå¾Œå®Ÿè£…ã•ã‚Œã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ãŠãã«ã¨ã©ã‚ã‚‹ã“ã¨ã€
- **Proto compilation**: `grpcio-tools` æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å¾Œã«ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚³ãƒ¼ãƒ‰æœ‰åŠ¹åŒ–äºˆå®š
- **å‹•ä½œç¢ºèªãƒ†ã‚¹ãƒˆ**: Proto compilationå®Œäº†å¾Œã«å®Ÿæ–½äºˆå®š

**ğŸš¨ é‡å¤§ãªå•é¡Œç‚¹ï¼ˆPhase 2.2.1ã§å¯¾å¿œå¿…è¦ï¼‰**:
- **CTranslate2æœªçµ±åˆ**: æ—¢å­˜ã®stdin/stdoutç‰ˆï¼ˆ`nllb_translation_server_ct2.py`ï¼‰ã§ã¯80%ãƒ¡ãƒ¢ãƒªå‰Šæ¸›ï¼ˆ2.4GBâ†’500MBï¼‰ã‚’å®Ÿç¾ã—ã¦ã„ãŸãŒã€gRPCç‰ˆã§ã¯**transformersç›´æ¥ä½¿ç”¨ã§2.4GBæ¶ˆè²»**
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ–**: CTranslate2ã®20-30%é«˜é€ŸåŒ–ã‚‚æœªæ´»ç”¨
- **ãƒªã‚½ãƒ¼ã‚¹åŠ¹ç‡æ‚ªåŒ–**: int8é‡å­åŒ–ã‚¨ãƒ³ã‚¸ãƒ³ã®æˆæœã‚’å®Œå…¨ã«è¦‹é€ƒã—ãŸå®Ÿè£…

**ğŸ“Š æ¯”è¼ƒ: æ—¢å­˜CTranslate2ç‰ˆ vs ä»Šå›gRPCç‰ˆ**:
| é …ç›® | CTranslate2ç‰ˆï¼ˆstdin/stdoutï¼‰ | gRPCç‰ˆï¼ˆPhase 2.2ï¼‰ | å·®åˆ† |
|------|------------------------------|---------------------|------|
| ãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚º | **500MB** | 2.4GB | **4.8å€æ‚ªåŒ–** |
| ãƒ¡ãƒ¢ãƒªå¸¸é§ | **500MB** | 2.4GB | **4.8å€æ‚ªåŒ–** |
| æ¨è«–é€Ÿåº¦ | 20-30%é«˜é€ŸåŒ– | ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ | **æœ€é©åŒ–ãªã—** |
| æŠ€è¡“ | ctranslate2 + int8é‡å­åŒ– | transformers + torch | **å¾Œé€€** |

**ğŸ”§ Phase 2.2.1ï¼ˆç·Šæ€¥è¿½åŠ ã‚¿ã‚¹ã‚¯ï¼‰ææ¡ˆ**:
- [ ] `grpc_server/engines/ctranslate2_engine.py` å®Ÿè£…
- [ ] æ—¢å­˜ã®`scripts/nllb_translation_server_ct2.py`ã‹ã‚‰CTranslate2ãƒ­ã‚¸ãƒƒã‚¯ç§»æ¤
- [ ] 80%ãƒ¡ãƒ¢ãƒªå‰Šæ¸› + 20-30%é«˜é€ŸåŒ–ã‚’ gRPCã§å®Ÿç¾
- [ ] `models/nllb-200-ct2/` å¤‰æ›æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«æ´»ç”¨

**âœ… Proto compilationå®Œäº†ï¼ˆ2025-10-06ï¼‰**:
- âœ… grpcio 1.75.1, grpcio-tools 1.75.1 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- âœ… translation_pb2.py, translation_pb2_grpc.py, translation_pb2.pyi ç”Ÿæˆ
- âœ… ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆè§£é™¤å®Œäº†
- âœ… Pythonã‚µãƒ¼ãƒãƒ¼èµ·å‹•æˆåŠŸï¼ˆ0.0.0.0:50051ï¼‰
- âœ… NLLB-200ãƒ¢ãƒ‡ãƒ«ãƒ­ãƒ¼ãƒ‰æˆåŠŸï¼ˆGPUã€3.5-7.5ç§’ï¼‰
- âœ… 10è¨€èªã‚µãƒãƒ¼ãƒˆç¢ºèª

#### 2.2.1 CTranslate2çµ±åˆï¼ˆç·Šæ€¥è¿½åŠ ã‚¿ã‚¹ã‚¯ï¼‰ (1-2æ—¥) - âœ… **å®Œäº†** (2025-10-06)

**èƒŒæ™¯**: Phase 2.2ã§transformersç›´æ¥ä½¿ç”¨ã«ã‚ˆã‚Šã€æ—¢å­˜ã®80%ãƒ¡ãƒ¢ãƒªå‰Šæ¸›ï¼ˆ2.4GBâ†’500MBï¼‰ã‚’è¦‹é€ƒã—ãŸã€‚gRPCç‰ˆã§ã‚‚CTranslate2çµ±åˆãŒå¿…é ˆã€‚

**å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**:
- `docs/CTRANSLATE2_INTEGRATION_COMPLETE.md` - 2025-09-26å®Œäº†ã®çµ±åˆæ‰‹é †
- `scripts/nllb_translation_server_ct2.py` - æ—¢å­˜CTranslate2å®Ÿè£…ï¼ˆstdin/stdoutç‰ˆï¼‰
- `scripts/convert_nllb_to_ctranslate2.py` - NLLB-200 â†’ CTranslate2å¤‰æ›ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

**å®Ÿè£…ã‚¿ã‚¹ã‚¯**:
- [x] **å‚ç…§**: `scripts/nllb_translation_server_ct2.py` - CTranslate2ãƒ­ã‚¸ãƒƒã‚¯ç†è§£ âœ…
- [x] `grpc_server/engines/ctranslate2_engine.py` å®Ÿè£… âœ… (430è¡Œå®Ÿè£…)
  - [x] `ctranslate2.Translator` åˆæœŸåŒ– âœ…
  - [x] `sentencepiece` ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼çµ±åˆ âœ…
  - [x] è¨€èªã‚³ãƒ¼ãƒ‰ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆISO 639-1 â†’ NLLB BCP-47ï¼‰ âœ…
  - [x] `translate()` ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£… âœ…
  - [x] `translate_batch()` ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…ï¼ˆGPUæœ€é©åŒ–ï¼‰ âœ…
  - [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆæ—¢å­˜ä¾‹å¤–ã‚¯ãƒ©ã‚¹ä½¿ç”¨ï¼‰ âœ…
- [x] `grpc_server/requirements.txt` æ›´æ–° âœ…
  - [x] `ctranslate2>=3.20.0` è¿½åŠ  âœ…
  - [x] `sentencepiece>=0.1.99` è¿½åŠ  âœ…
- [x] `models/nllb-200-ct2/` å¤‰æ›æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«æ´»ç”¨ç¢ºèª âœ…
  - [x] ãƒ¢ãƒ‡ãƒ«ãƒ‘ã‚¹: `models/nllb-200-ct2/` å­˜åœ¨ç¢ºèª âœ… (594MB, 75%å‰Šæ¸›)
  - [x] å¤‰æ›æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«: model.bin (594MB), shared_vocabulary.json (5.9MB) âœ…
- [x] `start_server.py` ã‚¨ãƒ³ã‚¸ãƒ³åˆ‡ã‚Šæ›¿ãˆå®Ÿè£… âœ…
  - [x] `--use-ctranslate2` ãƒ•ãƒ©ã‚°è¿½åŠ  âœ…
  - [x] CTranslate2Engine vs NllbEngine é¸æŠãƒ­ã‚¸ãƒƒã‚¯ âœ…
- [x] å‹•ä½œç¢ºèªãƒ†ã‚¹ãƒˆ âœ…
  - [x] ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆCTranslate2ãƒ¢ãƒ¼ãƒ‰ï¼‰ âœ…
  - [x] ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç¢ºèªï¼ˆ610MBã€74.6%å‰Šæ¸›é”æˆï¼‰ âœ…
  - [x] ç¿»è¨³é€Ÿåº¦ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ï¼ˆãƒ­ãƒ¼ãƒ‰æ™‚é–“3.79ç§’ã€NllbEngineã¨åŒç­‰ï¼‰ âœ…
  - [x] ç¿»è¨³å“è³ªç¢ºèªï¼ˆæ—¢å­˜å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³å®Œå…¨ç§»æ¤ï¼‰ âœ…

**æœŸå¾…åŠ¹æœ**:
- **ãƒ¡ãƒ¢ãƒªå‰Šæ¸›**: 2.4GB â†’ 500MBï¼ˆ80%å‰Šæ¸›ï¼‰
- **æ¨è«–é«˜é€ŸåŒ–**: 20-30%é«˜é€ŸåŒ–
- **æ—¢å­˜è³‡ç”£æ´»ç”¨**: 2025-09-26å®Œäº†ã®CTranslate2çµ±åˆæˆæœã‚’ gRPCã§å®Ÿç¾

**å„ªå…ˆåº¦**: **P0ï¼ˆPhase 2.3ã‚ˆã‚Šå„ªå…ˆï¼‰** - ãƒ¡ãƒ¢ãƒªåŠ¹ç‡æ‚ªåŒ–ã¯æœ¬ç•ªé‹ç”¨ã§è‡´å‘½çš„

#### 2.3 C# gRPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£… (2-3æ—¥) - âœ… **å®Œå…¨å®Œäº†** (2025-10-06)
- [x] **å‚ç…§**: `dependency_graph.md` - Infrastructureå±¤ã¸ã®é…ç½®æ±ºå®šï¼ˆClean Architectureæº–æ‹ ï¼‰ âœ…
- [x] **å‚ç…§**: `package_analysis.md` - Grpc.Net.Clientè¿½åŠ ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ•´åˆæ€§ç¢ºèª âœ…
- [x] ITranslationClient.csè¨­è¨ˆ âœ… (å‰ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†)
- [x] TranslationResult recordå®šç¾© âœ… (å‰ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†)
- [x] GrpcTranslationClient.cså®Ÿè£…ï¼ˆBaketa.Infrastructure/Translation/Clients/ï¼‰ âœ… (å‰ã‚»ãƒƒã‚·ãƒ§ãƒ³258è¡Œå®Ÿè£…)
- [x] TranslateAsyncå®Ÿè£… âœ…
- [x] TranslateBatchAsyncå®Ÿè£… âœ…
- [x] CancelTranslationAsyncå®Ÿè£… âœ…
- [x] IsHealthyAsyncå®Ÿè£… âœ…
- [x] **DIçµ±åˆ**: RegisterTranslationSettings()ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£… âœ…
- [x] **è¨­å®šãƒ­ãƒ¼ãƒ‰**: appsettings.json â†’ TranslationSettings âœ…
- [x] **ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼**: P0/P1æŒ‡æ‘˜äº‹é …åæ˜ å®Œäº† âœ…
- [x] **çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**: gRPCçµŒç”±ç¿»è¨³å®Œå…¨å‹•ä½œç¢ºèªï¼ˆ753msã€Chrono Triggerå®Ÿæ¸¬ï¼‰ âœ…
- [ ] ~~StdinStdoutTranslationClient.csä¸¦è¡Œç¨¼åƒç¢ºèª~~ â†’ N/Aï¼ˆPhase 3.3ã§å‰Šé™¤äºˆå®šã€ä¸¦è¡Œç¨¼åƒä¸è¦ï¼‰
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆä½œæˆ â†’ Phase 3ã§å®Ÿæ–½äºˆå®šï¼ˆGrpcTranslationClientã®xUnit+Moqãƒ†ã‚¹ãƒˆï¼‰

---

### Phase 3: é€šä¿¡å±¤æŠ½è±¡åŒ–ãƒ»ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— (4.5-5.5æ—¥) - ğŸ”´ æœªç€æ‰‹

#### 3.1 OptimizedPythonTranslationEngineå‰Šé™¤ (1æ—¥)
- [ ] **å‚ç…§**: `dependency_graph.md` - Infrastructureå±¤ä¾å­˜é–¢ä¿‚ã€å½±éŸ¿ç¯„å›²ç¢ºèªï¼ˆApplicationå±¤ã€ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰
- [ ] GrpcTranslationEngineAdapter.cså®Ÿè£…
- [ ] DIç™»éŒ²åˆ‡ã‚Šæ›¿ãˆï¼ˆITranslationClientä½¿ç”¨ï¼‰
- [ ] OptimizedPythonTranslationEngine.cså‰Šé™¤ï¼ˆ2,765è¡Œï¼‰
- [ ] OperationIdæ‰‹å‹•ç®¡ç†ã‚³ãƒ¼ãƒ‰å‰Šé™¤
- [ ] TaskCompletionSourceè¤‡é›‘ãªåˆ¶å¾¡å‰Šé™¤
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª
- [ ] ç¿»è¨³æ©Ÿèƒ½å‹•ä½œç¢ºèª

#### 3.2 TranslationServiceéšå±¤æ•´ç† (1æ—¥)
- [ ] **å‚ç…§**: `dependency_graph.md` - Applicationå±¤ä¾å­˜é–¢ä¿‚ã€è²¬ä»»åˆ†é›¢è¨­è¨ˆ
- [ ] DefaultTranslationServiceè²¬ä»»æ˜ç¢ºåŒ–
- [ ] StreamingTranslationServiceè²¬ä»»æ˜ç¢ºåŒ–
- [ ] é‡è¤‡ã‚³ãƒ¼ãƒ‰å‰Šé™¤
- [ ] çµ±åˆå¯èƒ½æ€§æ¤œè¨
- [ ] ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Ÿæ–½

#### 3.3 stdin/stdoutå®Œå…¨å‰Šé™¤ (1æ—¥)
- [ ] StdinStdoutTranslationClient.cså‰Šé™¤
- [ ] Python stdin/stdoutã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ¼ãƒ‰å‰Šé™¤
- [ ] é–¢é€£è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
- [ ] ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰å‰Šé™¤
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª
- [ ] å…¨ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œ

#### 3.4A **OCRã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯åˆ†é›¢ï¼ˆUnion-Findï¼‰** (1æ—¥) - âœ… **å®Œäº† (2025-10-07)** ğŸ”¥ **Geminiæ¨å¥¨Clean Architectureæ”¹å–„**
- [x] **å•é¡Œ**: ç¾åœ¨ã®FindNearbyRegions()ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒã€Œä¸€åº¦å‡¦ç†æ¸ˆã¿=ä»–ã‚°ãƒ«ãƒ¼ãƒ—å‚åŠ ä¸å¯ã€åˆ¶ç´„ã«ã‚ˆã‚Šã€å‚ç›´ã«ä¸¦ã‚“ã 3ãƒãƒ£ãƒ³ã‚¯ã‚’2ã‚°ãƒ«ãƒ¼ãƒ—ã«åˆ†é›¢
  - OCRæ¤œå‡º: 3ãƒãƒ£ãƒ³ã‚¯ â†’ ProximityGroupingå¾Œ: 2ãƒãƒ£ãƒ³ã‚¯ï¼ˆChunk 0+2ãŒ1ã‚°ãƒ«ãƒ¼ãƒ—ã€Chunk 1ãŒå˜ç‹¬ï¼‰
  - æ ¹æœ¬åŸå› : processedRegionsã‚»ãƒƒãƒˆã«ã‚ˆã‚‹é€æ¬¡çš„ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°
  - æœŸå¾…å‹•ä½œ: 3ãƒãƒ£ãƒ³ã‚¯å…¨ã¦1ã‚°ãƒ«ãƒ¼ãƒ—ã«çµ±åˆï¼ˆdeltaY=113.5px < verticalThreshold=166.86pxï¼‰
- [x] **IRegionGroupingStrategy**ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©ï¼ˆCoreå±¤ï¼‰
  - GroupRegions(IReadOnlyList<OcrTextRegion>, ProximityContext) ãƒ¡ã‚½ãƒƒãƒ‰
  - Clean Architectureæº–æ‹ ã€Strategyãƒ‘ã‚¿ãƒ¼ãƒ³é©ç”¨
- [x] **UnionFind**ãƒ‡ãƒ¼ã‚¿æ§‹é€ å®Ÿè£…ï¼ˆInfrastructureå±¤ï¼‰
  - `Infrastructure/OCR/Clustering/UnionFind.cs` ä½œæˆ
  - Union(int x, int y) ãƒ¡ã‚½ãƒƒãƒ‰
  - Find(int x) ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆçµŒè·¯åœ§ç¸®æœ€é©åŒ–ï¼‰
- [x] **UnionFindRegionGroupingStrategy**å®Ÿè£…ï¼ˆInfrastructureå±¤ï¼‰
  - `Infrastructure/OCR/Clustering/UnionFindRegionGroupingStrategy.cs` ä½œæˆ
  - å…¨ãƒšã‚¢ã®è·é›¢è¨ˆç®— â†’ Union-Findã§é€£çµæˆåˆ†æ¤œå‡º
  - AreRegionsClose()ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆæ—¢å­˜ã®è·é›¢åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯å†åˆ©ç”¨ï¼‰
- [x] **BatchOcrProcessor**ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
  - GroupTextIntoChunksAsync()å†…ã®processedRegionså‰Šé™¤
  - FindNearbyRegions()ãƒ¡ã‚½ãƒƒãƒ‰å‰Šé™¤
  - IRegionGroupingStrategyæ³¨å…¥ï¼ˆDIï¼‰
  - ä¸€åº¦ã®å‘¼ã³å‡ºã—ã§å…¨ã‚°ãƒ«ãƒ¼ãƒ—å–å¾—
- [x] DIç™»éŒ²ï¼ˆInfrastructureModuleï¼‰
- [x] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª
- [x] 3ãƒãƒ£ãƒ³ã‚¯â†’1ã‚°ãƒ«ãƒ¼ãƒ—çµ±åˆå‹•ä½œç¢ºèª
- [x] ç¿»è¨³çµæœçµ±åˆç¢ºèªï¼ˆ1ãƒãƒƒãƒç¿»è¨³ï¼‰
- [x] **Geminiã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿæ–½** (2025-10-07)
  - âœ… Union-Findå®Ÿè£…æ­£ç¢ºæ€§: çµŒè·¯åœ§ç¸®ã¨ãƒ©ãƒ³ã‚¯çµåˆã‚’æ­£ã—ãå®Ÿè£…
  - âœ… è¨ˆç®—é‡O(NÂ² Î±(N))é”æˆç¢ºèª
  - âœ… Clean Architectureæº–æ‹ ç¢ºèª
  - âš ï¸ æŒ‡æ‘˜: é–¾å€¤ã®ç¡¬ç›´æ€§ãƒªã‚¹ã‚¯ï¼ˆãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºå¤šæ§˜æ€§ï¼‰
  - ğŸ’¡ æ”¹å–„ææ¡ˆ: å‹•çš„é–¾å€¤èª¿æ•´ï¼ˆæ—¢ã«éƒ¨åˆ†å®Ÿè£…æ¸ˆã¿ - IsTextWrappedOrNextLineç­‰ï¼‰
  - ğŸ’¡ å°†æ¥èª²é¡Œ: k-dæœ¨/å››åˆ†æœ¨ã§O(N log N)è¿‘å‚æ¢ç´¢æœ€é©åŒ–

**æŠ€è¡“è©³ç´°ï¼ˆGeminiãƒ¬ãƒ“ãƒ¥ãƒ¼æ¨å¥¨ï¼‰**:
```
ä¿®æ­£å‰:
foreach (var region in regions)
{
    if (processedRegions.Contains(region)) continue;
    var group = FindNearbyRegions(region, regions, processedRegions);
    processedRegions.UnionWith(group);  // â† ä»–ã‚°ãƒ«ãƒ¼ãƒ—å‚åŠ ä¸å¯
}
â†’ çµæœ: Chunk 0+2ã‚°ãƒ«ãƒ¼ãƒ—ã€Chunk 1å˜ç‹¬

ä¿®æ­£å¾Œ:
var uf = new UnionFind(regions.Count);
for (int i = 0; i < regions.Count; i++)
    for (int j = i + 1; j < regions.Count; j++)
        if (AreRegionsClose(regions[i], regions[j]))
            uf.Union(i, j);  // â† ä»»æ„æ®µéšé€£é–å¯¾å¿œ
var groups = uf.GetConnectedComponents();
â†’ çµæœ: Chunk 0+1+2ãŒ1ã‚°ãƒ«ãƒ¼ãƒ—ã«çµ±åˆ
```

**æœŸå¾…åŠ¹æœ**:
- **æ ¹æœ¬è§£æ±º**: processedRegionsåˆ¶ç´„å®Œå…¨è§£æ¶ˆ
- **æ•°å­¦çš„æ­£ç¢ºæ€§**: ã‚°ãƒ©ãƒ•ç†è«–ã®æ¨™æº–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆUnion-Findï¼‰æ¡ç”¨
- **Clean Architectureæº–æ‹ **: è²¬å‹™åˆ†é›¢ï¼ˆBatchOcrProcessorã‹ã‚‰åˆ†é›¢ï¼‰
- **æ‹¡å¼µæ€§**: è·é›¢ãƒ¡ãƒˆãƒªã‚¯ã‚¹å¤‰æ›´ã«æŸ”è»Ÿå¯¾å¿œ
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: O(NÂ²) â†’ O(NÂ² Î±(N))ï¼ˆå®Ÿè³ªçš„ã«æ”¹å–„ï¼‰

#### 3.4B **TimedAggregatoræ”¹å–„ï¼ˆç·Šæ€¥è¿½åŠ ï¼‰** (0.5æ—¥) - âš ï¸ **UltraThinkæ¤œå‡ºãƒã‚°ä¿®æ­£**
- [ ] **ãƒã‚°1**: ForceFlushMsã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆèª¤æ¤œçŸ¥ä¿®æ­£
  - å•é¡Œ: `timeSinceLastReset: 9718ms > ForceFlushMs: 3000ms` ã§å³åº§ãƒ•ãƒ©ãƒƒã‚·ãƒ¥
  - åŸå› : å‰å›ãƒªã‚»ãƒƒãƒˆã‹ã‚‰ã®çµŒéæ™‚é–“ãŒè“„ç©ã—ã€æœ€åˆã®ãƒãƒ£ãƒ³ã‚¯ã§æ—¢ã«è¶…é
  - ä¿®æ­£: ãƒãƒ£ãƒ³ã‚¯è¿½åŠ æ™‚ã« `_lastResetTime` ã‚’ç¾åœ¨æ™‚åˆ»ã«ãƒªã‚»ãƒƒãƒˆ
  - æœŸå¾…åŠ¹æœ: 3ãƒãƒ£ãƒ³ã‚¯ãŒ1ãƒãƒƒãƒã«çµ±åˆã•ã‚Œã‚‹
- [ ] **è¨­å®šè¦‹ç›´ã—**: `ForceFlushMs: 3000ms` â†’ `ForceFlushMs: 5000ms` æ¤œè¨
- [ ] ProximityGroupingå‹•ä½œç¢ºèªï¼ˆæ—¢ã«æ­£å¸¸å‹•ä½œä¸­ï¼‰
- [ ] ç¿»è¨³çµæœçµ±åˆç¢ºèª
- [ ] ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤º1å›åŒ–ç¢ºèª

**æŠ€è¡“è©³ç´°**:
```
ç¾çŠ¶å•é¡Œ:
[22:19:12.690] timeSinceLastReset: 9718.4298ms, ForceFlushMs: 3000ms
â†’ 1ãƒãƒ£ãƒ³ã‚¯è¿½åŠ æ™‚ç‚¹ã§å³åº§ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ â†’ 'ãƒ•ãƒªãƒƒãƒ„...' ã®ã¿ç¿»è¨³

[22:19:13.843] timeSinceLastReset: 16.6709ms
â†’ 150msã‚¿ã‚¤ãƒãƒ¼ç™ºç« â†’ 'ã”ã–ã„ã¾ã—ãŸã€‚' ã®ã¿ç¿»è¨³

ä¿®æ­£å¾ŒæœŸå¾…å‹•ä½œ:
3ãƒãƒ£ãƒ³ã‚¯åŒæ™‚è¿½åŠ  â†’ 150mså¾…æ©Ÿ â†’ 1ãƒãƒƒãƒç¿»è¨³ â†’ 1ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤º
```

---

### Phase 4: UIå±¤ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° (5-7æ—¥) - ğŸ”´ æœªç€æ‰‹

**ğŸ“‹ å‰ææ¡ä»¶ï¼ˆPhase 2å®Œäº†å¾Œã€Phase 0.3æˆæœç‰©æ´»ç”¨ï¼‰**:
- [ ] **å‚ç…§**: `package_analysis.md` - Avalonia 11.2.7 â†’ 11.3.7æ›´æ–°æ¤œè¨
- [ ] **å‚ç…§**: `package_analysis.md` - ReactiveUI 20.1.63 â†’ 22.0.1æ›´æ–°æ¤œè¨ï¼ˆç ´å£Šçš„å¤‰æ›´ç¢ºèªï¼‰

#### 4.1 InPlaceTranslationOverlayManageråˆ†å‰² (3-4æ—¥)
- [ ] **å‚ç…§**: `dependency_graph.md` - UIå±¤ä¾å­˜é–¢ä¿‚ï¼ˆApplication, Infrastructure.Platformï¼‰ç¢ºèª
- [ ] IInPlaceOverlayFactory.csè¨­è¨ˆ
- [ ] InPlaceOverlayFactory.cså®Ÿè£…
- [ ] CreateOverlayå®Ÿè£…
- [ ] ConfigureOverlayå®Ÿè£…ï¼ˆWIDTH_FIXå«ã‚€ï¼‰
- [ ] IOverlayPositioningServiceçµ±åˆ
- [ ] InPlaceTranslationOverlayManager.csç°¡ç´ åŒ–ï¼ˆ1,067è¡Œ â†’ 300è¡Œï¼‰
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª
- [ ] ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤ºå‹•ä½œç¢ºèª

#### 4.2 WIDTH_FIXå•é¡Œã®å®Œå…¨è§£æ±º (1æ—¥)
- [ ] METHOD_ENTRYãƒ­ã‚°ãŒå‡ºãªã„åŸå› å®Œå…¨è§£æ˜
- [ ] å®Ÿéš›ã®å®Ÿè¡Œãƒ‘ã‚¹ç¢ºèª
- [ ] Factoryã§WIDTH_FIXç¢ºå®Ÿé©ç”¨
- [ ] ãƒ­ã‚°å‡ºåŠ›ç¢ºèª
- [ ] ç›®è¦–ç¢ºèªï¼ˆå¹…å›ºå®šã•ã‚Œã¦ã„ã‚‹ã‹ï¼‰
- [ ] è¤‡æ•°ãƒãƒ£ãƒ³ã‚¯ã§å‹•ä½œç¢ºèª

#### 4.3 ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼æ•´ç† (1-2æ—¥)
- [ ] AggregatedChunksReadyEventHandlerè²¬ä»»æ˜ç¢ºåŒ–
- [ ] CaptureCompletedHandlerè²¬ä»»æ˜ç¢ºåŒ–
- [ ] TranslationCompletedHandlerè²¬ä»»æ˜ç¢ºåŒ–
- [ ] ä¸è¦ãªãƒ­ã‚°å‰Šé™¤
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª

#### 4.4 **ç”»é¢å¤‰åŒ–æ¤œçŸ¥ã«ã‚ˆã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è‡ªå‹•æ¶ˆå»å®Ÿè£…** (1æ—¥) - âš ï¸ **UltraThinkæ¤œå‡ºæ©Ÿèƒ½ä¸å…¨**
- [ ] **ãƒã‚°2**: TextDisappearanceEventç™ºè¡Œæ¡ä»¶ã®ä¿®æ­£
  - **ç¾çŠ¶**: `ImageChangeDetectionStageStrategy.cs:536-564`ã®æ¡ä»¶ãŒèª¤ã‚Š
    ```csharp
    // èª¤ã£ãŸæ¡ä»¶: ãƒ†ã‚­ã‚¹ãƒˆæ¶ˆå¤±æ™‚ã«å¤‰åŒ–ãŒã‚ã‚‹ãŸã‚æ¡ä»¶ä¸ä¸€è‡´
    if (previousImage != null && !changeResult.HasChanged)
    {
        await _eventAggregator.PublishAsync(disappearanceEvent);
    }
    ```
  - **å•é¡Œ**: ãƒ†ã‚­ã‚¹ãƒˆæ¶ˆå¤± = ç”»é¢å¤‰åŒ– = `changeResult.HasChanged = true` â†’ ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œã•ã‚Œãªã„
  - **ä¿®æ­£**: æ¡ä»¶ã‚’ã€Œå¤‰åŒ–ãŒã‚ã‚‹ + OCRãƒ†ã‚­ã‚¹ãƒˆæ¸›å°‘ã€ã«å¤‰æ›´
    ```csharp
    // æ­£ã—ã„æ¡ä»¶: å¤‰åŒ–ãŒã‚ã‚‹ ã‹ã¤ ãƒ†ã‚­ã‚¹ãƒˆæ¶ˆå¤±ã‚’ç¤ºã™
    if (previousImage != null && changeResult.HasChanged && IsTextDisappearance(changeResult))
    {
        await _eventAggregator.PublishAsync(disappearanceEvent);
    }
    ```
- [ ] **ImageChangeDetectionStageStrategy**ä¿®æ­£
  - `TryPublishTextDisappearanceEventAsync()`ãƒ¡ã‚½ãƒƒãƒ‰ä¿®æ­£
  - `IsTextDisappearance(ImageChangeResult)`ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
    - OCRçµæœæ¯”è¼ƒï¼ˆå‰å›vsä»Šå›ã®ãƒ†ã‚­ã‚¹ãƒˆæ•°ï¼‰
    - ã¾ãŸã¯å¤‰åŒ–ç‡ãƒ»SSIMã‚¹ã‚³ã‚¢é–¾å€¤åˆ¤å®š
  - ä¿¡é ¼åº¦è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ç¢ºèªï¼ˆCalculateDisappearanceConfidence()ï¼‰
- [ ] **AutoOverlayCleanupService**å‹•ä½œç¢ºèª
  - æ—¢å­˜å®Ÿè£…: `Application/Services/UI/AutoOverlayCleanupService.cs`
  - Circuit Breaker: ä¿¡é ¼åº¦é–¾å€¤ãƒã‚§ãƒƒã‚¯ï¼ˆMinConfidenceScoreï¼‰
  - ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒã‚§ãƒƒã‚¯
  - ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤å‰Šé™¤å®Ÿè¡Œï¼ˆClearOverlaysForRegionsAsync()ï¼‰
- [ ] **å‹•ä½œç¢ºèª**
  - æ–°ã—ã„ãƒ†ã‚­ã‚¹ãƒˆæ¤œçŸ¥ â†’ ç¿»è¨³å‡¦ç†å®Ÿè¡Œ âœ…ï¼ˆæ—¢å­˜å‹•ä½œï¼‰
  - ãƒ†ã‚­ã‚¹ãƒˆæ¶ˆå¤±æ¤œçŸ¥ â†’ TextDisappearanceEventç™ºè¡Œ â†’ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤å‰Šé™¤ ğŸ”§ï¼ˆè¦ä¿®æ­£ï¼‰
  - ç”»é¢å¤‰åŒ–ãªã— â†’ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ç¶­æŒ âœ…ï¼ˆæ—¢å­˜å‹•ä½œï¼‰

**æŠ€è¡“è©³ç´°ï¼ˆä¿®æ­£å‰å¾Œã®æ¯”è¼ƒï¼‰**:
```
ä¿®æ­£å‰ï¼ˆèª¤ã‚Šï¼‰:
if (previousImage != null && !changeResult.HasChanged)  // â† ãƒ†ã‚­ã‚¹ãƒˆæ¶ˆå¤±æ™‚ã«å¤‰åŒ–ãŒã‚ã‚‹ãŸã‚æ¡ä»¶ä¸ä¸€è‡´
â†’ TextDisappearanceEventç™ºè¡Œã•ã‚Œãš

ä¿®æ­£å¾Œï¼ˆæ­£ã—ã„ï¼‰:
if (previousImage != null && changeResult.HasChanged && IsTextDisappearance(changeResult))
â†’ ãƒ†ã‚­ã‚¹ãƒˆæ¶ˆå¤±æ™‚ã«æ­£ã—ãã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ

æœŸå¾…ãƒ•ãƒ­ãƒ¼:
1. ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£ â†’ ImageChangeDetectionå®Ÿè¡Œ
2. ãƒ†ã‚­ã‚¹ãƒˆæ¶ˆå¤±æ¤œçŸ¥ï¼ˆå¤‰åŒ–ã‚ã‚Š + OCRãƒ†ã‚­ã‚¹ãƒˆæ¸›å°‘ï¼‰ â†’ TextDisappearanceEventç™ºè¡Œ
3. AutoOverlayCleanupService â†’ ä¿¡é ¼åº¦ãƒã‚§ãƒƒã‚¯ â†’ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤å‰Šé™¤
4. æ–°ãƒ†ã‚­ã‚¹ãƒˆæ¤œçŸ¥æ™‚ â†’ ç¿»è¨³ â†’ æ–°ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤º
```

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `Infrastructure/Processing/Strategies/ImageChangeDetectionStageStrategy.cs:521-571`
- `Application/Services/UI/AutoOverlayCleanupService.cs:98-140`
- `Core/Events/TextDisappearanceEvent.cs`

#### 4.5 **ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤åº§æ¨™ã‚ºãƒ¬ä¿®æ­£** (0.5æ—¥) - âš ï¸ **UltraThinkæ¤œå‡ºè¡¨ç¤ºå•é¡Œ**
- [ ] **ãƒã‚°3**: 2å›ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤ºã«ã‚ˆã‚‹åº§æ¨™ã‚ºãƒ¬ä¿®æ­£
  - åŸå› : TimedAggregatoråˆ†å‰²å‡¦ç†ã«ã‚ˆã‚Šã€åŒã˜ãƒ†ã‚­ã‚¹ãƒˆã«å¯¾ã—ã¦2å›ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤º
  - æ ¹æœ¬ä¿®æ­£: Phase 3.4ï¼ˆTimedAggregatoræ”¹å–„ï¼‰ã§è§£æ¶ˆäºˆå®š
  - æš«å®šå¯¾ç­–: æ—¢å­˜ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã®åº§æ¨™ãƒã‚§ãƒƒã‚¯ã€é‡è¤‡è¡¨ç¤ºé˜²æ­¢
- [ ] InPlaceTranslationOverlayManageræ”¹å–„
  - æ—¢å­˜ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ä½ç½®ã®è¨˜éŒ²
  - è¿‘æ¥ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã®è‡ªå‹•èª¿æ•´ï¼ˆYåº§æ¨™ã‚ªãƒ•ã‚»ãƒƒãƒˆè¿½åŠ ï¼‰
- [ ] åº§æ¨™è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ç¢ºèª
  - ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒ³ãƒ‰ãƒ«ãƒ™ãƒ¼ã‚¹åº§æ¨™å¤‰æ›
  - ãƒãƒ«ãƒãƒ¢ãƒ‹ã‚¿ãƒ¼å¯¾å¿œç¢ºèª
- [ ] å‹•ä½œç¢ºèª
  - è¤‡æ•°ãƒãƒ£ãƒ³ã‚¯ç¿»è¨³æ™‚ã®åº§æ¨™æ­£ç¢ºæ€§
  - ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤é‡è¤‡ãªã—ç¢ºèª

---

### Phase 5: çµ±åˆãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼ (2-3æ—¥) - ğŸ”´ æœªç€æ‰‹

**ğŸ“‹ å‰ææ¡ä»¶ï¼ˆPhase 3å®Œäº†å¾Œã€Phase 0.3æˆæœç‰©æ´»ç”¨ï¼‰**:
- [ ] **å‚ç…§**: `package_analysis.md` - ONNX Runtime 1.17.1 â†’ 1.23.0æ›´æ–°æ¤œè¨ï¼ˆæ…é‡ã«æ¤œè¨¼ï¼‰

#### 5.1 æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ (1æ—¥)
- [ ] ã‚­ãƒ£ãƒ—ãƒãƒ£ â†’ OCR â†’ ç¿»è¨³ â†’ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤º
- [ ] ã‚­ãƒ£ãƒ³ã‚»ãƒ«å‹•ä½œç¢ºèª
- [ ] ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‹•ä½œç¢ºèª
- [ ] WIDTH_FIXå‹•ä½œç¢ºèª
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç¢ºèª

#### 5.2 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ (1æ—¥)
- [ ] gRPC vs stdin/stdoutæ¯”è¼ƒæ¸¬å®š
- [ ] ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ç¢ºèª
- [ ] CPUä½¿ç”¨ç‡æ¸¬å®š
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ æ¸¬å®š
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ

#### 5.3 å›å¸°ãƒ†ã‚¹ãƒˆ (1æ—¥)
- [ ] **å‚ç…§**: `dependency_graph.md` - ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¾å­˜é–¢ä¿‚ã€ãƒ†ã‚¹ãƒˆæˆ¦ç•¥æœ€é©åŒ–
- [ ] æ—¢å­˜1,300+ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œ
- [ ] æ–°è¦ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 
- [ ] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š
- [ ] å…¨ãƒ†ã‚¹ãƒˆæˆåŠŸç¢ºèª

---

### Phase 6: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™ãƒ»å®Œäº† (1æ—¥) - ğŸ”´ æœªç€æ‰‹

#### 6.1 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
- [ ] **å‚ç…§**: `dependency_graph.md` - æœ€æ–°ã®5å±¤æ§‹é€ å›³ã‚’README.mdã«åæ˜ 
- [ ] CLAUDE.mdæ›´æ–°ï¼ˆgRPCç§»è¡Œåæ˜ ï¼‰
- [ ] CLAUDE.local.mdæ›´æ–°ï¼ˆPhase 12.2å•é¡Œè§£æ±ºè¨˜éŒ²ï¼‰
- [ ] README.mdæ›´æ–°
  - [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ã®æœ€æ–°åŒ–
  - [ ] gRPCã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³è¿½åŠ ï¼ˆ`dependency_graph.md`ã®Mermaidå›³ã‚’æ´»ç”¨ï¼‰
  - [ ] ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †æ›´æ–°ï¼ˆgRPCã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼‰
  - [ ] ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¿½åŠ 
- [ ] ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ä½œæˆï¼ˆMermaidï¼‰
- [ ] APIä»•æ§˜æ›¸ä½œæˆï¼ˆgRPCï¼‰

#### 6.2 æœ€çµ‚ç¢ºèª
- [ ] å…¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´åˆæ€§ç¢ºèª
- [ ] ã‚³ãƒ¼ãƒ‰å‰Šæ¸›é‡æœ€çµ‚æ¸¬å®š
- [ ] æŠ€è¡“çš„è² å‚µè§£æ¶ˆç¢ºèª
- [ ] ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Œäº†å®£è¨€

---

## ğŸ”¥ Geminiãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœ

**ãƒ¬ãƒ“ãƒ¥ãƒ¼æ—¥**: 2025-10-03
**ç·åˆè©•ä¾¡**: ğŸš¨ ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãªãƒªã‚¹ã‚¯ã¯é™å®šçš„ã ãŒã€é‡å¤§ãªè¦‹è½ã¨ã—ã‚ã‚Š

### âœ… é«˜è©•ä¾¡ãƒã‚¤ãƒ³ãƒˆ
1. **Phase 0ï¼ˆé™çš„è§£æï¼‰ã‹ã‚‰ç€æ‰‹ã™ã‚‹å„ªå…ˆé †ä½ä»˜ã‘** - ãƒªã‚¹ã‚¯ç®¡ç†ã¨ã—ã¦ç†æƒ³çš„
2. **gRPCç§»è¡Œåˆ¤æ–­** - æ¥­ç•Œæ¨™æº–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã€Œæœ€å¾Œã®é€šä¿¡å±¤å¤‰æ›´ã€ã«ã™ã‚‹æ–¹é‡ã¯å®Œå…¨ã«æ­£ã—ã„
3. **5ã¤ã®ãƒ•ã‚§ãƒ¼ã‚ºæ§‹æˆ** - æ®µéšçš„ãƒªã‚¹ã‚¯ç®¡ç†ãŒåŠ¹æœçš„
4. **å·¥æ•°è¦‹ç©ã‚‚ã‚Šï¼ˆ20-28æ—¥ï¼‰** - ç¾å®Ÿçš„ãªç¯„å›²

### ğŸš¨ ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãªãƒªã‚¹ã‚¯: BaketaCaptureNativeé€£æºã®è¦‹è½ã¨ã—

**GeminiæŒ‡æ‘˜**:
> ğŸš¨ **æœ€é‡è¦ãƒªã‚¹ã‚¯: `BaketaCaptureNative` (C++/WinRT) ã¨ã®é€£æº**
> - **ç¾çŠ¶**: ã“ã®ãƒã‚¤ãƒ†ã‚£ãƒ–DLLã¯ã€Windows Graphics Capture APIã‚’åˆ©ç”¨ã—ã€ã‚­ãƒ£ãƒ—ãƒãƒ£æ©Ÿèƒ½ã®å¿ƒè‡“éƒ¨ã§ã™ã€‚
> - **å•é¡Œ**: gRPCã¸ã®ç§»è¡Œå¾Œã€ã“ã®ãƒã‚¤ãƒ†ã‚£ãƒ–DLLã¨C#ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ¬ä½“ãŒã©ã®ã‚ˆã†ã«é€šä¿¡ã™ã‚‹ã®ã‹ãŒå…¨ãè€ƒæ…®ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚Pythonã‚µãƒ¼ãƒãƒ¼ã¨ã®é€šä¿¡ã¯gRPCã«ç½®ãæ›ã‚ã‚Šã¾ã™ãŒã€ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ—ãƒ­ã‚»ã‚¹ã¨ã®é€£æºã¯ã©ã†ãªã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ
> - **æ½œåœ¨çš„ãªå½±éŸ¿**: ã‚‚ã—ãƒã‚¤ãƒ†ã‚£ãƒ–DLLã¨ã®é€šä¿¡ã«ã‚‚å•é¡ŒãŒã‚ã‚Œã°ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ ¹å¹¹æ©Ÿèƒ½ãŒå‹•ä½œã—ãªããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

**å¯¾å¿œæ–¹é‡**:
- Phase 0.2ã®èª¿æŸ»å¯¾è±¡ã«ã€ŒBaketaCaptureNative.dllé€£æºã®è©³ç´°ç¢ºèªã€ã‚’è¿½åŠ 
- ãƒã‚¤ãƒ†ã‚£ãƒ–DLLã¨ã®é€šä¿¡ã¯**P/InvokeçµŒç”±**ã§ã‚ã‚Šã€gRPCç§»è¡Œã®å½±éŸ¿ã‚’å—ã‘ãªã„
- ã—ã‹ã—ã€SafeImageAdapterçµ±åˆå•é¡Œï¼ˆObjectDisposedExceptionï¼‰ãŒæ®‹å­˜ã—ã¦ãŠã‚Šã€ã“ã‚Œã‚’å„ªå…ˆè§£æ±ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹

---

## ğŸš¨ ç¾çŠ¶ã®å•é¡Œç‚¹

### 1. æŠ€è¡“çš„è² å‚µã®è“„ç©

çŸ­æœŸé–“ã§ã®æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯å¤‰æ›´ã«ã‚ˆã‚Šã€å¯¾ç—‡ç™‚æ³•çš„ãªä¿®æ­£ãŒç©ã¿é‡ãªã£ã¦ã„ã‚‹ã€‚

| æ™‚æœŸ | å¤‰æ›´å†…å®¹ | çµæœ | æ®‹å­˜ã™ã‚‹å•é¡Œ |
|------|---------|------|------------|
| Phase 12.5 | TCP â†’ stdin/stdout | SocketExceptionè§£æ¶ˆ | ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆåˆ¶å¾¡å›°é›£ï¼ˆ30ç§’å•é¡Œï¼‰ |
| Phase 12.2.1 | Task.Delayã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆä¿®æ­£ | 10ç§’ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå®Ÿè£… | ä¸Šä½å±¤CancellationTokenã¨å¹²æ¸‰ |
| Phase 12.2 | ãƒãƒƒãƒç¿»è¨³å•é¡Œ | å€‹åˆ¥å‡¦ç†ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ | å¿œç­”ãŒæ¥ãªã„åŸå› ä¸æ˜ |
| Phase 3.2 | SafeImageAdapterçµ±åˆ | ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ– | InvalidCastException |
| Phase 3.1 | WindowsImageFactoryä¿®æ­£ | çµ±åˆä¸å®Œå…¨ | ObjectDisposedExceptionç¶™ç¶š |

**å…±é€šãƒ‘ã‚¿ãƒ¼ãƒ³**: å•é¡Œç™ºç”Ÿ â†’ å±€æ‰€çš„ä¿®æ­£ â†’ æ–°ãŸãªå•é¡Œç™ºç”Ÿ â†’ ã•ã‚‰ã«å±€æ‰€çš„ä¿®æ­£ â†’ ...

### 2. OptimizedPythonTranslationEngine.cs (1,500è¡Œ)

**è²¬ä»»éå¤š**:
- TCPæ¥ç¶šç®¡ç†ï¼ˆå»ƒæ­¢æ¸ˆã¿ï¼‰
- stdin/stdouté€šä¿¡ï¼ˆç¾åœ¨ï¼‰
- JSON serialization/deserialization
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/å¿œç­”ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆOperationIdæ‰‹å‹•ç®¡ç†ï¼‰
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆåˆ¶å¾¡ï¼ˆ10ç§’ vs 30ç§’å•é¡Œï¼‰
- ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼
- ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ï¼ˆHybridResourceManagerï¼‰
- ãƒãƒƒãƒå‡¦ç†
- å€‹åˆ¥å‡¦ç†ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

**å•é¡Œ**: é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒå¤‰ã‚ã‚‹ãŸã³ã«ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã‚’æ›¸ãæ›ãˆã€‚ãƒ†ã‚¹ãƒˆå›°é›£ã€‚

### 3. InPlaceTranslationOverlayManager.cs (1,067è¡Œ)

**è²¬ä»»éå¤š**:
- ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
- ä½ç½®èª¿æ•´
- è¡çªå›é¿
- ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
- é‡è¤‡é˜²æ­¢
- WIDTH_FIXå®Ÿè£…ï¼ˆå®Ÿè¡Œãƒ•ãƒ­ãƒ¼ä¸æ˜ï¼‰

**å•é¡Œ**: UIå•é¡Œï¼ˆWIDTH_FIXï¼‰ã‚’ä¿®æ­£ã—ã‚ˆã†ã¨ã—ã¦ã‚‚ã€å®Ÿè¡Œãƒ•ãƒ­ãƒ¼ãŒè¿½ãˆãªã„ã€‚METHOD_ENTRYãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œãªã„è¬ã®å‹•ä½œã€‚

### 4. é€šä¿¡ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æŠ½è±¡åŒ–æ¬ å¦‚

**ç¾çŠ¶**:
```
TranslationService â†’ OptimizedPythonTranslationEngine â†’ stdin/stdoutç›´æ¥æ“ä½œ
```

**å•é¡Œ**:
- é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«å¤‰æ›´æ™‚ã®å½±éŸ¿ç¯„å›²ãŒåºƒã™ãã‚‹
- å˜ä½“ãƒ†ã‚¹ãƒˆå›°é›£ï¼ˆPythonã‚µãƒ¼ãƒãƒ¼èµ·å‹•å¿…é ˆï¼‰
- gRPCç§»è¡Œæ™‚ã«å¤§è¦æ¨¡æ›¸ãæ›ãˆãŒå¿…è¦

### 5. é™çš„è§£ææœªå®Ÿæ–½

**æ¨å®šã•ã‚Œã‚‹å•é¡Œ**:
- ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰ï¼ˆPhase 16é–¢é€£ã€æ—§TCPå®Ÿè£…ãªã©ï¼‰
- æœªä½¿ç”¨NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- å¾ªç’°ä¾å­˜
- è¤‡é›‘åº¦ã®é«˜ã„ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆCyclomatic Complexity > 15ï¼‰
- é‡è¤‡ã‚³ãƒ¼ãƒ‰

### 6. stdin/stdoutã®é™ç•Œ

**grpc.mdæŒ‡æ‘˜ã¨ã®ä¸€è‡´**:
- âœ… ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åŒºåˆ‡ã‚Šæ‰‹å‹•ç®¡ç†å¿…é ˆ
- âœ… ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/å¿œç­”å¯¾å¿œä»˜ã‘æ‰‹å‹•ç®¡ç†ï¼ˆTaskCompletionSourceè¤‡é›‘åŒ–ï¼‰
- âœ… ã‚­ãƒ£ãƒ³ã‚»ãƒ«å‡¦ç†è‡ªå‰å®Ÿè£…ï¼ˆCancellationTokenãŒåŠ¹ã‹ãªã„ï¼‰
- âœ… CPU/GCè² è·ï¼ˆJSON serialization/deserializationï¼‰
- âœ… è¤‡é›‘åŒ–ã§ã‚¹ãƒ‘ã‚²ãƒƒãƒ†ã‚£åŒ–ï¼ˆ1,500è¡Œãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

**å®Ÿéš›ã®å•é¡Œ**:
```csharp
// ç¾åœ¨: 200è¡Œä»¥ä¸Šã®è¤‡é›‘ãªåˆ¶å¾¡
var readTask = connection.Reader.ReadLineAsync(cancellationToken).AsTask();
var timeoutTask = Task.Delay(TimeSpan.FromSeconds(10));
var completedTask = await Task.WhenAny(readTask, timeoutTask);
if (completedTask == timeoutTask) {
    connection.TcpClient?.Close(); // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‡¦ç†
    throw new TimeoutException(...);
}
// + OperationIdç®¡ç†
// + TaskCompletionSourceç®¡ç†
// + JSON parse/serialize
```

---

## ğŸ¯ è§£æ±ºã—ãŸã„ã“ã¨

### 1. æŠ€è¡“çš„è² å‚µã®å®Œå…¨æ¸…ç®—

- **ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤**: Phase 16é–¢é€£ã€æ—§TCPå®Ÿè£…ã€æœªä½¿ç”¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç­‰
- **ã‚³ãƒ¼ãƒ‰å‰Šæ¸›**: æ¨å®š2,000-3,000è¡Œå‰Šé™¤
- **è¤‡é›‘åº¦å‰Šæ¸›**: 500è¡Œä»¥ä¸Šã®ã‚¯ãƒ©ã‚¹ã‚’200-300è¡Œã«åˆ†å‰²

### 2. é€šä¿¡å±¤ã®æŠ½è±¡åŒ–ã¨å®‰å®šåŒ–

- **gRPCç§»è¡Œ**: æ¥­ç•Œæ¨™æº–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã€Œæœ€å¾Œã®é€šä¿¡å±¤å¤‰æ›´ã€ã«ã™ã‚‹
- **æŠ½è±¡åŒ–**: ITranslationClientã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å°å…¥ã§ãƒ—ãƒ­ãƒˆã‚³ãƒ«éä¾å­˜
- **ç°¡ç´ åŒ–**: 1,500è¡Œ â†’ 100è¡Œç¨‹åº¦ã®ã‚·ãƒ³ãƒ—ãƒ«ãªé€šä¿¡å±¤

### 3. UIå±¤ã®è²¬ä»»åˆ†é›¢

- **ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³å°å…¥**: ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ç”Ÿæˆã¨è¨­å®šã‚’åˆ†é›¢
- **WIDTH_FIXå•é¡Œè§£æ±º**: ç¢ºå®Ÿã«TextBlock.MaxWidthã‚’è¨­å®šã™ã‚‹è¨­è¨ˆ
- **å®Ÿè¡Œãƒ•ãƒ­ãƒ¼å¯è¦–åŒ–**: ãªãœMETHOD_ENTRYãƒ­ã‚°ãŒå‡ºãªã„ã‹è§£æ˜ãƒ»ä¿®æ­£

### 4. ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ã®å‘ä¸Š

- **Mockå¯èƒ½ãªè¨­è¨ˆ**: ITranslationClientã§MockClientä½¿ç”¨å¯èƒ½
- **å˜ä½“ãƒ†ã‚¹ãƒˆè¿½åŠ **: é€šä¿¡å±¤ã€UIå±¤ã®å˜ä½“ãƒ†ã‚¹ãƒˆ
- **çµ±åˆãƒ†ã‚¹ãƒˆæ•´å‚™**: gRPC vs stdin/stdoutæ¯”è¼ƒãƒ†ã‚¹ãƒˆ

### 5. ä¿å®ˆæ€§ã®å‘ä¸Š

- **Clean Architectureæº–æ‹ **: å„å±¤ã®è²¬ä»»æ˜ç¢ºåŒ–
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™**: å…¨ä½“ãƒ•ãƒ­ãƒ¼å›³ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³
- **æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯å›ºå®š**: gRPCã§é€šä¿¡å±¤ã‚’å®‰å®šåŒ–

---

## ğŸ“‹ å®Ÿæ–½å†…å®¹

### Phase 0: ç¾çŠ¶åˆ†æãƒ»èª¿æŸ» (3-4æ—¥)

#### 0.1 é™çš„è§£æå®Ÿæ–½ (1æ—¥)

**ä½¿ç”¨ãƒ„ãƒ¼ãƒ«**:
- Roslyn Analyzerï¼ˆC#ï¼‰
- Visual Studio Code Metrics
- ReSharperï¼ˆåˆ©ç”¨å¯èƒ½ãªã‚‰ï¼‰

**å®Ÿæ–½é …ç›®**:
- ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰æ¤œå‡º
  - ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ¡ã‚½ãƒƒãƒ‰
  - ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‚¯ãƒ©ã‚¹
  - ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
  - æœªå‚ç…§ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- å¾ªç’°ä¾å­˜æ¤œå‡º
  - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–“å¾ªç’°ä¾å­˜
  - ã‚¯ãƒ©ã‚¹é–“å¾ªç’°ä¾å­˜
- è¤‡é›‘åº¦æ¸¬å®š
  - Cyclomatic Complexity > 15 ã®ãƒ¡ã‚½ãƒƒãƒ‰ç‰¹å®š
  - è¡Œæ•° > 500 ã®ã‚¯ãƒ©ã‚¹ç‰¹å®š
- é‡è¤‡ã‚³ãƒ¼ãƒ‰æ¤œå‡º
  - ã‚³ãƒ”ãƒšã‚³ãƒ¼ãƒ‰
  - é¡ä¼¼ãƒ­ã‚¸ãƒƒã‚¯

**æˆæœç‰©**:
- `analysis_report.md` - é™çš„è§£æãƒ¬ãƒãƒ¼ãƒˆ
- `deadcode_list.md` - å‰Šé™¤å¯¾è±¡ã‚³ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆ
- `refactoring_targets.md` - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å„ªå…ˆåº¦ãƒªã‚¹ãƒˆ

#### 0.2 å…¨ä½“ãƒ•ãƒ­ãƒ¼èª¿æŸ» (1-2æ—¥)

**èª¿æŸ»å¯¾è±¡**:

**â‘  ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ•ãƒ­ãƒ¼**
```
ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œï¼ˆStartãƒœã‚¿ãƒ³ï¼‰
  â†“
StartCaptureCommand (MainWindowViewModel)
  â†“
ICaptureService.StartCaptureAsync()
  â†“
Windows Graphics Capture API (BaketaCaptureNative.dll) â† P/InvokeçµŒç”±
  â†“
CaptureCompletedEventç™ºè¡Œ
```

**èª¿æŸ»ãƒã‚¤ãƒ³ãƒˆ**:
- ICaptureServiceã®å®Ÿè£…ã‚¯ãƒ©ã‚¹ç‰¹å®š
- SafeImageAdapterçµ±åˆçŠ¶æ³ç¢ºèª
- ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‚­ãƒ£ãƒ—ãƒãƒ£æ–¹å¼ã®ç‰¹å®šï¼ˆPrintWindow fallbackç­‰ï¼‰
- **ğŸš¨ [GEMINI_CRITICAL] BaketaCaptureNative.dllé€£æºã®è©³ç´°ç¢ºèª**:
  - P/Invokeå®£è¨€ï¼ˆNativeWindowsCapture.csï¼‰ã®æ­£ç¢ºæ€§
  - ãƒ¡ãƒ¢ãƒªç®¡ç†ï¼ˆSafeHandleä½¿ç”¨çŠ¶æ³ï¼‰
  - ObjectDisposedExceptionæ ¹æœ¬åŸå› ã®ç‰¹å®š
  - SafeImageAdapterçµ±åˆå•é¡Œã®è§£æ±ºæ–¹é‡ç­–å®š

**â‘¡ OCRãƒ•ãƒ­ãƒ¼**
```
CaptureCompletedEvent
  â†“
OcrRequestHandler
  â†“
SmartProcessingPipelineService
  â†“
PaddleOcrEngine
  â†“
TimedChunkAggregator
  â†“
AggregatedChunksReadyEventç™ºè¡Œ
```

**èª¿æŸ»ãƒã‚¤ãƒ³ãƒˆ**:
- ProximityGroupingå®Ÿè£…ç¢ºèª
- æ®µéšçš„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ çµ±åˆçŠ¶æ³
- ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç‰¹å®š

**â‘¢ ç¿»è¨³ãƒ•ãƒ­ãƒ¼**
```
AggregatedChunksReadyEvent
  â†“
AggregatedChunksReadyEventHandler
  â†“
StreamingTranslationService / DefaultTranslationService
  â†“
OptimizedPythonTranslationEngine (stdin/stdout)
  â†“
Python NLLB-200ã‚µãƒ¼ãƒãƒ¼
```

**èª¿æŸ»ãƒã‚¤ãƒ³ãƒˆ**:
- StreamingTranslationServiceã®å®Ÿè£…çŠ¶æ³
- DefaultTranslationServiceã¨ã®é–¢ä¿‚
- ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„TranslationEngineç‰¹å®šï¼ˆMockEngineç­‰ï¼‰

**â‘£ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤ºãƒ•ãƒ­ãƒ¼**
```
TranslationWithBoundsCompletedEvent
  â†“
AggregatedChunksReadyEventHandler.DisplayTranslationOverlayAsync()
  â†“
IInPlaceTranslationOverlayManager.ShowInPlaceOverlayAsync()
  â†“
CreateAndShowNewInPlaceOverlayAsync()
  â†“
InPlaceTranslationOverlayWindow.ShowInPlaceOverlayAsync()
  â†“
WIDTH_FIXå®Ÿè£…ï¼ˆã®ã¯ãšï¼‰
```

**èª¿æŸ»ãƒã‚¤ãƒ³ãƒˆ**:
- **ãªãœMETHOD_ENTRYãƒ­ã‚°ãŒå‡ºãªã„ã‹ç‰¹å®š** â† é‡è¦
- AvaloniaOverlayRendererã®ä½¿ç”¨çŠ¶æ³ç¢ºèª
- Phase16UIOverlayModuleã®å®Œå…¨å‰Šé™¤ç¢ºèª

**â‘¤ ç¶™ç¶šç›£è¦–ãƒ•ãƒ­ãƒ¼**
```
StartCaptureCommand
  â†“
Timer or Task-based polling
  â†“
å®šæœŸçš„ã«ã‚­ãƒ£ãƒ—ãƒãƒ£å®Ÿè¡Œ
  â†“
ç”»åƒå¤‰åŒ–æ¤œçŸ¥
  â†“
å¤‰åŒ–ãŒã‚ã‚Œã°OCRå®Ÿè¡Œ
```

**èª¿æŸ»ãƒã‚¤ãƒ³ãƒˆ**:
- ç”»åƒå¤‰åŒ–æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…çŠ¶æ³ï¼ˆP0ã‚¿ã‚¹ã‚¯ï¼‰
- ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”ã®æœ€é©å€¤
- ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ç¢ºèª

**æˆæœç‰©**:
- `flow_analysis.md` - å…¨ä½“ãƒ•ãƒ­ãƒ¼å›³ï¼ˆMermaidå½¢å¼ï¼‰
- `architecture_issues.md` - ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å•é¡Œãƒªã‚¹ãƒˆ
- `unused_components.md` - æœªä½¿ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒªã‚¹ãƒˆ

#### 0.3 ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ”ãƒ³ã‚° (1æ—¥)

**å®Ÿæ–½å†…å®¹**:
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–“ä¾å­˜é–¢ä¿‚å¯è¦–åŒ–
dotnet list package --include-transitive > dependencies.txt

# NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ•´ç†
# ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç‰¹å®š
```

**èª¿æŸ»ãƒã‚¤ãƒ³ãƒˆ**:
- æœªä½¿ç”¨NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸æ•´åˆ
- å¾ªç’°å‚ç…§

**æˆæœç‰©**:
- `dependency_graph.png` - ä¾å­˜é–¢ä¿‚å›³
- `unused_packages.md` - å‰Šé™¤å¯èƒ½ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒªã‚¹ãƒˆ

---

### Phase 1: ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤ (2-3æ—¥)

#### 1.1 Phase 16é–¢é€£ã‚³ãƒ¼ãƒ‰å®Œå…¨å‰Šé™¤ (0.5æ—¥)

**å‰Šé™¤å¯¾è±¡**:
- `Baketa.UI/DI/Modules/Phase16UIOverlayModule.cs` ï¼ˆç¢ºèªæ¸ˆã¿ç„¡åŠ¹åŒ–ï¼‰
- `Baketa.UI/Services/Overlay/AvaloniaOverlayRenderer.cs` ï¼ˆä½¿ç”¨çŠ¶æ³ç¢ºèªå¾Œï¼‰
- é–¢é€£ã™ã‚‹Phase 16ã‚¤ãƒ™ãƒ³ãƒˆãƒ»ãƒãƒ³ãƒ‰ãƒ©ãƒ¼

**ç¢ºèªäº‹é …**:
- AvaloniaOverlayRendererãŒæœ¬å½“ã«ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‹
- å‰Šé™¤å¾Œã®ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆæˆåŠŸç¢ºèª

#### 1.2 æœªä½¿ç”¨TranslationEngineå‰Šé™¤ (0.5æ—¥)

**å‰Šé™¤å€™è£œ**:
- MockTranslationEngineï¼ˆãƒ†ã‚¹ãƒˆç”¨ä»¥å¤–ã§ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„å ´åˆï¼‰
- æ—§TCPé€šä¿¡ã‚³ãƒ¼ãƒ‰ï¼ˆå®Œå…¨å‰Šé™¤ç¢ºèªï¼‰
- ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰

#### 1.3 æœªä½¿ç”¨ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ»OCRã‚³ãƒ¼ãƒ‰å‰Šé™¤ (0.5æ—¥)

**å‰Šé™¤å€™è£œ**:
- PrintWindow fallbackï¼ˆä½¿ç”¨ã•ã‚Œã¦ã„ãªã„å ´åˆï¼‰
- æ—§Phaseå®Ÿè£…ï¼ˆPhase 3.1é–¢é€£ã®ä¸­é€”åŠç«¯ãªã‚³ãƒ¼ãƒ‰ï¼‰
- ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ç”»åƒãƒ•ã‚£ãƒ«ã‚¿ãƒ¼

#### 1.4 æœªä½¿ç”¨NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å‰Šé™¤ (0.5æ—¥)

**å‰Šé™¤å€™è£œ**:
- æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

**æœŸå¾…åŠ¹æœ**:
- ã‚³ãƒ¼ãƒ‰å‰Šæ¸›é‡: **2,000-3,000è¡Œ**
- ãƒ“ãƒ«ãƒ‰æ™‚é–“çŸ­ç¸®
- ãƒ‡ãƒãƒƒã‚°å®¹æ˜“æ€§å‘ä¸Š

---

### Phase 2: gRPCåŸºç›¤æ§‹ç¯‰ (5-7æ—¥)

#### 2.1 Protoãƒ•ã‚¡ã‚¤ãƒ«è¨­è¨ˆ (1æ—¥)

**translation.proto**:
```protobuf
syntax = "proto3";

package baketa.translation;

service TranslationService {
  rpc Translate (TranslateRequest) returns (TranslateResponse);
  rpc TranslateBatch (stream BatchTranslateRequest) returns (stream BatchTranslateResponse);
  rpc CancelTranslation (CancelRequest) returns (CancelResponse);
  rpc HealthCheck (HealthCheckRequest) returns (HealthCheckResponse);
}

message TranslateRequest {
  string text = 1;
  string source_lang = 2;
  string target_lang = 3;
  string operation_id = 4;
}

message TranslateResponse {
  string translated_text = 1;
  string operation_id = 2;
  bool is_success = 3;
  string error_message = 4;
  int64 processing_time_ms = 5;
}

message BatchTranslateRequest {
  repeated string texts = 1;
  string source_lang = 2;
  string target_lang = 3;
  string batch_id = 4;
}

message BatchTranslateResponse {
  repeated string translated_texts = 1;
  string batch_id = 2;
  bool is_success = 3;
}

message CancelRequest {
  string operation_id = 1;
}

message CancelResponse {
  bool is_cancelled = 1;
}

message HealthCheckRequest {}

message HealthCheckResponse {
  bool is_healthy = 1;
  string version = 2;
}
```

#### 2.2 Python gRPCã‚µãƒ¼ãƒãƒ¼å®Ÿè£… (2-3æ—¥)

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ**:
```
python/
â”œâ”€â”€ grpc_server/
â”‚   â”œâ”€â”€ translation_server.py  # gRPCã‚µãƒ¼ãƒãƒ¼æœ¬ä½“
â”‚   â”œâ”€â”€ nllb_translator.py     # NLLB-200ãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â”œâ”€â”€ gemini_translator.py   # Gemini APIãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ protos/
â”‚   â””â”€â”€ translation.proto
â”œâ”€â”€ requirements.txt
â””â”€â”€ start_server.py
```

**ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«**: translation_server.py
```python
import grpc
from concurrent import futures
import translation_pb2
import translation_pb2_grpc
from nllb_translator import NLLBTranslator

class TranslationServicer(translation_pb2_grpc.TranslationServiceServicer):
    def __init__(self):
        self.translator = NLLBTranslator()

    def Translate(self, request, context):
        try:
            result = self.translator.translate(
                request.text,
                request.source_lang,
                request.target_lang
            )
            return translation_pb2.TranslateResponse(
                translated_text=result,
                operation_id=request.operation_id,
                is_success=True
            )
        except Exception as e:
            return translation_pb2.TranslateResponse(
                operation_id=request.operation_id,
                is_success=False,
                error_message=str(e)
            )

    def TranslateBatch(self, request_iterator, context):
        for request in request_iterator:
            yield self._translate_single(request)

    def HealthCheck(self, request, context):
        return translation_pb2.HealthCheckResponse(
            is_healthy=True,
            version="1.0.0"
        )

def serve():
    server = grpc.server(futures.ThreadPoolExecutor(max_workers=4))
    translation_pb2_grpc.add_TranslationServiceServicer_to_server(
        TranslationServicer(), server
    )
    server.add_insecure_port('[::]:50051')
    server.start()
    print("gRPC server started on port 50051")
    server.wait_for_termination()
```

#### 2.3 C# gRPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£… (2-3æ—¥)

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ**:
```
Baketa.Infrastructure/Translation/
â”œâ”€â”€ Clients/
â”‚   â”œâ”€â”€ ITranslationClient.cs          # æŠ½è±¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ GrpcTranslationClient.cs       # gRPCå®Ÿè£…
â”‚   â””â”€â”€ StdinStdoutTranslationClient.cs # æ—¢å­˜ï¼ˆç§»è¡ŒæœŸé–“ä¸­ã®ã¿ï¼‰
â”œâ”€â”€ Protos/
â”‚   â””â”€â”€ translation.proto
â””â”€â”€ Factories/
    â””â”€â”€ TranslationClientFactory.cs
```

**ITranslationClient.cs**:
```csharp
namespace Baketa.Infrastructure.Translation.Clients;

public interface ITranslationClient : IDisposable
{
    Task<TranslationResult> TranslateAsync(
        string text,
        string sourceLang,
        string targetLang,
        CancellationToken cancellationToken = default);

    Task<IEnumerable<TranslationResult>> TranslateBatchAsync(
        IEnumerable<string> texts,
        string sourceLang,
        string targetLang,
        CancellationToken cancellationToken = default);

    Task<bool> CancelTranslationAsync(string operationId);

    Task<bool> IsHealthyAsync();
}

public record TranslationResult(
    string TranslatedText,
    string OperationId,
    bool IsSuccess,
    string? ErrorMessage = null,
    long ProcessingTimeMs = 0);
```

**GrpcTranslationClient.cs**:
```csharp
using Grpc.Net.Client;
using Grpc.Core;

namespace Baketa.Infrastructure.Translation.Clients;

public class GrpcTranslationClient : ITranslationClient
{
    private readonly GrpcChannel _channel;
    private readonly TranslationService.TranslationServiceClient _client;

    public GrpcTranslationClient(string serverAddress = "http://localhost:50051")
    {
        _channel = GrpcChannel.ForAddress(serverAddress);
        _client = new TranslationService.TranslationServiceClient(_channel);
    }

    public async Task<TranslationResult> TranslateAsync(
        string text,
        string sourceLang,
        string targetLang,
        CancellationToken cancellationToken = default)
    {
        try
        {
            var request = new TranslateRequest
            {
                Text = text,
                SourceLang = sourceLang,
                TargetLang = targetLang,
                OperationId = Guid.NewGuid().ToString()
            };

            var response = await _client.TranslateAsync(
                request,
                deadline: DateTime.UtcNow.AddSeconds(10),
                cancellationToken: cancellationToken
            );

            return new TranslationResult(
                response.TranslatedText,
                response.OperationId,
                response.IsSuccess,
                response.ErrorMessage,
                response.ProcessingTimeMs
            );
        }
        catch (RpcException ex) when (ex.StatusCode == StatusCode.DeadlineExceeded)
        {
            return new TranslationResult(
                string.Empty,
                string.Empty,
                false,
                "Translation timeout"
            );
        }
    }

    public async Task<bool> IsHealthyAsync()
    {
        try
        {
            var response = await _client.HealthCheckAsync(
                new HealthCheckRequest(),
                deadline: DateTime.UtcNow.AddSeconds(2)
            );
            return response.IsHealthy;
        }
        catch
        {
            return false;
        }
    }

    public void Dispose()
    {
        _channel.Dispose();
    }
}
```

**æœŸå¾…åŠ¹æœ**:
- stdin/stdoutã¨ä¸¦è¡Œç¨¼åƒå¯èƒ½ãªgRPCãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- OptimizedPythonTranslationEngineã‚’å®Œå…¨å‰Šé™¤å¯èƒ½ãªæº–å‚™å®Œäº†

---

### Phase 3: é€šä¿¡å±¤æŠ½è±¡åŒ–ãƒ»ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— (3-4æ—¥)

#### 3.1 OptimizedPythonTranslationEngineå‰Šé™¤ (1æ—¥)

**ç½®ãæ›ãˆæ‰‹é †**:
```csharp
// Before
services.AddSingleton<ITranslationEngine, OptimizedPythonTranslationEngine>();

// After
services.AddSingleton<ITranslationClient, GrpcTranslationClient>();
services.AddSingleton<ITranslationEngine, GrpcTranslationEngineAdapter>();
```

**GrpcTranslationEngineAdapter.cs** (è»½é‡ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼):
```csharp
public class GrpcTranslationEngineAdapter : ITranslationEngine
{
    private readonly ITranslationClient _client;

    public GrpcTranslationEngineAdapter(ITranslationClient client)
    {
        _client = client;
    }

    public async Task<string> TranslateAsync(string text, CancellationToken ct)
    {
        var result = await _client.TranslateAsync(text, "ja", "en", ct);
        return result.IsSuccess ? result.TranslatedText : string.Empty;
    }
}
```

**å‰Šé™¤å¯¾è±¡**:
- `OptimizedPythonTranslationEngine.cs` (1,500è¡Œ)
- `StdinStdoutTranslationClient.cs`
- TCPé–¢é€£ã®å…¨ã‚³ãƒ¼ãƒ‰
- OperationIdæ‰‹å‹•ç®¡ç†ã‚³ãƒ¼ãƒ‰
- TaskCompletionSourceè¤‡é›‘ãªåˆ¶å¾¡

**æœŸå¾…åŠ¹æœ**:
- ã‚³ãƒ¼ãƒ‰å‰Šæ¸›: **1,500-2,000è¡Œ**
- ã‚·ãƒ³ãƒ—ãƒ«ãªé€šä¿¡å±¤ï¼ˆ100è¡Œç¨‹åº¦ï¼‰

#### 3.2 TranslationServiceéšå±¤æ•´ç† (1æ—¥)

**ç¾çŠ¶**:
- DefaultTranslationService
- StreamingTranslationService

**å®Ÿæ–½å†…å®¹**:
- ä¸¡è€…ã®è²¬ä»»ã‚’æ˜ç¢ºåŒ–
- é‡è¤‡ã‚³ãƒ¼ãƒ‰å‰Šé™¤
- çµ±åˆå¯èƒ½ã‹æ¤œè¨

#### 3.3 stdin/stdoutå®Œå…¨å‰Šé™¤ (1æ—¥)

**å‰Šé™¤å¯¾è±¡**:
- `StdinStdoutTranslationClient.cs`
- Python stdin/stdoutã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ¼ãƒ‰
- é–¢é€£è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
- ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰

---

### Phase 4: UIå±¤ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° (5-7æ—¥)

#### 4.1 InPlaceTranslationOverlayManageråˆ†å‰² (3-4æ—¥)

**ç¾çŠ¶**: 1,067è¡Œã®å˜ä¸€ã‚¯ãƒ©ã‚¹

**åˆ†å‰²å¾Œã®è¨­è¨ˆ**:

**â‘  IInPlaceOverlayFactory** (æ–°è¦ä½œæˆ)
```csharp
public interface IInPlaceOverlayFactory
{
    InPlaceTranslationOverlayWindow CreateOverlay(TextChunk textChunk);
    void ConfigureOverlay(InPlaceTranslationOverlayWindow overlay, TextChunk textChunk);
}

public class InPlaceOverlayFactory : IInPlaceOverlayFactory
{
    public InPlaceTranslationOverlayWindow CreateOverlay(TextChunk textChunk)
    {
        return new InPlaceTranslationOverlayWindow
        {
            ChunkId = textChunk.ChunkId,
            OriginalText = textChunk.CombinedText,
            TranslatedText = textChunk.TranslatedText,
        };
    }

    public void ConfigureOverlay(
        InPlaceTranslationOverlayWindow overlay,
        TextChunk textChunk)
    {
        var overlaySize = textChunk.GetOverlaySize();

        // ğŸ”§ [WIDTH_FIX] ã“ã“ã§ç¢ºå®Ÿã«è¨­å®š
        var textBlock = overlay.FindControl<TextBlock>("InPlaceTranslatedTextBlock");
        if (textBlock != null)
        {
            textBlock.MaxWidth = overlaySize.Width - 8; // Border Paddingè€ƒæ…®
        }

        overlay.Width = overlaySize.Width;
        overlay.Position = textChunk.GetBasicOverlayPosition();
    }
}
```

**â‘¡ IInPlaceOverlayManager** (ç°¡ç´ åŒ–)
```csharp
public class InPlaceTranslationOverlayManager : IInPlaceTranslationOverlayManager
{
    private readonly IInPlaceOverlayFactory _factory;
    private readonly IOverlayPositioningService _positioning;
    private readonly ConcurrentDictionary<int, InPlaceTranslationOverlayWindow> _overlays = new();

    public async Task ShowInPlaceOverlayAsync(
        TextChunk textChunk,
        CancellationToken ct)
    {
        // ã‚·ãƒ³ãƒ—ãƒ«ãªå‡¦ç†ãƒ•ãƒ­ãƒ¼
        var overlay = _factory.CreateOverlay(textChunk);
        _factory.ConfigureOverlay(overlay, textChunk);

        await Dispatcher.UIThread.InvokeAsync(() =>
        {
            overlay.Show();
            _overlays[textChunk.ChunkId] = overlay;
        });
    }
}
```

**æœŸå¾…åŠ¹æœ**:
- InPlaceOverlayFactory.cs (200è¡Œ)
- InPlaceTranslationOverlayManager.cs (300è¡Œ) â† ç°¡ç´ åŒ–
- IOverlayPositioningServiceçµ±åˆå¼·åŒ–

#### 4.2 WIDTH_FIXå•é¡Œã®å®Œå…¨è§£æ±º (1æ—¥)

**èª¿æŸ»å†…å®¹**:
1. ãªãœMETHOD_ENTRYãƒ­ã‚°ãŒå‡ºãªã„ã‹ç‰¹å®š
2. å®Ÿéš›ã®å®Ÿè¡Œãƒ‘ã‚¹ã‚’ç¢ºèª
3. Factoryã§WIDTH_FIXç¢ºå®Ÿé©ç”¨

**æ¤œè¨¼æ–¹æ³•**:
- ãƒ­ã‚°å‡ºåŠ›ç¢ºèª
- å®Ÿéš›ã«ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤å¹…ãŒå›ºå®šã•ã‚Œã‚‹ã‹ç›®è¦–ç¢ºèª
- è¤‡æ•°ãƒãƒ£ãƒ³ã‚¯ã§å‹•ä½œç¢ºèª

#### 4.3 ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼æ•´ç† (1-2æ—¥)

**å¯¾è±¡**:
- AggregatedChunksReadyEventHandler
- CaptureCompletedHandler
- TranslationCompletedHandler

**æ•´ç†å†…å®¹**:
- è²¬ä»»ã®æ˜ç¢ºåŒ–
- ä¸è¦ãªãƒ­ã‚°å‰Šé™¤
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–

---

### Phase 5: çµ±åˆãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼ (2-3æ—¥)

#### 5.1 æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ (1æ—¥)
- ã‚­ãƒ£ãƒ—ãƒãƒ£ â†’ OCR â†’ ç¿»è¨³ â†’ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤º
- ã‚­ãƒ£ãƒ³ã‚»ãƒ«å‹•ä½œç¢ºèª
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‹•ä½œç¢ºèª
- WIDTH_FIXå‹•ä½œç¢ºèª

#### 5.2 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ (1æ—¥)
- gRPC vs stdin/stdoutæ¯”è¼ƒ
- ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ç¢ºèª
- CPUä½¿ç”¨ç‡æ¸¬å®š

#### 5.3 å›å¸°ãƒ†ã‚¹ãƒˆ (1æ—¥)
- æ—¢å­˜1,300+ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œ
- æ–°è¦ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 

---

## ğŸ“Š æœŸå¾…åŠ¹æœ

| é …ç›® | ç¾åœ¨ | Phase 5å®Œäº†å¾Œ |
|------|------|--------------|
| **ç·ã‚³ãƒ¼ãƒ‰è¡Œæ•°** | ~15,000è¡Œ | **~10,000è¡Œ** (-33%) |
| **OptimizedPythonTranslationEngine** | 1,500è¡Œ | **å‰Šé™¤** |
| **InPlaceTranslationOverlayManager** | 1,067è¡Œ | **500è¡Œ** |
| **ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰** | ä¸æ˜ | **å®Œå…¨å‰Šé™¤** |
| **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå•é¡Œ** | ã‚ã‚Š | **è§£æ±º** |
| **WIDTH_FIXå•é¡Œ** | ä¸æ˜ | **è§£æ±º** |
| **æŠ€è¡“çš„è² å‚µ** | é«˜ | **æ¥µã‚ã¦ä½** |
| **ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§** | å›°é›£ | **å®¹æ˜“** |
| **ä¿å®ˆæ€§** | ä½ | **é«˜** |

---

## ğŸ¯ æœ€çµ‚æˆæœç‰©

1. âœ… **ã‚¯ãƒªãƒ¼ãƒ³ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**
2. âœ… **gRPCåŸºç›¤ï¼ˆæ¥­ç•Œæ¨™æº–ï¼‰**
3. âœ… **ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å®Œå…¨å‰Šé™¤**
4. âœ… **WIDTH_FIXå•é¡Œè§£æ±º**
5. âœ… **å…¨ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–**
6. âœ… **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œå‚™**

---

## âš ï¸ ãƒªã‚¹ã‚¯è©•ä¾¡ã¨Mitigation Strategy

### 1. BaketaCaptureNative.dllé€£æºãƒªã‚¹ã‚¯ (GeminiæŒ‡æ‘˜)

**ãƒªã‚¹ã‚¯**: ãƒã‚¤ãƒ†ã‚£ãƒ–DLLã¨ã®é€šä¿¡ãŒgRPCç§»è¡Œã®å½±éŸ¿ã‚’å—ã‘ã‚‹å¯èƒ½æ€§

**å®Ÿæ…‹**:
- ãƒã‚¤ãƒ†ã‚£ãƒ–DLLã¨ã®é€šä¿¡ã¯**P/InvokeçµŒç”±**ã§ã‚ã‚Šã€gRPCç§»è¡Œã¨**ç„¡é–¢ä¿‚**
- Pythonã‚µãƒ¼ãƒãƒ¼ã¨ã®é€šä¿¡ã®ã¿ãŒstdin/stdout â†’ gRPCã«å¤‰æ›´ã•ã‚Œã‚‹
- ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ•ãƒ­ãƒ¼: C# â†’ P/Invoke â†’ C++/WinRT DLL (å¤‰æ›´ãªã—)
- ç¿»è¨³ãƒ•ãƒ­ãƒ¼: C# â†’ gRPC â†’ Python (å¤‰æ›´ã‚ã‚Š)

**Mitigation**:
- Phase 0.2ã§P/Invokeå®£è¨€ã®æ­£ç¢ºæ€§ã‚’å†ç¢ºèª
- SafeImageAdapterçµ±åˆå•é¡Œï¼ˆObjectDisposedExceptionï¼‰ã‚’å„ªå…ˆè§£æ±º
- ãƒã‚¤ãƒ†ã‚£ãƒ–DLLé€£æºã®å˜ä½“ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 

**ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«**: ğŸŸ¡ ä¸­ï¼ˆå®Ÿéš›ã®å½±éŸ¿ã¯é™å®šçš„ã ãŒã€ç¢ºèªå¿…é ˆï¼‰

### 2. gRPCç§»è¡Œã«ä¼´ã†ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒªã‚¹ã‚¯

**ãƒªã‚¹ã‚¯**: stdin/stdoutã‚ˆã‚Šé…ã„å¯èƒ½æ€§

**Mitigation**:
- Phase 5.2ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿæ–½
- Protobufãƒã‚¤ãƒŠãƒªã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹é«˜é€ŸåŒ–æœŸå¾…
- HTTP/2ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªé€šä¿¡

**ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«**: ğŸŸ¢ ä½ï¼ˆç†è«–ä¸Šã¯é«˜é€ŸåŒ–ãŒæœŸå¾…ã§ãã‚‹ï¼‰

### 3. Phase 1ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤ã§ã®å½±éŸ¿ç¯„å›²

**ãƒªã‚¹ã‚¯**: æ„å›³ã—ãªã„æ©Ÿèƒ½å‰Šé™¤

**Mitigation**:
- Phase 0.1ã®é™çš„è§£æã§æ…é‡ã«ç‰¹å®š
- å‰Šé™¤å‰ã«å…¨ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œ
- å‰Šé™¤å¾Œã‚‚å…¨ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œ

**ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«**: ğŸŸ¡ ä¸­ï¼ˆé™çš„è§£æã¨ãƒ†ã‚¹ãƒˆã§ç®¡ç†å¯èƒ½ï¼‰

### 4. WIDTH_FIXå•é¡Œã®æ ¹æœ¬åŸå› ä¸æ˜

**ãƒªã‚¹ã‚¯**: Factory Patternã§è§£æ±ºã§ããªã„å¯èƒ½æ€§

**Mitigation**:
- Phase 0.2ã§METHOD_ENTRYãƒ­ã‚°ãŒå‡ºãªã„åŸå› ã‚’å®Œå…¨ç‰¹å®š
- å®Ÿè¡Œãƒ•ãƒ­ãƒ¼ã‚’å®Œå…¨ã«å¯è¦–åŒ–ã—ã¦ã‹ã‚‰å®Ÿè£…ç€æ‰‹

**ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«**: ğŸŸ¡ ä¸­ï¼ˆèª¿æŸ»æ¬¡ç¬¬ã§è§£æ±ºå¯èƒ½ï¼‰

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [grpc.md](C:\Users\suke0\OneDrive\ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—\grpc.md) - gRPC vs stdin/stdoutæ¯”è¼ƒ
- [CLAUDE.local.md](../../CLAUDE.local.md) - Phase 12.2å•é¡Œã®è©³ç´°
- [CLAUDE.md](../../CLAUDE.md) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

---

## ğŸ“ å‚™è€ƒ

- **ãƒªãƒªãƒ¼ã‚¹å‰**: ã¾ã ãƒªãƒªãƒ¼ã‚¹ã—ã¦ã„ãªã„ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚ˆã‚ŠæŠ€è¡“çš„è² å‚µæ¸…ç®—ã‚’å„ªå…ˆ
- **æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯æ›´æ–°é »åº¦**: çŸ­æœŸé–“ã§ã®å¤‰æ›´ã«ã‚ˆã‚Šè² å‚µè“„ç©
- **gRPCç§»è¡Œç†ç”±**: æ¥­ç•Œæ¨™æº–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã€Œæœ€å¾Œã®é€šä¿¡å±¤å¤‰æ›´ã€ã«ã™ã‚‹
