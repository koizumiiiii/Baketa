# 実装: イベント集約機構の構築

## 概要
モジュール間の疎結合通信を実現するイベント集約システムを設計・実装します。

## 目的・理由
現状では、モジュール間の連携が直接的な参照に依存しており、コンポーネント間の結合度が高くなっています。イベント集約機構を導入することで、発行者（Publisher）と購読者（Subscriber）の疎結合なコミュニケーションを実現し、システムの拡張性とテスト容易性を向上させます。

## 詳細
- イベント関連インターフェースの設計と実装
- モジュール間で交換される主要イベント型の定義
- イベントハンドラーの登録と管理メカニズムの実装
- イベント配信の非同期処理対応

## イベント設計の基本方針
1. **単一責任の原則**:
   - 各イベントは明確に定義された単一の通知を表現
   - イベントの名前と内容は一致させる

2. **型安全性**:
   - ジェネリック型を活用した型安全なイベントハンドリング
   - コンパイル時の型チェックでエラーを早期発見

3. **非同期処理**:
   - すべてのイベントハンドリングは非同期処理をサポート
   - Taskベースの非同期インターフェース

4. **軽量設計**:
   - メモリ効率を考慮したイベントオブジェクト設計
   - 不要なイベントサブスクリプションのリーク防止

## タスク分解
- [ ] `IEvent`インターフェースの設計と実装
- [ ] `IEventHandler<TEvent>`インターフェースの設計と実装
- [ ] `IEventAggregator`インターフェースの設計と実装
- [ ] `EventAggregator`クラスの実装
- [ ] 基本イベント型の定義（CaptureCompleted、OcrCompleted等）
- [ ] イベントハンドラー登録メカニズムの実装
- [ ] DIでのイベント集約機構の登録

## 関連Issue/参考
- 関連: #1 改善: 新インターフェース構造への移行
- 関連: #2 改善: 依存性注入モジュール構造の実装
- 子Issue: #4.1 実装: イベント関連インターフェースの設計と実装
- 子Issue: #4.2 実装: イベント型とハンドラーの実装
- 子Issue: #4.3 実装: イベント集約管理機能の実装
- 参照: E:\dev\Baketa\docs\3-architecture\improved-architecture.md (7. イベント集約機構の設計)
- 参照: E:\dev\Baketa\docs\2-development\coding-standards\csharp-standards.md (3. 非同期プログラミング)

## マイルストーン
マイルストーン1: アーキテクチャ基盤の改善

## ラベル
- `type: feature`
- `priority: high`
- `component: core`
