# αテスト追加要件 - 部分実装必須機能

**作成日**: 2025-01-07  
**追加Issue**: #135, #74, #79  
**目的**: αテスト時点で部分的実装が必要な機能の詳細分析と実装計画

## 1. Issue #135: 各種画面UI作成（部分実装）

### αテストで必要な部分

#### 🎯 メインオーバーレイ（優先度A）- 必須実装
**現状**: ⚠️ 基本UI実装済み、オーバーレイ統合が必要  
**αテスト必要度**: 🔴 最重要 - ユーザー体験の核心

##### 必要な機能（簡易版）：
```
┌─────────────────┐
│ [▶] Start       │ ← 翻訳開始（ウィンドウ選択→翻訳開始）
│ [⏹] Stop        │ ← 翻訳停止
│ [👁] Show/Hide   │ ← 翻訳結果表示切り替え  
│ [●] Status      │ ← 状態表示（待機中/動作中/エラー）
├─────────────────┤
│ [⚙] Settings    │ ← 設定画面（基本設定のみ）
│ [✕] Exit        │ ← アプリ終了
└─────────────────┘
```

##### 実装が必要な要素：
- **翻訳開始/停止制御**: ウィンドウ選択ダイアログ → 翻訳開始
- **ウィンドウ選択UI**: Discord画面共有スタイルの簡易版
- **状態表示**: 3状態（待機中/動作中/エラー）の視覚的表示
- **オーバーレイ表示切り替え**: 翻訳結果の表示/非表示
- **Fluent Icons統合**: 基本アイコンセットの実装

#### 🌐 翻訳結果ウィンドウ - 簡易実装
**αテスト仕様**:
- **表示内容**: 翻訳テキストのみ（シンプル表示）
- **背景**: 基本的な半透明効果（Acrylic Material簡易版）
- **配置**: 固定位置または手動調整可能
- **サイズ**: 最大幅400px、動的高さ

#### ⚙️ 設定画面（基本項目のみ）
**αテスト対象**:
- **基本設定タブ**: 翻訳エンジン（ローカルのみ）、言語設定
- **表示設定**: フォントサイズ、透明度（基本調整）
- **詳細設定**: 除外（αテストでは複雑性回避）

### αテストで除外する機能
- **高度なアニメーション**: Connected Animation、詳細な状態遷移
- **詳細設定画面**: プロファイル管理、高度な設定項目
- **アクセシビリティ機能**: キーボードナビゲーション、色覚支援

---

## 2. Issue #74: 設定検証と適用システム（基本実装）

### αテストで必要な部分

#### 🔍 基本設定検証 - 必須実装
**現状**: ✅ 基盤実装済み、検証ルール拡張が必要  
**αテスト必要度**: 🟡 重要 - 安定性確保

##### 実装必要項目：
```csharp
// αテスト用基本検証
public class AlphaTestSettingsValidator : ISettingsValidator
{
    // 基本検証ルール
    - 数値範囲チェック（フォントサイズ、透明度等）
    - 必須値チェック（言語設定、翻訳エンジン等）
    - 文字列長チェック（パス、設定値等）
    - 列挙値チェック（エンジン種別、言語コード等）
}
```

##### 検証対象設定：
- **翻訳設定**: エンジン選択（OPUS-MTのみ）、言語ペア
- **表示設定**: フォントサイズ（8-48px）、透明度（10-90%）
- **キャプチャ設定**: 検出間隔（100-5000ms）
- **OCR設定**: 検出感度（基本設定のみ）

#### 🔄 設定適用システム（簡易版）
**実装範囲**:
```csharp
// αテスト用設定ハンドラー
- TranslationSettingsHandler: 翻訳エンジン切り替え
- UISettingsHandler: フォント・透明度適用
- CaptureSettingsHandler: キャプチャ間隔調整
```

##### 適用制御：
- **即時適用**: UI設定（フォント、透明度）
- **再起動適用**: 翻訳エンジン設定
- **エラー時ロールバック**: 基本的な前設定復元

### αテストで除外する機能
- **高度な依存関係管理**: 複雑な設定間依存性
- **詳細な変更履歴**: 設定変更の詳細追跡
- **カスタム検証ルール**: プラグイン式検証機能

---

## 3. Issue #79: ローカル翻訳モデル最適化（Phase 1のみ）

### αテストで必要な部分

#### 🔧 OPUS-MT基本統合 - 必須実装
**現状**: ✅ 基盤実装済み、統合・最適化が必要  
**αテスト必要度**: 🔴 最重要 - 翻訳機能の核心

##### Phase 1実装項目（αテスト向け）：
```csharp
// 必須実装
- OpusMTTranslationEngine: 基本的なONNX Runtime統合
- SentencePieceTokenizer: 日英・英日トークナイザー
- ModelManager（簡易版）: ローカルモデル管理
- 基本エラーハンドリング: モデル読み込み失敗対応
```

##### 対応言語ペア（αテスト限定）：
- **必須**: 日本語⇔英語（ja-en, en-ja）のみ
- **除外**: 中国語関連（zh-ja, ja-zh）※リリース後アップデート対応

##### 基本最適化：
- **メモリ使用量**: < 300MB（αテスト制限）
- **翻訳速度**: 短文 < 2秒（性能要件緩和）
- **安定性**: 基本的なエラー回復機能

#### 🎯 統合要件（αテスト特化）
```csharp
// UI層との統合
- 翻訳エンジン選択UI（OPUS-MTのみ表示）
- 言語ペア選択UI（日英・英日の2言語ペアのみ）
- 翻訳状態表示（処理中・完了・エラー）
- 基本設定項目（品質 vs 速度は除外）
```

### αテストで除外する機能
- **Phase 2: モデル管理システム**: 高度なモデル配布・管理
- **Phase 3: 詳細最適化**: 量子化、GPU対応準備
- **拡張性設計**: Issue #54統合準備（基本設計のみ保持）
- **高度なエラー処理**: 自動復旧、詳細診断

---

## 4. αテスト統合実装計画

### 🔄 実装フロー統合

#### Phase 1: コアUI統合（3-4日）
1. **メインオーバーレイ基本実装**
   - Issue #135: 基本レイアウト + アイコン
   - 翻訳開始/停止ボタン
   - 状態表示機能

2. **ウィンドウ選択ダイアログ**
   - Issue #135: Discord風選択UI（簡易版）
   - ウィンドウ一覧表示
   - 選択確定機能

#### Phase 2: 翻訳統合（2-3日）
1. **OPUS-MT統合強化**
   - Issue #79: 基本翻訳パイプライン
   - UI層との結合強化
   - エラーハンドリング統合

2. **翻訳結果表示**
   - Issue #135: 翻訳ウィンドウ実装
   - オーバーレイ表示制御
   - 基本スタイリング

#### Phase 3: 設定統合（1-2日）
1. **設定画面基本実装**
   - Issue #135: 基本設定タブ
   - Issue #74: 設定検証統合
   - 即時適用機能

2. **設定適用システム**
   - Issue #74: 基本ハンドラー実装
   - フィーチャーフラグ連携
   - エラー時ロールバック

### 🎯 統合成功指標

#### 機能統合指標
- [ ] メインオーバーレイからの翻訳開始・停止
- [ ] ウィンドウ選択→翻訳実行の一連フロー
- [ ] 翻訳結果のオーバーレイ表示
- [ ] 基本設定の適用・検証

#### 品質統合指標
- [ ] 翻訳成功率 > 85%（日英・英日）
- [ ] UI応答性 < 500ms（オーバーレイ操作）
- [ ] メモリ使用量 < 400MB（総合）
- [ ] エラー回復率 > 90%（基本エラー）

### 🚨 リスク要因・軽減策

#### 高リスク要因
1. **UI-翻訳エンジン統合**: 既存実装の結合複雑性
   - **軽減策**: 段階的統合、モック使用による分離テスト

2. **オーバーレイ表示システム**: Windows API統合
   - **軽減策**: 既存実装活用、最小限の変更

3. **設定適用タイミング**: リアルタイム適用の複雑性
   - **軽減策**: 再起動適用中心、即時適用は限定項目のみ

#### 中リスク要因
1. **OPUS-MT最適化**: パフォーマンス調整
   - **軽減策**: 性能要件緩和、段階的最適化

2. **ウィンドウ選択UI**: 新規実装項目
   - **軽減策**: シンプルな一覧表示、高度機能は除外

---

## 5. αテスト機能マトリクス（更新版）

| 機能カテゴリ | 完全実装 | 部分実装 | 新規実装 | 除外 |
|-------------|---------|---------|---------|------|
| **基本UI・設定** | 5機能 | 3機能 | 2機能 | 4機能 |
| **翻訳・言語** | 3機能 | 2機能 | 1機能 | 3機能 |
| **オーバーレイ** | 2機能 | 2機能 | 1機能 | 2機能 |
| **設定管理** | 2機能 | 2機能 | 1機能 | 2機能 |

### 新規実装必要項目（追加）
1. **メインオーバーレイ統合**: UI要素とバックエンド統合
2. **ウィンドウ選択ダイアログ**: Discord風選択UI
3. **翻訳結果オーバーレイ**: 半透明翻訳表示
4. **基本設定検証**: αテスト用検証ルール
5. **OPUS-MT UI統合**: 翻訳エンジン選択・状態表示

---

## 6. 実装優先度（更新版）

### 🔴 最優先（αテスト開始前必須）
1. **フィーチャーフラグシステム** - 機能制御基盤
2. **メインオーバーレイ基本実装** - ユーザー体験核心
3. **OPUS-MT基本統合** - 翻訳機能核心
4. **プライバシー同意システム** - 法的要件

### 🟡 高優先（αテスト期間中）
1. **ウィンドウ選択ダイアログ** - 翻訳開始フロー
2. **翻訳結果オーバーレイ** - 翻訳表示機能
3. **基本設定画面・検証** - 設定機能
4. **フィードバック収集システム** - αテスト成果

### 🟢 中優先（αテスト後期・改善時）
1. **UI詳細調整**: アニメーション、スタイリング
2. **設定適用最適化**: リアルタイム適用拡張
3. **OPUS-MT最適化**: パフォーマンス向上

---

## 7. 期待されるαテスト体験（更新版）

### ✅ ユーザーができること
- **直感的翻訳開始**: オーバーレイから1クリックで翻訳開始
- **ウィンドウ選択**: ゲーム画面選択→翻訳実行
- **リアルタイム翻訳**: 選択ウィンドウの文字をリアルタイム翻訳
- **翻訳結果表示**: 半透明オーバーレイでの翻訳表示
- **基本設定調整**: 言語、フォント、透明度の調整
- **簡単フィードバック**: 設定画面からのフィードバック送信

### ❌ ユーザーができないこと（意図的制限）
- **高度なプロファイル管理**: ゲーム別設定等
- **詳細な表示カスタマイズ**: 位置調整、詳細スタイル
- **複雑な翻訳設定**: 品質調整、詳細オプション
- **アカウント機能**: ログイン、同期、履歴管理

この追加要件により、**シンプルながら実用的なローカル翻訳体験**を提供し、αテストの成功に必要な最小限の機能を効率的に実装できます。