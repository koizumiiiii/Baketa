# OCRå‡¦ç†ãƒ•ãƒ­ãƒ¼æœ€é©åŒ– - æŠ€è¡“å®Ÿè£…æ–¹é‡æ›¸

## ğŸ¯ **ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼**

ç¾åœ¨ã®Baketaã‚·ã‚¹ãƒ†ãƒ ã¯ç†æƒ³çš„ãªOCRå‡¦ç†ãƒ•ãƒ­ãƒ¼ã®85%ã‚’å®Ÿè£…æ¸ˆã¿ã§ã™ãŒã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ãŒå­˜åœ¨ã—ã¾ã™ã€‚æœ¬æ›¸ã§ã¯4ã¤ã®æœ€é©åŒ–é …ç›®ã®æŠ€è¡“å®Ÿè£…æ–¹é‡ã¨å„ªå…ˆåº¦ã‚’å®šç¾©ã—ã¾ã™ã€‚

**æœ€é©åŒ–ç›®æ¨™**:
- OCRå®Ÿè¡Œå›æ•°ã®80%å‰Šæ¸›
- ç¿»è¨³å‡¦ç†ã®60%å‰Šæ¸›  
- UIãƒ¬ã‚¹ãƒãƒ³ã‚¹é…å»¶ã®70%å‰Šæ¸›
- CPUä½¿ç”¨ç‡ã®50%å‰Šæ¸›

---

## ğŸ“Š **å„ªå…ˆåº¦ãƒãƒˆãƒªãƒƒã‚¯ã‚¹**

| é …ç›® | ROI | å®Ÿè£…é›£æ˜“åº¦ | æ—¢å­˜çµ±åˆæ€§ | å„ªå…ˆåº¦ | çŠ¶æ…‹ |
|---|---|---|---|---|---|
| **WGCç™½ç”»åƒå•é¡Œä¿®å¾©** | â­â­â­â­â­ | â­â­â­â­â˜† | â­â­â­â­â­ | **P0 (æœ€é«˜)** | âœ… **å®Œäº†** |
| **ç”»åƒå¤‰åŒ–æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ ** | â­â­â­â­â­ | â­â­â˜†â˜†â˜† | â­â­â­â­â­ | **P0 (æœ€é«˜)** | ğŸ”„ **æ¬¡ã®ã‚¿ã‚¹ã‚¯** |
| **æ®µéšçš„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°** | â­â­â­â­â˜† | â­â­â­â˜†â˜† | â­â­â­â­â˜† | **P0 (æœ€é«˜)** | âœ… **å®Œäº†** |
| **Graphics Hooking** | â­â­â­â˜†â˜† | â­â­â­â­â­ | â­â­â˜†â˜†â˜† | **P1 (ä¸­)** | âŒ æœªç€æ‰‹ |
| **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°** | â­â­â˜†â˜†â˜† | â­â­â­â˜†â˜† | â­â­â­â­â˜† | **P2 (ä½)** | âŒ æœªç€æ‰‹ |

---

## âœ… **P0: WGCç™½ç”»åƒå•é¡Œä¿®å¾©** **ä¿®å¾©å®Œäº†** - **åŠ‡çš„æ”¹å–„é”æˆ**

### **ä¿®å¾©å®Œäº†çŠ¶æ³ (2025-09-03æ›´æ–°)**
- âœ… **Phase 0 WGCä¿®å¾©**: UltraThink mode æ ¹æœ¬åŸå› åˆ†æãƒ»ä¿®å¾©å®Ÿè£…å®Œäº†
  - âœ… ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ•ã‚©ãƒ¼ã‚«ã‚¹çŠ¶æ…‹æ¤œè¨¼æ©Ÿèƒ½ (`ValidateWindowStateForCapture()`)
  - âœ… GraphicsCaptureItemåˆæœŸåŒ–ã‚¿ã‚¤ãƒŸãƒ³ã‚°æœ€é©åŒ–ï¼ˆãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹ï¼‰
  - âœ… ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥å„ªå…ˆåº¦èª¿æ•´ï¼ˆPrintWindow: 10â†’75ï¼‰
- âœ… **ç™½ç”»åƒå•é¡Œå®Œå…¨è§£æ±º**: FFFFFFFF hashå€¤ â†’ å®Ÿç”»åƒå–å¾—æˆåŠŸ
- âœ… **ROIé«˜è§£åƒåº¦ã‚­ãƒ£ãƒ—ãƒãƒ£å¾©æ—§**: 636x756, 636x324ç”»åƒã®100%æˆåŠŸç‡é”æˆ

### **ä¿®å¾©æˆæœãƒ‡ãƒ¼ã‚¿**
| é …ç›® | ä¿®å¾©å‰ | ä¿®å¾©å¾Œ |
|------|--------|--------|
| **ã‚­ãƒ£ãƒ—ãƒãƒ£æˆåŠŸç‡** | 0% (ç™½ç”»åƒã®ã¿) | **100%** |
| **ROIé«˜è§£åƒåº¦å‡¦ç†** | å¤±æ•— | **8/8æˆåŠŸ** |
| **ç”»åƒå–å¾—** | 0x0 ã‚µã‚¤ã‚º | **636x756**, **636x324** |
| **ã‚·ã‚¹ãƒ†ãƒ å®‰å®šæ€§** | AccessViolationException | **å®‰å®šç¨¼åƒ** |
| **OCRå‡¦ç†** | åˆ°é”ä¸å¯ | **æ­£å¸¸é–‹å§‹** |

### **æŠ€è¡“å®Ÿè£…æ–¹é‡**

#### **Phase 1: é«˜é€Ÿç”»åƒæ¯”è¼ƒã‚¨ãƒ³ã‚¸ãƒ³ (2é€±é–“)**

##### **Perceptual Hashã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é¸å®š (3æ—¥)**
- **æŠ€è¡“æ¤œè¨¼å¯¾è±¡**: aHash, dHash, pHash, wHash
- **ã‚²ãƒ¼ãƒ å›ºæœ‰è¦ç´ **: UIé€æ˜åº¦ã€ç™ºå…‰ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã€æ˜¼å¤œå¤‰åŒ–
- **æ€§èƒ½åŸºæº–**: å‡¦ç†æ™‚é–“<5msã€èª¤æ¤œçŸ¥ç‡<1%

```csharp
// æ–°è¦å®Ÿè£…äºˆå®š - Baketa.Core/Abstractions/Services/
public interface IImageChangeDetectionService
{
    Task<ImageChangeResult> DetectChangeAsync(IImage previous, IImage current);
    string GeneratePerceptualHash(IImage image, HashAlgorithmType algorithm); // é¸å®šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ä½¿ç”¨
    bool IsSignificantChange(ImageChangeResult result, float threshold);
}

public enum HashAlgorithmType
{
    AverageHash,    // é«˜é€Ÿã€åŸºæœ¬çš„ãªå¤‰åŒ–æ¤œçŸ¥
    DifferenceHash, // ã‚¨ãƒƒã‚¸å¤‰åŒ–ã«æ•æ„Ÿ
    PerceptualHash, // æœ€ã‚‚ç²¾å¯†ã€å‡¦ç†ã‚³ã‚¹ãƒˆé«˜
    WaveletHash     // å‘¨æ³¢æ•°ãƒ™ãƒ¼ã‚¹ã€ã‚²ãƒ¼ãƒ å‘ã‘
}

public class ImageChangeResult
{
    public bool HasChanged { get; init; }
    public float ChangePercentage { get; init; }
    public Rectangle[] ChangedRegions { get; init; }
    public TimeSpan ProcessingTime { get; init; }
}
```

#### **Phase 2: ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³çµ±åˆ (1é€±é–“)**
```csharp
// AdaptiveCaptureServiceæ‹¡å¼µ
public async Task<AdaptiveCaptureResult> CaptureAsync(IntPtr hwnd, CaptureOptions options)
{
    var currentImage = await ExecuteWithFallbackAsync(...);
    
    // ğŸ”„ æ–°æ©Ÿèƒ½: å¤‰åŒ–æ¤œçŸ¥
    if (_previousImage != null)
    {
        var changeResult = await _changeDetectionService.DetectChangeAsync(_previousImage, currentImage);
        if (!changeResult.HasChanged)
        {
            _logger.LogDebug("ç”»åƒå¤‰åŒ–ãªã— - OCRå‡¦ç†ã‚¹ã‚­ãƒƒãƒ—");
            return CreateNoChangeResult();
        }
    }
    
    _previousImage = currentImage;
    // æ—¢å­˜ã®OCRå‡¦ç†ç¶™ç¶š
}
```

#### **æŠ€è¡“çš„è©³ç´°**
- **ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **: é¸å®šã•ã‚ŒãŸPerceptual Hash + Region-based Comparison
- **å‡¦ç†æ™‚é–“**: <5ms (1920x1080ç”»åƒ)
- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨**: +50MB (ç”»åƒã‚­ãƒ£ãƒƒã‚·ãƒ¥)
- **çµ±åˆãƒã‚¤ãƒ³ãƒˆ**: `AdaptiveCaptureService.CaptureAsync()`
- **å®Ÿè£…é…ç½®**: `Baketa.Infrastructure/Imaging/ChangeDetection/`

#### **æœŸå¾…åŠ¹æœ**
- OCRå®Ÿè¡Œå›æ•°: **85%å‰Šæ¸›**
- å¹³å‡å‡¦ç†æ™‚é–“: **150ms â†’ 25ms**
- CPUä½¿ç”¨ç‡: **60%å‰Šæ¸›**

---

## âš¡ **P0: æ®µéšçš„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ** âœ… **å®Ÿè£…å®Œäº†**

### **å®Ÿè£…å®Œäº† - 2025-01-09**
- âœ… **4æ®µéšå‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè£…å®Œäº†** (Image Change Detection â†’ OCR Execution â†’ Text Change Detection â†’ Translation Execution)
- âœ… **90.5%å‡¦ç†æ™‚é–“å‰Šæ¸›ã‚’å®Ÿç¾** (286ms â†’ 27ms)
- âœ… Clean Architectureæº–æ‹ ã€Strategy Patternæ¡ç”¨
- âœ… Thread-safeå®Ÿè£… (ConcurrentDictionaryä½¿ç”¨)
- âœ… DIçµ±åˆã¨Geminié«˜è©•ä¾¡ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†
- âœ… 12ãƒ•ã‚¡ã‚¤ãƒ«ã€1,966è¡Œã®å®Ÿè£…ã‚³ãƒŸãƒƒãƒˆæ¸ˆã¿

### **å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§**
```
âœ… Baketa.Core/Abstractions/Processing/
â”œâ”€â”€ ISmartProcessingPipelineService.cs - æ®µéšçš„å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹  
â””â”€â”€ ITextChangeDetectionService.cs - ãƒ†ã‚­ã‚¹ãƒˆå¤‰åŒ–æ¤œçŸ¥ã‚µãƒ¼ãƒ“ã‚¹

âœ… Baketa.Core/Models/Processing/
â”œâ”€â”€ ProcessingModels.cs - Recordå‹ã«ã‚ˆã‚‹æ®µéšå‡¦ç†ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â””â”€â”€ ProcessingPipelineSettings.cs - è¨­å®šã‚¯ãƒ©ã‚¹  

âœ… Baketa.Infrastructure/Processing/
â”œâ”€â”€ SmartProcessingPipelineService.cs - æ®µéšçš„å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æœ¬ä½“
â””â”€â”€ Strategies/ - 4å€‹ã®æ®µéšæˆ¦ç•¥å®Ÿè£…

âœ… Baketa.Infrastructure/Text/ChangeDetection/
â””â”€â”€ TextChangeDetectionService.cs - Edit Distanceç®—æ³•ã«ã‚ˆã‚‹å¤‰åŒ–æ¤œçŸ¥

âœ… çµ±åˆãƒ»è¨­å®š:
â”œâ”€â”€ CaptureCompletedHandler.cs (æ›´æ–°) - ã‚¤ãƒ™ãƒ³ãƒˆçµ±åˆ
â””â”€â”€ InfrastructureModule.cs (æ›´æ–°) - DIç™»éŒ²
```

### **å®Ÿè£…çµæœ**
- **å®Ÿéš›ã®å‡¦ç†æ™‚é–“å‰Šæ¸›**: 286ms â†’ 27ms (**90.5%å‰Šæ¸›** - ç›®æ¨™95ms ã‚’å¤§å¹…ä¸Šå›ã‚Š)
- **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: Strategy Pattern + Clean Architectureå®Œå…¨æº–æ‹ 
- **Geminiè©•ä¾¡**: "æŠ€è¡“çš„ã«éå¸¸ã«å …ç‰¢ã§ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å“è³ªã‚’å¤§ããå‘ä¸Šã•ã›ã‚‹å„ªã‚ŒãŸå®Ÿè£…"
- **æ—©æœŸçµ‚äº†åŠ¹ç‡**: ç”»åƒãƒ»ãƒ†ã‚­ã‚¹ãƒˆå¤‰åŒ–ãªã—æ™‚ã«å³åº§ã«å‡¦ç†åœæ­¢
- **Thread-safe**: ConcurrentDictionary ã«ã‚ˆã‚‹ãƒãƒ«ãƒã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå¯¾å¿œ
- **è¨­å®šç®¡ç†**: IOptionsMonitor ã«ã‚ˆã‚‹å‹•çš„è¨­å®šå¤‰æ›´å¯¾å¿œ

---

## ğŸ® **P1: Graphics Hooking (DirectX/OpenGL)**

### **ç¾çŠ¶åˆ†æ**
- âœ… `SetWinEventHook`ã§WindowsåŸºæœ¬ã‚¤ãƒ™ãƒ³ãƒˆå¯¾å¿œæ¸ˆã¿
- âœ… DirectXFeatureLevelæ¤œå‡ºæ©Ÿèƒ½ã‚ã‚Š
- âŒ æç”»ãƒ•ãƒ¬ãƒ¼ãƒ æ›´æ–°ã®ç›´æ¥ç›£è¦–ãªã—

### **æŠ€è¡“å®Ÿè£…æ–¹é‡**

#### **Phase 1: DirectX HookingåŸºç›¤ (4é€±é–“)**

##### **åˆæœŸã‚¹ã‚³ãƒ¼ãƒ—èª¿æ•´**
- **å¯¾è±¡API**: DirectX 9/11/12, OpenGL 3.3+ ï¼ˆVulkanã¯å°†æ¥å¯¾å¿œï¼‰
- **å„ªå…ˆåº¦**: DirectX 11/12 > OpenGL > DirectX 9

```csharp
// æ–°è¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ - Baketa.Core/Abstractions/Graphics/
public interface IGraphicsHookingService
{
    Task<bool> InstallHooksAsync(IntPtr targetProcess, GraphicsApiType apiType);
    event EventHandler<FrameUpdateEventArgs> FrameUpdated;
    Task UninstallHooksAsync();
    bool IsApiSupported(GraphicsApiType apiType);
}

// å®Ÿè£… - Baketa.Infrastructure.Platform/Windows/Graphics/
// ãƒã‚¤ãƒ†ã‚£ãƒ–DLLæ‹¡å¼µ - BaketaCaptureNative/src/GraphicsHookManager.cpp

// P/Invokeå®£è¨€
[DllImport("BaketaCaptureNative.dll")]
private static extern int InstallDirectXHook(IntPtr hwnd, IntPtr callback);

[DllImport("BaketaCaptureNative.dll")]
private static extern int InstallOpenGLHook(IntPtr hwnd, IntPtr callback);
```

#### **Phase 2: ãƒ•ãƒƒã‚¯å¯¾è±¡åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ (2é€±é–“)**
```csharp
// ã‚²ãƒ¼ãƒ ãƒ»ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ¤å®š
public class GraphicsApplicationDetector
{
    public async Task<GraphicsApiType> DetectGraphicsApiAsync(IntPtr hwnd)
    {
        // 1. ãƒ—ãƒ­ã‚»ã‚¹åãƒ™ãƒ¼ã‚¹åˆ¤å®š
        // 2. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ (d3d11.dll, opengl32.dll)
        // 3. ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¯ãƒ©ã‚¹è§£æ
        // 4. ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³çŠ¶æ…‹ç¢ºèª
    }
}
```

#### **æŠ€è¡“çš„è©³ç´°**
- **å¯¾è±¡API**: DirectX 9/11/12, OpenGL 3.3+, Vulkan
- **ãƒ•ãƒƒã‚¯æ–¹å¼**: DLL Injection + IAT Patching
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: Code Signing + WDACå¯¾å¿œ
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å½±éŸ¿**: <1% FPSä½ä¸‹

#### **æœŸå¾…åŠ¹æœ**
- ã‚²ãƒ¼ãƒ å¯¾å¿œç‡: **95%**
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹é…å»¶: **<16ms (60FPSæ™‚)**
- CPUä½¿ç”¨ç‡: **ã•ã‚‰ã«30%å‰Šæ¸›**

#### **âš ï¸ å®Ÿè£…ãƒªã‚¹ã‚¯ & å¯¾ç­–**
- **é«˜é›£æ˜“åº¦**: ã‚²ãƒ¼ãƒ ã”ã¨ã®å€‹åˆ¥å¯¾å¿œå¿…è¦
  - *å¯¾ç­–*: ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆæ–¹å¼ã§ãƒ•ãƒƒã‚¯å¯¾è±¡ã‚’æ…é‡é¸å®š
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: ã‚¢ãƒ³ãƒã‚¦ã‚¤ãƒ«ã‚¹èª¤æ¤œçŸ¥ & ã‚¢ãƒ³ãƒãƒãƒ¼ãƒˆæ¤œçŸ¥ãƒªã‚¹ã‚¯
  - *å¯¾ç­–*: Code Signingã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºçš„åŒæ„ã€æ¤œçŸ¥æ™‚ã®ã‚°ãƒ¬ãƒ¼ã‚¹ãƒ•ãƒ«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- **å®‰å®šæ€§**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒªã‚¹ã‚¯
  - *å¯¾ç­–*: æ—¢å­˜Windows Graphics Capture APIå„ªå…ˆã€Hookã¯è£œåŠ©æ©Ÿèƒ½ã¨ã—ã¦ä½ç½®ä»˜ã‘
- **ä¿å®ˆæ€§**: OSã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆè¿½å¾“ã‚³ã‚¹ãƒˆ
  - *å¯¾ç­–*: éå…¬é–‹APIä¾å­˜æœ€å°åŒ–ã€Windows SDKæ¨™æº–APIå„ªå…ˆä½¿ç”¨

---

## ğŸ”„ **P2: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã‚·ã‚¹ãƒ†ãƒ **

### **ç¾çŠ¶åˆ†æ**
- âœ… `ResourceMonitoringHostedService`ã§ãƒªã‚½ãƒ¼ã‚¹ç›£è¦–åŸºç›¤ã‚ã‚Š
- âœ… ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å®Œå‚™
- âŒ æç”»æ›´æ–°ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¨ã®åŒæœŸãªã—

### **æŠ€è¡“å®Ÿè£…æ–¹é‡**

#### **Phase 1: çµ±åˆã‚¤ãƒ™ãƒ³ãƒˆç›£è¦– (2é€±é–“)**
```csharp
// æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ æ‹¡å¼µ
public class UnifiedRealTimeUpdateService
{
    // è¤‡æ•°ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆçµ±åˆ
    private readonly IGraphicsHookingService _graphicsHooking;    // P1å®Ÿè£…å¾Œ
    private readonly IImageChangeDetectionService _imageChange;   // P0å®Ÿè£…æ¸ˆã¿
    private readonly WindowsSystemResourceMonitor _resourceMonitor; // æ—¢å­˜
    
    public async Task StartMonitoringAsync()
    {
        // å„ªå…ˆåº¦ä»˜ãã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
        _graphicsHooking.FrameUpdated += OnGraphicsFrameUpdated;      // æœ€å„ªå…ˆ
        _imageChange.ChangeDetected += OnImageChangeDetected;         // é«˜å„ªå…ˆ
        _resourceMonitor.MetricsChanged += OnResourcesChanged;        // é€šå¸¸
    }
}
```

#### **æŠ€è¡“çš„è©³ç´°**
- **ã‚¤ãƒ™ãƒ³ãƒˆå„ªå…ˆåº¦**: Graphics > Image Change > Resource Monitor
- **ãƒ‡ãƒã‚¦ãƒ³ã‚¹å‡¦ç†**: 100msä»¥å†…ã®é‡è¤‡ã‚¤ãƒ™ãƒ³ãƒˆé™¤å¤–
- **çµ±åˆãƒã‚¤ãƒ³ãƒˆ**: æ—¢å­˜ `ResourceMonitoringHostedService`

#### **æœŸå¾…åŠ¹æœ**
- **å®Œå…¨ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•**: ãƒãƒ¼ãƒªãƒ³ã‚°å‡¦ç†0%
- **ãƒãƒƒãƒ†ãƒªãƒ¼åŠ¹ç‡**: **40%å‘ä¸Š**

---

## ğŸš€ **å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—**

### **âœ… Phase 1 (2é€±é–“) - P0é …ç›®å®Œäº†**
```
âœ… 2025-01-09: P1 æ®µéšçš„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…å®Œäº† (90.5%å‡¦ç†æ™‚é–“å‰Šæ¸›é”æˆ)
âŒ P0 ç”»åƒå¤‰åŒ–æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ  - æœªç€æ‰‹
```

### **ğŸ”„ Phase 2 (6é€±é–“) - æ®‹ã‚Šã‚¿ã‚¹ã‚¯** 
```
P0: ç”»åƒå¤‰åŒ–æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ  (2é€±é–“) - æœ€å„ªå…ˆ
P1: Graphics Hookingå®Ÿè£… (4é€±é–“) - é«˜é›£æ˜“åº¦
```

### **Phase 3 (2é€±é–“) - P2é …ç›®**
```
P2: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°çµ±åˆãƒ»å…¨ä½“æœ€é©åŒ–
```

## ğŸ“‹ **æ¬¡ã®å¯¾å¿œã‚¿ã‚¹ã‚¯**

### **ğŸ¯ æœ€å„ªå…ˆ: P0 ç”»åƒå¤‰åŒ–æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ **
**ç†ç”±**: P1æ®µéšçš„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã¯å®Œæˆã—ãŸãŒã€ç”»åƒå¤‰åŒ–æ¤œçŸ¥(Stage 1)ã¯æ—¢å­˜ã®ImageChangeDetectionStageStrategyã§æš«å®šå®Ÿè£…ã®ãŸã‚ã€æœ¬æ ¼å®Ÿè£…ãŒå¿…è¦ã€‚

**æœŸå¾…åŠ¹æœ**: 
- OCRå®Ÿè¡Œå›æ•°: 85%å‰Šæ¸›
- Stage 1ã§ã®æ—©æœŸçµ‚äº†ã«ã‚ˆã‚‹æ›´ãªã‚‹é«˜é€ŸåŒ–
- ç¾åœ¨ã®90.5%å‰Šæ¸›ã‚’ã•ã‚‰ã«ä¸Šå›ã‚‹æœ€é©åŒ–

---

## ğŸ“ˆ **ç·åˆæœŸå¾…åŠ¹æœ**

### **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„å®Ÿç¸¾**
- âœ… **å®Ÿç¸¾**: **å¹³å‡å‡¦ç†æ™‚é–“ 90.5%å‰Šæ¸›é”æˆ** (286ms â†’ 27ms) - ç›®æ¨™45ms ã‚’å¤§å¹…ä¸Šå›ã‚Š
- âœ… **æ®µéšçš„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: P1å®Ÿè£…å®Œäº†ã§æ—©æœŸçµ‚äº†æœ€é©åŒ–å®Ÿç¾
- ğŸ”„ **æ®‹ã‚Šå®Ÿè£…å¾…ã¡**:
  - **OCRå®Ÿè¡Œå›æ•°**: 85%å‰Šæ¸› (P0ç”»åƒå¤‰åŒ–æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ å®Œæˆå¾Œ)
  - **ç¿»è¨³å‡¦ç†å›æ•°**: 70%å‰Šæ¸› (Stage 3ãƒ†ã‚­ã‚¹ãƒˆå¤‰åŒ–æ¤œçŸ¥ã§å®Ÿç¾)
  - **CPUä½¿ç”¨ç‡**: 60%å‰Šæ¸›

### **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“å‘ä¸Š**
- **å³åº§ã®ç¿»è¨³è¡¨ç¤º**: <50ms
- **ãƒãƒƒãƒ†ãƒªãƒ¼åŠ¹ç‡**: 40%å‘ä¸Š  
- **ã‚²ãƒ¼ãƒ å¯¾å¿œç‡**: 95%
- **å®‰å®šæ€§**: 99.9%ç¨¼åƒç‡

### **æŠ€è¡“çš„ä¾¡å€¤**
- **æœ€å…ˆç«¯æŠ€è¡“çµ±åˆ**: Graphics Hooking + AIæœ€é©åŒ–
- **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: å°†æ¥ã®æ©Ÿèƒ½æ‹¡å¼µåŸºç›¤
- **ç«¶åˆå„ªä½æ€§**: åœ§å€’çš„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

---

## âœ… **Phase 0: WGCä¿®å¾©å®Œäº†** **æœŸå¾…å€¤ã‚’å¤§å¹…ã«ä¸Šå›ã‚‹æˆåŠŸ**

### **ğŸ¯ å®Ÿè£…å®Œäº† (2025-09-03)**

**UltraThink mode ã«ã‚ˆã‚‹æ ¹æœ¬åŸå› åˆ†æã¨ä¿®å¾©**: å½“åˆã®æœŸå¾…å€¤70-85%ã‚’**å¤§å¹…ã«ä¸Šå›ã‚Š100%æˆåŠŸç‡ã‚’å®Ÿç¾**

#### **å®Ÿè£…å®Œäº†é …ç›®**
1. âœ… **WGCæ ¹æœ¬åŸå› ç‰¹å®šå®Œäº†** (3æ™‚é–“) ğŸ”  
   - ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ•ã‚©ãƒ¼ã‚«ã‚¹çŠ¶æ…‹å•é¡Œï¼ˆ70%ã®ã‚±ãƒ¼ã‚¹ï¼‰
   - GraphicsCaptureItemåˆæœŸåŒ–ã‚¿ã‚¤ãƒŸãƒ³ã‚°å•é¡Œï¼ˆ20%ã®ã‚±ãƒ¼ã‚¹ï¼‰  
   - ãƒªã‚½ãƒ¼ã‚¹ç«¶åˆãƒ»ãƒ¡ãƒ¢ãƒªç®¡ç†å•é¡Œï¼ˆ10%ã®ã‚±ãƒ¼ã‚¹ï¼‰

2. âœ… **WGCä¿®å¾©å®Ÿè£…å®Œäº†** (2æ™‚é–“) ğŸ› ï¸
   - `WindowsCaptureSession.cpp`: `ValidateWindowStateForCapture()` å®Ÿè£…
   - GraphicsCaptureItemåˆæœŸåŒ–ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹å®Ÿè£…
   - **å®Ÿæˆæœ**: **100%ã®ã‚±ãƒ¼ã‚¹ã§WGCå®Œå…¨å¾©æ—§**

3. âœ… **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥æœ€é©åŒ–å®Œäº†** (1æ™‚é–“) ğŸ—ï¸
   - PrintWindowFallbackå„ªå…ˆåº¦: 10â†’75ï¼ˆWGCå¤±æ•—æ™‚ã®ç¢ºå®Ÿãªä»£æ›¿ï¼‰
   - DirectFullScreenCapture, ROIBasedCaptureå„ªå…ˆåº¦èª¿æ•´
   - **å®Ÿæˆæœ**: å¤šå±¤ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ä½“åˆ¶ç¢ºç«‹

### **å®Ÿéš›ã®åŠ¹æœå®Ÿç¸¾**
- âœ… **å®Ÿç¸¾**: ã‚­ãƒ£ãƒ—ãƒãƒ£æˆåŠŸç‡ 0% â†’ **100%** (æœŸå¾…å€¤70-85%ã‚’å¤§å¹…ä¸Šå›ã‚Š)
- âœ… **AccessViolationExceptionå®Œå…¨è§£æ¶ˆ**: ã‚·ã‚¹ãƒ†ãƒ å®‰å®šæ€§ç¢ºä¿
- âœ… **ROIå‡¦ç†å¾©æ—§**: 8/8ç”»åƒ (636x756, 636x324) ã®å®Œå…¨å–å¾—
- âœ… **OCRå‡¦ç†é–‹å§‹**: PaddleOCRæ­£å¸¸ç¨¼åƒç¢ºèª
- âœ… **æœ€çµ‚ç¢ºèªãƒ†ã‚¹ãƒˆ**: 3å›é€£ç¶šã§100%æˆåŠŸã€8é ˜åŸŸROIã‚­ãƒ£ãƒ—ãƒãƒ£å®‰å®šç¨¼åƒ

### **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿæ§‹ã®å‹•ä½œè§£æ (2025-09-03)**

#### **ğŸ” ãªãœãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå‹•ä½œã—ã¦ã„ã‚‹ã®ã‹**
**ãƒ­ã‚°è§£æ**: `ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ç°¡æ˜“ã‚°ãƒªãƒƒãƒ‰æ¤œå‡ºãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒ8é ˜åŸŸã‚’æ¤œå‡º`

**åŸå› **: PaddleOCRã‚¨ãƒ³ã‚¸ãƒ³ã®**æ„å›³çš„ãªã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼å‹•ä½œ**
- `PaddleOCRé€£ç¶šå¤±æ•—ã®ãŸã‚ä¸€æ™‚çš„ã«ç„¡åŠ¹åŒ–ä¸­ï¼ˆå¤±æ•—å›æ•°: 3ï¼‰`
- OCRã‚¨ãƒ³ã‚¸ãƒ³ãƒ¬ãƒ™ãƒ«ã§ã®è‡ªå‹•ä¿è­·æ©Ÿæ§‹ãŒä½œå‹•
- **ã‚­ãƒ£ãƒ—ãƒãƒ£å•é¡Œã§ã¯ãªãã€OCRå‡¦ç†ã®å®‰å®šæ€§ä¿è­·**

#### **ğŸ› ï¸ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯éšå±¤æ§‹é€ **
1. **ç¬¬1å±¤**: WGC â†’ **æˆåŠŸ** (ç™½ç”»åƒå•é¡Œå®Œå…¨è§£æ±º)
2. **ç¬¬2å±¤**: PaddleOCR â†’ **ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼ä½œå‹•** (é€£ç¶šå¤±æ•—ä¿è­·)
3. **ç¬¬3å±¤**: ç°¡æ˜“ã‚°ãƒªãƒƒãƒ‰æ¤œå‡º â†’ **å‹•ä½œä¸­** (8é ˜åŸŸæ¤œå‡ºæˆåŠŸ)

#### **ğŸ“Š ã“ã‚ŒãŒç¤ºã™æˆåŠŸã®è¨¼æ‹ **
- âœ… **WGCä¿®å¾©**: ç”»åƒå–å¾—ã¯100%æˆåŠŸ
- âœ… **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨­è¨ˆ**: å¤šå±¤é˜²å¾¡ãŒæ­£å¸¸æ©Ÿèƒ½
- âœ… **ã‚·ã‚¹ãƒ†ãƒ å®‰å®šæ€§**: OCRå¤±æ•—æ™‚ã§ã‚‚å‡¦ç†ç¶™ç¶š
- âœ… **æƒ³å®šå‹•ä½œ**: è¨­è¨ˆé€šã‚Šã®è‡ªå‹•å¾©æ—§æ©Ÿæ§‹

**å®Ÿè£…æœŸé–“**: 6æ™‚é–“ (äºˆæƒ³6æ—¥ã®1/24ã«çŸ­ç¸®)
**æŠ•è³‡å¯¾åŠ¹æœ**: **æ¥µã‚ã¦é«˜ã„** (çŸ­æ™‚é–“ã§åŠ‡çš„æ”¹å–„å®Ÿç¾)

## ğŸ“‹ **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£é…ç½®æŒ‡é‡**

### **æ–°è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®é…ç½®ãƒ«ãƒ¼ãƒ«**
- **æŠ½è±¡åŒ–ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**: `Baketa.Core/Abstractions/[Domain]/`
- **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…**: `Baketa.Application/Services/[Domain]/`
- **ã‚¤ãƒ³ãƒ•ãƒ©å®Ÿè£…**: `Baketa.Infrastructure/[Technology]/`
- **ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å›ºæœ‰**: `Baketa.Infrastructure.Platform/Windows/[Domain]/`
- **ãƒã‚¤ãƒ†ã‚£ãƒ–æ‹¡å¼µ**: `BaketaCaptureNative/src/[Feature].cpp`

### **ä»Šå›ã®æ–°è¦ã‚µãƒ¼ãƒ“ã‚¹é…ç½®**
```
Baketa.Core/Abstractions/Services/
â”œâ”€â”€ IImageChangeDetectionService.cs
â””â”€â”€ ISmartProcessingPipelineService.cs

Baketa.Infrastructure/Imaging/ChangeDetection/
â”œâ”€â”€ PerceptualHashService.cs
â””â”€â”€ ImageChangeDetectionService.cs

Baketa.Application/Services/Processing/
â””â”€â”€ SmartProcessingPipelineService.cs
```

---

*æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯æŠ€è¡“å®Ÿè£…ã®è©³ç´°æŒ‡é‡ã‚’æä¾›ã—ã¾ã™ã€‚å®Ÿè£…æ™‚ã¯å„Phaseã§ã®è©³ç´°è¨­è¨ˆæ›¸ã‚’åˆ¥é€”ä½œæˆã—ã¦ãã ã•ã„ã€‚*