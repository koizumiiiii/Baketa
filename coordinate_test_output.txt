?? [ENCODING_INIT] Failed to configure UTF-8 console: ハンドルが無効です。
[00:16:40.002] ?? Performance Logging System Initialized
[00:16:40.009] ???  System: Microsoft Windows NT 10.0.26100.0
[00:16:40.011] ?? Memory: 0MB
[00:16:40.013] ???  Runtime: 8.0.19
[00:16:40.015] ?? WorkDir: E:\dev\Baketa
[00:16:40.016] ?? BaseDir: E:\dev\Baketa\Baketa.UI\bin\Debug\net8.0-windows10.0.19041.0\
[00:16:40.022] ?? START [OverallProcessing_0001_001640_022] OverallProcessing: アプリケーション起動全体
[00:16:40.023] ?? Baketa.UI.exe 起動開始
[00:16:40.026] ?? CHECKPOINT [OverallProcessing_0001_001640_022] 統一ログシステム初期化完了 - Elapsed: 3.5ms
?? DIコンテナの初期化開始
?? ConfigureServices開始
?? Debugger.IsAttached: False
?? 環境: Development (OCR設定確保のため強制Development)
?? [CONFIG_PATH_DEBUG] Base Directory: E:\dev\Baketa\Baketa.UI\bin\Debug\net8.0-windows10.0.19041.0\
?? [CONFIG_PATH_DEBUG] Current Directory: E:\dev\Baketa
?? [CONFIG_PATH_DEBUG] appsettings.json exists in BaseDirectory: True
?? [CONFIG_PATH_DEBUG] appsettings.json exists in CurrentDirectory: True
?? [CONFIG_PATH_DEBUG] Selected config base path: E:\dev\Baketa
?? [CONFIG_PATH_DEBUG] Environment config file: appsettings.Development.json
?? [CONFIG_PATH_DEBUG] Environment config file exists: True
?? [CONFIG_DETAILED] All configuration keys:
?? [CONFIG_DETAILED] OCR = 
?? [CONFIG_DETAILED] OCR:RecognitionThreshold = 0.3
?? [CONFIG_DETAILED] OCR:PaddleOCR = 
?? [CONFIG_DETAILED] OCR:PaddleOCR:WorkerCount = 4
?? [CONFIG_DETAILED] OCR:PaddleOCR:UseLanguageModel = True
?? [CONFIG_DETAILED] OCR:PaddleOCR:UseGpu = False
?? [CONFIG_DETAILED] OCR:PaddleOCR:RecognitionThreshold = 0.3
?? [CONFIG_DETAILED] OCR:PaddleOCR:Language = jpn
?? [CONFIG_DETAILED] OCR:PaddleOCR:EnablePreprocessing = True
?? [CONFIG_DETAILED] OCR:PaddleOCR:EnableMultiThread = True
?? [CONFIG_DETAILED] OCR:PaddleOCR:EnableHybridMode = True
?? [CONFIG_DETAILED] OCR:PaddleOCR:DetectionThreshold = 0.6
?? [CONFIG_DETAILED] OCR:LogPerformanceMetrics = True
?? [CONFIG_DETAILED] OCR:LogModelInfo = True
?? [CONFIG_DETAILED] OCR:HybridStrategy = 
?? [CONFIG_DETAILED] OCR:HybridStrategy:RegionCountThreshold = 5
?? [CONFIG_DETAILED] OCR:HybridStrategy:ImageQualityThreshold = 0.6
?? [CONFIG_DETAILED] OCR:HybridStrategy:HighQualityTimeoutMs = 3000
?? [CONFIG_DETAILED] OCR:HybridStrategy:HighQualityModel = V5
?? [CONFIG_DETAILED] OCR:HybridStrategy:FastDetectionTimeoutMs = 500
?? [CONFIG_DETAILED] OCR:HybridStrategy:FastDetectionModel = V3
?? [CONFIG_DETAILED] OCR:EnableDebugLogging = True
?? [CONFIG_DETAILED] OCR:DetectionThreshold = 0.6
?? [CONFIG_DETAILED] Logging:LogLevel:Baketa.Infrastructure.OCR = Debug
?? [FIRST] DiagnosticModule最優先登録開始
?? [DIAGNOSTIC] 診断レポートシステム登録開始
?? [DIAGNOSTIC] BackgroundTaskQueue登録完了
?? [DIAGNOSTIC] DiagnosticServices登録完了
?? [DIAGNOSTIC] ImageDiagnosticsSaver登録完了
?? [DIAGNOSTIC] EventProcessors登録完了
? [DIAGNOSTIC] 診断レポートシステム登録完了
? [FIRST] DiagnosticModule最優先登録完了
?? Phase 2-1: 基盤モジュール群登録開始
??? Core基盤モジュール登録開始
? Core基盤モジュール登録完了
?? 設定システム登録開始
? 設定システム登録完了
?? Infrastructure基盤モジュール登録開始
?? [DIAGNOSTIC] 診断レポートシステム登録開始
?? [DIAGNOSTIC] BackgroundTaskQueue登録完了
?? [DIAGNOSTIC] DiagnosticServices登録完了
?? [DIAGNOSTIC] ImageDiagnosticsSaver登録完了
?? [DIAGNOSTIC] EventProcessors登録完了
? [DIAGNOSTIC] 診断レポートシステム登録完了
?? スティッキーROIシステム登録開始 - Issue #143 Week 3
? IStickyRoiManager登録完了 - InMemory実装
? StickyRoiEnhancedOcrEngine登録完了 - デコレーター実装
? スティッキーROIシステム登録完了
?? OptimizedPythonTranslationEngine登録開始 - モデルロード完了待機機構有効
? FixedSizeConnectionPool登録完了 - 動的ポート対応（NLLB-200/OPUS-MT自動切り替え）
?? OptimizedPythonTranslationEngine登録完了 - Pythonサーバー接続問題解決済み
?? Issue #147 Phase 3.2: OptimizedPythonTranslationEngineを使用してハイブリッド戦略を実運用（削除した既存登録数: 0）
?? [PHASE2] サーキットブレーカー登録開始
? [PHASE2] TranslationCircuitBreaker登録完了 - FailureThreshold: 5, RecoveryTimeout: 60s
?? [DI_DEBUG] PythonServerHealthMonitor登録開始
? [DI_DEBUG] PythonServerHealthMonitor登録完了 - 自動ヘルスチェック・再起動機能
?? Issue #147 Phase 3.2: ハイブリッド翻訳戦略システム登録開始
? TranslationMetricsCollector登録完了
? Issue #147 Phase 3.2: ハイブリッド翻訳戦略システム登録完了
?? Issue #147 Phase 5: ポート競合防止機構サービス登録開始
? PortManagementService登録完了 - Mutexプロセス間競合防止
? PythonServerManager登録完了 - 動的ポート管理・自動復旧
?? Phase 5: ポート競合防止機構サービス登録完了
?? ウォームアップサービス登録開始 - Issue #143
? IWarmupService登録完了
? WarmupHostedService登録完了
?? GPU統合サービス登録開始 - Issue #143 Week 2
? IOnnxSessionFactory登録完了 - DI統合
? IOnnxModelConfiguration登録完了 - モデル外部化
? IPersistentSessionCache登録完了 - 永続キャッシュ
? IGpuOcrEngine登録完了 - Mock実装
? GPU統合サービス登録完了
?? 統合パフォーマンス管理システム登録開始 - Issue #143 Week 3 Phase 2
? IPerformanceOrchestrator登録完了 - 統合最適化システム
?? PooledGpuOptimizationOrchestrator登録完了 - プール化×GPU最適化統合システム
? 統合パフォーマンス管理システム登録完了（プール化×GPU最適化含む）
?? [PHASE3] 動的リソース監視システム登録開始
? [PHASE3] ResourceMonitoringSettings設定完了 - 監視間隔:5s, 履歴保持:60分
?? [PHASE3] IResourceMonitor実装はPlatformModuleで登録されます
?? [PHASE3] 動的リソース監視システム登録完了
? Infrastructure基盤モジュール登録完了
??? Platform基盤モジュール登録開始
?? Windows GPU サービス登録開始 - Issue #143
? WindowsGpuEnvironmentDetector登録完了
? WindowsGpuDeviceManager登録完了
? WindowsTdrRecoveryManager登録完了
? Windows GPU サービス登録完了
?? [PHASE3 Platform] Windows リソース監視サービス登録開始
? [PHASE3 Platform] WindowsSystemResourceMonitor登録完了 - パフォーマンスカウンター統合
?? [PHASE3 Platform] Windows リソース監視サービス登録完了
? Platform基盤モジュール登録完了
?? AdaptiveCapture基盤モジュール登録開始
?????? AdaptiveCaptureModule.RegisterServices 呼び出されました！
? AdaptiveCapture基盤モジュール登録完了
?? Auth基盤モジュール登録開始
? Auth基盤モジュール登録完了
?? 基盤モジュール登録済み数: 6
? Phase 2-1: 基盤モジュール群登録完了
?? Phase 2-2: アプリケーション・特殊機能モジュール群登録開始
?? ApplicationModule登録開始
?? [DIAGNOSTIC] 診断レポートシステム登録開始
?? [DIAGNOSTIC] BackgroundTaskQueue登録完了
?? [DIAGNOSTIC] DiagnosticServices登録完了
?? [DIAGNOSTIC] ImageDiagnosticsSaver登録完了
?? [DIAGNOSTIC] EventProcessors登録完了
? [DIAGNOSTIC] 診断レポートシステム登録完了
?? スティッキーROIシステム登録開始 - Issue #143 Week 3
? IStickyRoiManager登録完了 - InMemory実装
? StickyRoiEnhancedOcrEngine登録完了 - デコレーター実装
? スティッキーROIシステム登録完了
?? OptimizedPythonTranslationEngine登録開始 - モデルロード完了待機機構有効
? FixedSizeConnectionPool登録完了 - 動的ポート対応（NLLB-200/OPUS-MT自動切り替え）
?? OptimizedPythonTranslationEngine登録完了 - Pythonサーバー接続問題解決済み
?? Issue #147 Phase 3.2: OptimizedPythonTranslationEngineを使用してハイブリッド戦略を実運用（削除した既存登録数: 1）
?? [PHASE2] サーキットブレーカー登録開始
? [PHASE2] TranslationCircuitBreaker登録完了 - FailureThreshold: 5, RecoveryTimeout: 60s
?? [DI_DEBUG] PythonServerHealthMonitor登録開始
? [DI_DEBUG] PythonServerHealthMonitor登録完了 - 自動ヘルスチェック・再起動機能
?? Issue #147 Phase 3.2: ハイブリッド翻訳戦略システム登録開始
? TranslationMetricsCollector登録完了
? Issue #147 Phase 3.2: ハイブリッド翻訳戦略システム登録完了
?? Issue #147 Phase 5: ポート競合防止機構サービス登録開始
? PortManagementService登録完了 - Mutexプロセス間競合防止
? PythonServerManager登録完了 - 動的ポート管理・自動復旧
?? Phase 5: ポート競合防止機構サービス登録完了
?? ウォームアップサービス登録開始 - Issue #143
? IWarmupService登録完了
? WarmupHostedService登録完了
?? GPU統合サービス登録開始 - Issue #143 Week 2
? IOnnxSessionFactory登録完了 - DI統合
? IOnnxModelConfiguration登録完了 - モデル外部化
? IPersistentSessionCache登録完了 - 永続キャッシュ
? IGpuOcrEngine登録完了 - Mock実装
? GPU統合サービス登録完了
?? 統合パフォーマンス管理システム登録開始 - Issue #143 Week 3 Phase 2
? IPerformanceOrchestrator登録完了 - 統合最適化システム
?? PooledGpuOptimizationOrchestrator登録完了 - プール化×GPU最適化統合システム
? 統合パフォーマンス管理システム登録完了（プール化×GPU最適化含む）
?? [PHASE3] 動的リソース監視システム登録開始
? [PHASE3] ResourceMonitoringSettings設定完了 - 監視間隔:5s, 履歴保持:60分
?? [PHASE3] IResourceMonitor実装はPlatformModuleで登録されます
?? [PHASE3] 動的リソース監視システム登録完了
?? Windows GPU サービス登録開始 - Issue #143
? WindowsGpuEnvironmentDetector登録完了
? WindowsGpuDeviceManager登録完了
? WindowsTdrRecoveryManager登録完了
? Windows GPU サービス登録完了
?? [PHASE3 Platform] Windows リソース監視サービス登録開始
? [PHASE3 Platform] WindowsSystemResourceMonitor登録完了 - パフォーマンスカウンター統合
?? [PHASE3 Platform] Windows リソース監視サービス登録完了
?? Windows GPU サービス登録開始 - Issue #143
? WindowsGpuEnvironmentDetector登録完了
? WindowsGpuDeviceManager登録完了
? WindowsTdrRecoveryManager登録完了
? Windows GPU サービス登録完了
?? [PHASE3 Platform] Windows リソース監視サービス登録開始
? [PHASE3 Platform] WindowsSystemResourceMonitor登録完了 - パフォーマンスカウンター統合
?? [PHASE3 Platform] Windows リソース監視サービス登録完了
?????? AdaptiveCaptureModule.RegisterServices 呼び出されました！
info: Baketa.Application.DI.Modules.CaptureModule[0]
      キャプチャサービス統合モジュール登録開始
info: Baketa.Application.DI.Modules.CaptureModule[0]
      キャプチャサービス統合モジュール登録完了 - AdaptiveCaptureServiceをメインとして使用
?? [DI_DEBUG] StreamingTranslationService登録開始
? [DI_DEBUG] StreamingTranslationService登録完了
?? [DI_DEBUG] TranslationDictionaryService登録開始
? [DI_DEBUG] TranslationDictionaryService登録完了
? ApplicationModule登録完了
?? [GEMINI] StagedOcrStrategyModule登録開始...
?? HighPerformanceOcrModule.RegisterServices 実行中！
? [GEMINI] StagedOcrStrategyModule登録完了！
?? [GEMINI] AdvancedCachingModule登録開始...
?? AdvancedCachingModule.RegisterServices 実行中！
? IAdvancedOcrCacheService登録完了
? Step3: 高度キャッシング戦略登録完了
?? 期待効果: キャッシュヒット時 数ミリ秒応答
? [GEMINI] AdvancedCachingModule登録完了！
?? UIModule登録開始
? UIModule登録完了
??? OverlayUIModule登録開始
? OverlayUIModule登録完了
?? BatchOcrModule登録開始
? BatchOcrModule登録完了
?? OcrProcessingModule登録開始
? OcrProcessingModule登録完了
?? OpenCvProcessingModule登録開始
? OpenCvProcessingModule登録完了
?? PaddleOcrModule登録開始
?? [DI_FIX] IOcrEngine/PaddleOcrEngineシングルトン登録をObjectPoolに統一
?? [DI_FIX] 多重インスタンス問題の根本解決 - プールベース管理のみ使用
?? パフォーマンス改善: OCRエンジンオブジェクトプーリング登録開始
? IPaddleOcrEngineFactory登録完了（プール用ファクトリ）
?? [DI_FIX] 既存登録削除ロジックを除去 - シングルトン登録削除により不要
? IPooledObjectPolicy<IOcrEngine>の登録完了
? DefaultObjectPoolProviderの登録完了
? ObjectPool<IOcrEngine>の登録完了
?? OCRエンジンオブジェクトプーリングの登録が完了しました
?? 期待効果: AccessViolationException根絶 + パフォーマンス大幅向上
? PaddleOcrModule登録完了
?? Phase4: UnifiedGpuModule登録開始
? Phase4: UnifiedGpuModule登録完了
?? アダプターサービス登録開始
? アダプターサービス登録完了
?? アプリケーション・特殊機能モジュール登録済み数: 11
? Phase 2-2: アプリケーション・特殊機能モジュール群登録完了
=== DI Service Registration Debug ===
ISettingsService registrations count: 1
  - ServiceType: ISettingsService
  - ImplementationType: N/A
  - Lifetime: Singleton
  - ImplementationFactory: Yes
ITranslationEngine registrations count: 1
  - ServiceType: ITranslationEngine
  - ImplementationType: N/A
  - Lifetime: Singleton
  - ImplementationFactory: Yes
ITranslationService registrations count: 2
  - ServiceType: ITranslationService
  - ImplementationType: DefaultTranslationService
  - Lifetime: Singleton
  - ImplementationFactory: No
  - ServiceType: ITranslationService
  - ImplementationType: DefaultTranslationService
  - Lifetime: Singleton
  - ImplementationFactory: No
AccessibilitySettingsViewModel registrations count: 1
IOcrPreprocessingService registrations count: 2
  - ServiceType: IOcrPreprocessingService
  - ImplementationType: SimpleOcrPreprocessingService
  - Lifetime: Transient
  - ImplementationFactory: No
  - ServiceType: IOcrPreprocessingService
  - ImplementationType: Factory
  - Lifetime: Transient
  - ImplementationFactory: Yes
  - Factory details: Likely GameOptimizedPreprocessingService (Phase 3)
=== ?? Diagnostic Services Registration Debug ===
IDiagnosticCollectionService registrations count: 3
  - ServiceType: IDiagnosticCollectionService
  - ImplementationType: DiagnosticCollectionService
  - Lifetime: Singleton
  - ImplementationFactory: No
  - ServiceType: IDiagnosticCollectionService
  - ImplementationType: DiagnosticCollectionService
  - Lifetime: Singleton
  - ImplementationFactory: No
  - ServiceType: IDiagnosticCollectionService
  - ImplementationType: DiagnosticCollectionService
  - Lifetime: Singleton
  - ImplementationFactory: No
IDiagnosticReportGenerator registrations count: 3
IBackgroundTaskQueue registrations count: 3
DiagnosticEventProcessor registrations count: 3
=== ?? End Diagnostic Services Debug ===
=== ViewModel Registration Debug ===
AccessibilitySettingsViewModel: 1 registration(s)
  - Lifetime: Singleton
  - ImplementationType: AccessibilitySettingsViewModel
LanguagePairsViewModel: 1 registration(s)
  - Lifetime: Singleton
  - ImplementationType: LanguagePairsViewModel
??? ServiceProvider構築開始
? ServiceProvider構築完了
?? ReactiveUI設定開始
? ReactiveUI設定完了
?????? [MAIN_DIAGNOSTIC] 診断システム直接初期化開始！ ??????
?????? [DIRECT_DEBUG] IDiagnosticCollectionService解決試行中... ??????
?? ObjectPool<IOcrEngine>インスタンス作成完了
info: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService初期化完了 - プール化OCRサービス開始
info: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? AdvancedOcrCacheService initialized - Step3高度キャッシング戦略
info: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine初期化完了 - Step3高度キャッシング戦略有効
info: Baketa.Infrastructure.OCR.GPU.MockGpuOcrEngine[0]
      ?? MockGpuOcrEngine初期化完了 - 仮想GPU加速OCR開始
info: Baketa.Infrastructure.OCR.StickyRoi.InMemoryStickyRoiManager[0]
      ?? InMemoryStickyRoiManager初期化完了 - スティッキーROIシステム開始
info: Baketa.Infrastructure.Platform.Windows.GPU.WindowsGpuDeviceManager[0]
      ?? WindowsGpuDeviceManager初期化完了 - Multi-GPU管理開始
info: Baketa.Infrastructure.OCR.GPU.DefaultOnnxSessionFactory[0]
      ?? DefaultOnnxSessionFactory初期化完了 - DI Container統合
info: Baketa.Infrastructure.Platform.Windows.GPU.WindowsTdrRecoveryManager[0]
      ??? WindowsTdrRecoveryManager初期化完了 - TDR監視開始
info: Baketa.Infrastructure.OCR.GPU.FileBasedSessionCache[0]
      ?? メタデータキャッシュ初期化完了 - 読み込み: 0件
info: Baketa.Infrastructure.OCR.GPU.FileBasedSessionCache[0]
      ?? FileBasedSessionCache初期化完了 - パス: C:\Users\suke0\AppData\Local\Baketa\SessionCache
info: Baketa.Infrastructure.Performance.IntegratedPerformanceOrchestrator[0]
      ?? IntegratedPerformanceOrchestrator初期化完了 - 統合最適化システム開始
info: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? AsyncPerformanceAnalyzer initialized for performance monitoring
?? [DIAGNOSTIC] IOptions<RoiDiagnosticsSettings>取得結果: 成功
?? [DIAGNOSTIC] RoiDiagnosticsSettings値: 存在
?? [DIAGNOSTIC] ROI画像出力パス: C:\Users\suke0\AppData\Roaming\Baketa\ROI\Images
?? [DIAGNOSTIC] ROI画像出力有効: True
info: Baketa.Infrastructure.DI.Modules.InfrastructureModule[0]
      ?? AdaptiveTileStrategy登録完了 - 高速テキスト検出→ROIベース認識（ROI画像保存機能付き）
?? [BATCH-DI] ImageDiagnosticsSaver注入確認: True
?? [BATCH-DI] 他の依存関係確認: OCR=True, Options=True
dbug: Baketa.Infrastructure.Performance.IntegratedPerformanceOrchestrator[0]
      ?? 統合システム初期化開始
info: Baketa.Infrastructure.Platform.Windows.GPU.WindowsTdrRecoveryManager[0]
      ?? TDR監視開始
? [BATCH-DI] BatchOcrProcessor作成完了（diagnosticsSaver注入済み）
?? [DIAGNOSTIC] レポートディレクトリチェック開始: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports'
? [DIAGNOSTIC] ディレクトリは既に存在
??? [DIRECT_SUCCESS] IDiagnosticCollectionService解決成功: DiagnosticCollectionService ???
?? 診断システム直接初期化非同期開始完了
?????? [MAIN_DIAGNOSTIC] 診断システム直接初期化完了！ ??????
?? OCRエンジン事前初期化開始（バックグラウンド）
?? Phase4: 統合GPU最適化システム初期化開始
?? [DIRECT_DEBUG] 診断データ収集開始中...
?? [DIAGNOSTIC_COLLECTION] 診断データ収集開始 - IsCollecting=true
? 診断データ収集開始完了
info: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断データ収集開始
?? OCRエンジン事前初期化開始
?? OCRエンジンサービス取得成功 - 初期化開始
?? 統合GPU最適化システム初期化開始
[00:16:45.282] ?? CHECKPOINT [OverallProcessing_0001_001640_022] Avalonia アプリケーション開始準備完了 - Elapsed: 5259.6ms
?? [CONFIG_DEBUG] Configuration available: True
[00:16:45.283] ?? Avalonia アプリケーション開始
?? [CONFIG_DEBUG] Top-level section: DebugOptions
?? [CONFIG_DEBUG] Top-level section: DiagnosticsSettings
?? [CONFIG_DEBUG] Top-level section: DirectML
?? [CONFIG_DEBUG] Top-level section: GeminiApi
?? [CONFIG_DEBUG] Top-level section: GpuBenchmark
?? [CONFIG_DEBUG] Top-level section: GpuSettings
?? [CONFIG_DEBUG] Top-level section: HybridTranslation
?? [CONFIG_DEBUG] Top-level section: Logging
?? [CONFIG_DEBUG] Top-level section: OCR
?? [CONFIG_DEBUG] OCR child: DetectionThreshold
?? [CONFIG_DEBUG] OCR child: EnableDebugLogging
?? [CONFIG_DEBUG] OCR child: HybridStrategy
?? [CONFIG_DEBUG] OCR child: LogModelInfo
?? [CONFIG_DEBUG] OCR child: LogPerformanceMetrics
?? [CONFIG_DEBUG] OCR child: PaddleOCR
?? [CONFIG_DEBUG] OCR child: RecognitionThreshold
?? [CONFIG_DEBUG] Top-level section: OpenVINO
?? [CONFIG_DEBUG] Top-level section: ResourceMonitoring
?? [CONFIG_DEBUG] Top-level section: SentencePiece
?? [CONFIG_DEBUG] Top-level section: Translation
?? [CONFIG_DEBUG] Top-level section: TranslationEngineStatus
?? [CONFIG_DEBUG] Top-level section: UnifiedGpu
?? [CONFIG_DEBUG] OCR:PaddleOCR section exists: True
?? [CONFIG_DEBUG] EnableHybridMode raw value: 'True'
?? [CONFIG_DEBUG] Alternative access OCR.PaddleOCR exists: True
?? [CONFIG_DEBUG] Alternative EnableHybridMode: 'True'
? OCRエンジン設定をappsettings.jsonから読み込み完了 - EnableHybridMode: True, Language: jpn
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService.InitializeAsync: プール化環境では個別エンジンが初期化されます
info: Baketa.Infrastructure.OCR.GPU.UnifiedGpuOptimizer[0]
      UnifiedGpuOptimizer initialized with 3 providers
?? OCR設定適用完了 - EnableHybridMode: True
info: Baketa.Application.Services.CachedOcrEngine[0]
      ? CachedOcrEngine初期化完了 - 時間: 0ms, 結果: True
? OCRエンジン事前初期化完了 - 初期化時間: 3ms
?? UnifiedGpuInitializer取得成功 - 初期化開始
info: Baketa.Infrastructure.DI.UnifiedGpuInitializer[0]
      ?? Initializing Unified GPU Optimization System
info: Baketa.Infrastructure.Platform.Windows.GPU.WindowsGpuEnvironmentDetector[0]
      GPU環境検出開始
info: Baketa.Infrastructure.Platform.Windows.GPU.WindowsGpuEnvironmentDetector[0]
      GPU環境検出完了: NVIDIA GeForce RTX 4070, CUDA:True, DirectML:True, VRAM:4095MB
dbug: Baketa.Infrastructure.OCR.GPU.Providers.CpuExecutionProviderFactory[0]
      CPU provider always supported as fallback
dbug: Baketa.Infrastructure.OCR.GPU.Providers.OpenVINOExecutionProviderFactory[0]
      OpenVINO not supported by current environment
dbug: Baketa.Infrastructure.OCR.GPU.Providers.DirectMLExecutionProviderFactory[0]
      DirectML requires DirectX 11.1 or higher
info: Baketa.Infrastructure.OCR.GPU.UnifiedGpuOptimizer[0]
      Selected optimal provider: CPU (Priority: 10) for environment: CPU Provider (16 threads)
info: Baketa.Infrastructure.DI.UnifiedGpuInitializer[0]
      ?? Selected optimal provider: CPU
info: Baketa.Infrastructure.DI.UnifiedGpuInitializer[0]
      ? Unified GPU System initialization completed
? 統合GPU最適化システム初期化完了 - 初期化時間: 835ms
?????? [INIT_DEBUG] App.Initialize() 開始 - ServiceProvider状態確認 ??????
[INIT_DEBUG] Program.ServiceProvider == null: False
?? イベント発行: PipelineDiagnosticEvent (ID: a8c94425-b063-4c75-9e6d-a90a5047bf6e)
?? イベント PipelineDiagnosticEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: a8c94425-b063-4c75-9e6d-a90a5047bf6e)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent のプロセッサが登録されていません
?? 診断テストイベント発行完了（直接初期化版）
[INIT_DEBUG] ServiceProvider利用可能 - サービス取得中
?????? [INIT_DEBUG] App.Initialize() 完了 ??????
info: Baketa.UI.App[1]
      Baketaアプリケーションを初期化中
?????? [FRAMEWORK] OnFrameworkInitializationCompleted開始！ ??????
?? OnFrameworkInitializationCompleted開始
?????? [DESKTOP] デスクトップアプリケーション初期化開始！ ??????
?? ReactiveUIエラーハンドラー設定完了
??? IClassicDesktopStyleApplicationLifetime取得成功
?? Program.ServiceProvider確認開始
?? Program.ServiceProviderアクセス試行
?? Program.ServiceProvider取得結果: not null
? Program.ServiceProvider確認成功
?? IEventAggregator取得開始
? IEventAggregator取得成功: EventAggregator
?? EventHandlerInitializationService実行開始
info: Baketa.UI.App[0]
      ? IEventAggregator取得成功: EventAggregator
?? EventHandlerInitializationService非同期実行開始
?????? [CRITICAL] 診断システム開始処理 - 重要ポイント！ ??????
?????? [CRITICAL_DEBUG] IDiagnosticCollectionService解決試行中... ??????
??? [CRITICAL_SUCCESS] IDiagnosticCollectionService解決成功: DiagnosticCollectionService ???
?? 診断システム非同期開始完了
?? MainOverlayViewModel取得開始
?? [DEBUG] 診断データ収集開始中...
?? [DIAGNOSTIC_COLLECTION] 診断データ収集開始 - IsCollecting=true
? 診断データ収集開始完了
info: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断データ収集開始
?? [DI_DEBUG] EventHandlerInitializationService - EventAggregator取得
info: Baketa.Application.Services.Events.EventHandlerInitializationService[0]
      イベントハンドラー初期化を開始します
?? [DI_DEBUG] EventAggregator型: Baketa.Core.Events.Implementation.EventAggregator
info: Baketa.Application.Services.Events.EventHandlerInitializationService[0]
      EventAggregator取得成功
?? [DI_DEBUG] EventAggregatorハッシュ: 11404313
?? [DI_DEBUG] EventAggregator参照: Baketa.Core.Events.Implementation.EventAggregator
info: Baketa.Infrastructure.Services.Settings.UnifiedSettingsService[0]
      UnifiedSettingsService初期化完了 - 監視ディレクトリ: C:\Users\suke0\.baketa\settings
? プロセッサ OcrCompletedHandler をイベント OcrCompletedEvent に登録しました (現在の登録数: 1)
?? [DEBUG] OcrCompletedHandlerを登録しました
info: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ OcrCompletedHandler をイベント OcrCompletedEvent に登録しました
info: Baketa.Application.Services.Events.EventHandlerInitializationService[0]
      OcrCompletedHandlerを登録しました
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      ?? OptimizedPythonTranslationEngine（接続プール統合版）をITranslationEngineとして登録
info: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      接続プール初期化: 最大接続数=8, 最小接続数=1
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      ?? OptimizedPythonTranslationEngine初期化開始 - 接続プール統合版（動的ポート対応）
info: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      最小接続数(1)の初期化開始
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      ?? [NLLB-200] NLLB-200モード - ポート: 5556, スクリプト: nllb_translation_server.py
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      OptimizedPythonTranslationEngine初期化 - Python: py, Script: E:\dev\Baketa\scripts\nllb_translation_server.py
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      モデルロード待機機構を初期化しました
?? [DEBUG] DefaultTranslationService作成 - エンジン数: 1
info: Baketa.Infrastructure.Translation.DefaultTranslationService[0]
      DefaultTranslationService作成 - エンジン数: 1
?? [DEBUG] 登録エンジン: NLLB200 (OptimizedPythonTranslationEngine)
info: Baketa.Infrastructure.Translation.DefaultTranslationService[0]
      登録エンジン: NLLB200 (OptimizedPythonTranslationEngine)
?? [CONFIG] appsettings.json設定読み込み: Translation:DefaultEngine = 'NLLB200'
info: Baketa.Infrastructure.Translation.DefaultTranslationService[0]
      設定からデフォルトエンジン読み込み: NLLB200
?? [MATCH] 完全一致: NLLB200
? [CONFIG] 設定マッチ成功: NLLB200 を使用
info: Baketa.Infrastructure.Translation.DefaultTranslationService[0]
      設定マッチ成功: NLLB200 を使用
?? [CONFIG] アクティブエンジン設定完了: NLLB200 (OptimizedPythonTranslationEngine)
info: Baketa.Infrastructure.Translation.DefaultTranslationService[0]
      アクティブエンジン設定完了: NLLB200 (OptimizedPythonTranslationEngine)
? プロセッサ TranslationRequestHandler をイベント TranslationRequestEvent に登録しました (現在の登録数: 1)
?? [DEBUG] TranslationRequestHandlerを登録しました
info: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ TranslationRequestHandler をイベント TranslationRequestEvent に登録しました
info: Baketa.Application.Services.Events.EventHandlerInitializationService[0]
      TranslationRequestHandlerを登録しました
? プロセッサ TranslationWithBoundsCompletedHandler をイベント TranslationWithBoundsCompletedEvent に登録しました (現在の登録数: 1)
?? [登録確認] TranslationWithBoundsCompletedEvent用プロセッサ登録:
?? [登録確認]   - プロセッサ型: Baketa.Core.Events.Handlers.TranslationWithBoundsCompletedHandler
info: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ TranslationWithBoundsCompletedHandler をイベント TranslationWithBoundsCompletedEvent に登録しました
?? [登録確認]   - イベント型: Baketa.Core.Events.EventTypes.TranslationWithBoundsCompletedEvent
?? [登録確認]   - プロセッサハッシュ: 23085090
?? [DEBUG] TranslationWithBoundsCompletedHandlerを登録しました
info: Baketa.Application.Services.Events.EventHandlerInitializationService[0]
      TranslationWithBoundsCompletedHandlerを登録しました
? プロセッサ DiagnosticEventProcessor をイベント PipelineDiagnosticEvent に登録しました (現在の登録数: 1)
?? [DEBUG] DiagnosticEventProcessorを登録しました
?? [DEBUG] イベントハンドラー初期化が完了しました
info: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor をイベント PipelineDiagnosticEvent に登録しました
info: Baketa.Application.Services.Events.EventHandlerInitializationService[0]
      DiagnosticEventProcessorを登録しました
info: Baketa.Application.Services.Events.EventHandlerInitializationService[0]
      ?? イベントハンドラー初期化が完了しました
?? EventHandlerInitializationService実行完了
dbug: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      新規TCP接続を確立: e62a7611
dbug: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      初期接続を作成: e62a7611
info: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      最小接続数の初期化完了: 1個
? プロセッサ InlineEventProcessor`1 をイベント TranslationStatusChangedEvent に登録しました (現在の登録数: 1)
info: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ InlineEventProcessor`1 をイベント TranslationStatusChangedEvent に登録しました
? プロセッサ InlineEventProcessor`1 をイベント TranslationDisplayVisibilityChangedEvent に登録しました (現在の登録数: 1)
info: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ InlineEventProcessor`1 をイベント TranslationDisplayVisibilityChangedEvent に登録しました
? MainOverlayViewModel取得成功: MainOverlayViewModel
??? MainOverlayView作成開始
info: Baketa.UI.App[0]
      ? MainOverlayViewModel取得成功: MainOverlayViewModel
?? MainOverlayView初期化開始
?? MainOverlayView - InitializeComponent完了
?? MainOverlayView - IsVisible: False
?? MainOverlayView - WindowState: Normal
??? MainOverlayView作成完了 - DataContext設定済み
??? desktop.MainWindowに設定完了
? MainOverlayView.Show()実行完了
?? InPlaceTranslationOverlayManager初期化設定
? InPlaceTranslationOverlayManager遅延初期化設定完了
??? 旧オーバーレイシステムは削除済み - インプレースシステムが自動で管理
?? TranslationFlowModuleのイベント購読を初期化中
info: Baketa.UI.App[0]
      ?? TranslationFlowModuleのイベント購読を初期化中
?? TranslationFlowModuleインスタンス作成完了
info: Baketa.UI.App[0]
      ?? TranslationFlowModuleインスタンス作成完了
?? InPlaceTranslationOverlayManager非同期初期化開始
?? TranslationFlowModuleの初期化を開始
?? InPlaceTranslationOverlayManager.InitializeAsync開始 - _isInitialized: False, _disposed: False
?? インプレースオーバーレイマネージャー初期化ロック取得、実際の初期化を開始
?? インプレースオーバーレイマネージャー初期化完了フラグ設定
?? InPlaceTranslationOverlayManager.InitializeAsync正常完了
dbug: Baketa.UI.Services.InPlaceTranslationOverlayManager[0]
      Starting InPlace overlay manager initialization
? InPlaceTranslationOverlayManager初期化完了
info: Baketa.UI.Services.InPlaceTranslationOverlayManager[0]
      InPlace translation overlay manager initialized successfully
?? TranslationFlowEventProcessorを取得中
dbug: Baketa.UI.DI.Modules.TranslationFlowModule[0]
      ?? TranslationFlowModuleの初期化を開始
dbug: Baketa.UI.DI.Modules.TranslationFlowModule[0]
      ?? TranslationFlowEventProcessorを取得中
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      AdaptiveCaptureService インスタンス作成
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      AdaptiveCaptureService 登録完了
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      AdaptiveCaptureServiceAdapter インスタンス作成
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      AdaptiveCaptureServiceAdapter 登録完了
info: Baketa.Application.DI.Modules.CaptureModule[0]
      ICaptureService として AdaptiveCaptureServiceAdapter を登録
?? [DI_DEBUG] TranslationOrchestrationService Factory開始
dbug: Baketa.Core.Settings.Migration.SettingsMigrationManager[0]
      マイグレーションを登録しました: 0→1 (ホットキー機能削除とMainUI設定追加（UX改善対応）)
dbug: Baketa.Core.Settings.Migration.SettingsMigrationManager[0]
      デフォルトマイグレーションを登録しました
info: Baketa.Core.Translation.Factories.DefaultTranslationEngineFactory[0]
      合計 0 個の翻訳エンジンが利用可能です
info: Baketa.Application.Services.Translation.TranslationDictionaryService[0]
      ?? TranslationDictionaryService初期化完了 - 設定ファイルベース翻訳開始
?? [DI_DEBUG] TranslationOrchestrationService - CoordinateBasedTranslationServiceを正しく注入
?? [DI_DEBUG] CoordinateBasedTranslationService Factory開始 (Phase 2.1更新版)
?? [DI_DEBUG] ITranslationProcessingFacade取得中...
? [DI_DEBUG] ITranslationProcessingFacade取得成功: TranslationProcessingFacade
?? [DI_DEBUG] IConfigurationFacade取得中...
? [DI_DEBUG] IConfigurationFacade取得成功: ConfigurationFacade
?? [DI_DEBUG] IStreamingTranslationService取得中...
?? [STREAMING] StreamingTranslationService初期化完了
? [DI_DEBUG] IStreamingTranslationService取得成功: StreamingTranslationService
?? [DI_DEBUG] CoordinateBasedTranslationService インスタンス作成開始 (Service Locator除去済み)
info: Baketa.Application.Services.Translation.StreamingTranslationService[0]
      StreamingTranslationService初期化完了
?? [STREAMING] ストリーミング翻訳サービスが利用可能
info: Baketa.Infrastructure.Logging.BaketaLogger[0]
      CoordinateBasedTranslationService: 統一設定サービス注入完了
? [DI_DEBUG] CoordinateBasedTranslationService インスタンス作成完了 (Phase 2.1)
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? CoordinateBasedTranslationService initialized - Hash: 44346036
? [DI_DEBUG] CoordinateBasedTranslationService取得成功: CoordinateBasedTranslationService
? [DI_DEBUG] EventAggregator取得成功: EventAggregator
? [DI_DEBUG] TranslationDictionaryService取得成功: TranslationDictionaryService
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:AutomaticTranslationIntervalMs' が見つからないか型が一致しません。デフォルト値を返します: 100
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      キャプチャオプション設定: 間隔=100ms, 品質=85
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      キャプチャオプションを初期化しました: 間隔=100ms, 品質=85
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳システムが利用可能です - 座標ベース翻訳表示が有効
dbug: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      TranslationFlowEventProcessor instance created: Hash=63570006
? TranslationFlowEventProcessor取得成功: ハッシュ=63570006
?? イベント購読を開始
dbug: Baketa.UI.DI.Modules.TranslationFlowModule[0]
      ? TranslationFlowEventProcessor取得成功
dbug: Baketa.UI.DI.Modules.TranslationFlowModule[0]
      ?? イベント購読を開始
? プロセッサ TranslationFlowEventProcessor をイベント StartTranslationRequestEvent に登録しました (現在の登録数: 1)
? StartTranslationRequestEvent購読完了
info: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ TranslationFlowEventProcessor をイベント StartTranslationRequestEvent に登録しました
dbug: Baketa.UI.DI.Modules.TranslationFlowModule[0]
      ? StartTranslationRequestEvent購読完了
? プロセッサ TranslationFlowEventProcessor をイベント StopTranslationRequestEvent に登録しました (現在の登録数: 1)
? StopTranslationRequestEvent購読完了
info: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ TranslationFlowEventProcessor をイベント StopTranslationRequestEvent に登録しました
dbug: Baketa.UI.DI.Modules.TranslationFlowModule[0]
      ? StopTranslationRequestEvent購読完了
? プロセッサ TranslationFlowEventProcessor をイベント ToggleTranslationDisplayRequestEvent に登録しました (現在の登録数: 1)
? ToggleTranslationDisplayRequestEvent購読完了
info: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ TranslationFlowEventProcessor をイベント ToggleTranslationDisplayRequestEvent に登録しました
dbug: Baketa.UI.DI.Modules.TranslationFlowModule[0]
      ? ToggleTranslationDisplayRequestEvent購読完了
? プロセッサ TranslationFlowEventProcessor をイベント SettingsChangedEvent に登録しました (現在の登録数: 1)
? SettingsChangedEvent購読完了
info: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ TranslationFlowEventProcessor をイベント SettingsChangedEvent に登録しました
dbug: Baketa.UI.DI.Modules.TranslationFlowModule[0]
      ? SettingsChangedEvent購読完了
? プロセッサ InPlaceTranslationOverlayManager をイベント OverlayUpdateEvent に登録しました (現在の登録数: 1)
? OverlayUpdateEvent購読完了
info: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ InPlaceTranslationOverlayManager をイベント OverlayUpdateEvent に登録しました
?? 翻訳フローイベントプロセッサーを正常に登録しました
dbug: Baketa.UI.DI.Modules.TranslationFlowModule[0]
      ? OverlayUpdateEvent購読完了
? TranslationFlowModule初期化完了
info: Baketa.UI.DI.Modules.TranslationFlowModule[0]
      ?? 翻訳フローイベントプロセッサーを正常に登録しました
?? PythonServerHealthMonitor直接開始開始
info: Baketa.UI.App[0]
      ? TranslationFlowModule初期化完了
?? PythonServerHealthMonitor直接開始要求完了
?? イベント発行: ApplicationStartupEvent (ID: e8244ad1-e3a2-49c8-9857-e166188d4830)
?? イベント ApplicationStartupEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: ApplicationStartupEvent (ID: e8244ad1-e3a2-49c8-9857-e166188d4830)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント ApplicationStartupEvent のプロセッサが登録されていません
info: Baketa.UI.App[2]
      アプリケーション起動完了
info: Baketa.Infrastructure.Patterns.TranslationCircuitBreaker[0]
      TranslationCircuitBreaker初期化完了 - FailureThreshold: 5, Timeout: 30000ms
?? [HEALTH_MONITOR] コンストラクタ開始
?? [HEALTH_MONITOR] settingsService パラメータ: EnhancedSettingsService
?? [PHASE2] サーキットブレーカー連携: 有効
? [HEALTH_MONITOR] コンストラクタ完了 - 設定は StartAsync で取得
? [HEALTH_MONITOR] PythonServerHealthMonitor取得成功
info: Baketa.Infrastructure.Translation.Services.PythonServerHealthMonitor[0]
      ? PythonServerHealthMonitor開始
?? [HEALTH_MONITOR] 取得した設定: EnableServerAutoRestart=True
?? [HEALTH_MONITOR] HealthCheckIntervalMs: 30000ms
? [HEALTH_MONITOR] ヘルスチェック有効 - 自動監視開始
?? [HEALTH_MONITOR] PythonServerHealthMonitor開始完了
info: Baketa.Infrastructure.Translation.Services.PythonServerHealthMonitor[0]
      ?? ヘルスチェック開始 - 間隔: 30000ms
?? MainOverlayView - OnLoaded呼び出し
?? MainOverlayView - OnLoaded後: IsVisible=True, IsEnabled=True
?? MainOverlayView - Position: 16, 350, Width: 70, Height: 430
?? MainOverlayView - Show()とActivate()を実行
info: Baketa.Core.Services.EnhancedSettingsService[0]
      設定を再読み込みしました: C:\Users\suke0\AppData\Roaming\Baketa\settings.json
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      外部Pythonサーバー使用モード - プロセス起動をスキップ
dbug: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      既存接続を再利用: e62a7611
dbug: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      接続をプールに返却: e62a7611
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      接続プール経由でサーバー接続を確認
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      OptimizedPythonTranslationEngine初期化完了
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      ?? モデルロード完了 - 翻訳リクエスト受付開始
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      バックグラウンド初期化完了
?? [DIAGNOSTIC_COLLECTION] GenerateReportAsync開始 - reportType: direct_init_test, IsCollecting: True
?? [DIAGNOSTIC_COLLECTION] ExtractAllEvents呼び出し前 - キューサイズ: 0
?? [DIAGNOSTIC_COLLECTION] ExtractAllEvents完了 - 取得イベント数: 0
?? [DIAGNOSTIC_COLLECTION] 警告: 生成する診断イベントがありません
?? 手動レポート生成完了（直接初期化版）: 
warn: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      生成する診断イベントがありません
info: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      ウィンドウ選択処理開始
?? イベント発行: PipelineDiagnosticEvent (ID: d779133b-92b1-4c02-b8ae-d0947a9af661)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: d779133b-92b1-4c02-b8ae-d0947a9af661)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ApplicationStartup - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ApplicationStartup, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ApplicationStartup
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ApplicationStartup, 現在キューサイズ: 0
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 1
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ApplicationStartup
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ApplicationStartup
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 2.5294ms)
?? 診断テストイベント発行完了
?? [診断レポート] 2秒待機開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      ウィンドウが選択されました: 'famires.png' (Handle=265286)
info: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      ウィンドウ選択処理完了
?? [診断レポート] 2秒待機完了 - サービス取得開始
?? [診断レポート] IDiagnosticCollectionService取得試行中...
? [診断レポート] IDiagnosticCollectionService取得成功: DiagnosticCollectionService
?? 手動レポート生成テスト開始
?? [DIAGNOSTIC_COLLECTION] GenerateReportAsync開始 - reportType: manual_test, IsCollecting: True
?? [DIAGNOSTIC_COLLECTION] ExtractAllEvents呼び出し前 - キューサイズ: 1
?? [DIAGNOSTIC_COLLECTION] ExtractAllEvents完了 - 取得イベント数: 1
?? [DIAGNOSTIC] レポート生成開始: reportType='manual_test'
?? [DIAGNOSTIC] レポートディレクトリチェック開始: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports'
? [DIAGNOSTIC] ディレクトリは既に存在
?? [DIAGNOSTIC] イベント数: 1
?? [DIAGNOSTIC] 生成ファイルパス: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports\manual_test_20250827_001656_manual_t.json'
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? ROI画像情報統合完了: 既存=0個, TileStrategy=0個, 合計=0個
?? [DIAGNOSTIC] ROI画像情報統合: 0個
?? [DEBUG] SafeFileWriter呼び出し前 - filePath: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports\manual_test_20250827_001656_manual_t.json'
?? [DEBUG] SafeFileWriter呼び出し前 - jsonContent.Length: 959
?? [DEBUG] SafeFileWriter呼び出し前 - jsonContent IsNullOrEmpty: False
?? [DEBUG] SafeFileWriter呼び出し前 - filePath IsNullOrEmpty: False
?? [DEBUG] SafeFileWriter.AppendTextSafely実行中...
?? [DEBUG] SafeFileWriter.AppendTextSafely完了
?? [DEBUG] ファイル存在確認: True
?? [DEBUG] ファイルサイズ: 962 bytes
info: Baketa.Infrastructure.Services.DiagnosticReportGenerator[0]
      診断レポート生成完了: C:\Users\suke0\AppData\Roaming\Baketa\Reports\manual_test_20250827_001656_manual_t.json, イベント数: 1
?? イベント発行: DiagnosticReportGeneratedEvent (ID: ad6b27c3-f1df-4bab-9fbc-77dd9cfe2ea4)
?? イベント DiagnosticReportGeneratedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: DiagnosticReportGeneratedEvent (ID: ad6b27c3-f1df-4bab-9fbc-77dd9cfe2ea4)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント DiagnosticReportGeneratedEvent のプロセッサが登録されていません
?? 手動レポート生成完了: C:\Users\suke0\AppData\Roaming\Baketa\Reports\manual_test_20250827_001656_manual_t.json
?? [診断レポート] Reports ディレクトリ内ファイル数: 567
?? [診断レポート] ファイル: direct_init_test_20250822_191106_direct_i.json
?? [診断レポート] ファイル: direct_init_test_20250822_191739_direct_i.json
?? [診断レポート] ファイル: direct_init_test_20250823_011044_direct_i.json
?????? ExecuteStartStopAsync メソッドが呼び出されました！??????
?? ExecuteStartStopAsync開始 - IsTranslationActive=False, IsLoading=False
?? 診断レポート生成開始（ExecuteStartStopAsync Start操作時）
?? [DIAGNOSTIC_COLLECTION] GenerateReportAsync開始 - reportType: execute_start_button_pressed, IsCollecting: True
?? [DIAGNOSTIC_COLLECTION] ExtractAllEvents呼び出し前 - キューサイズ: 0
?? [DIAGNOSTIC_COLLECTION] ExtractAllEvents完了 - 取得イベント数: 0
?? [DIAGNOSTIC_COLLECTION] 警告: 生成する診断イベントがありません
warn: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      生成する診断イベントがありません
?? 診断レポート生成：蓄積されたデータがありません
warn: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      診断レポート生成：蓄積されたデータなし
info: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      ?? 翻訳ワークフローを開始
?? [DIAGNOSTIC_COLLECTION] GenerateReportAsync開始 - reportType: start_button_pressed, IsCollecting: True
?? [DIAGNOSTIC_COLLECTION] ExtractAllEvents呼び出し前 - キューサイズ: 0
?? [DIAGNOSTIC_COLLECTION] ExtractAllEvents完了 - 取得イベント数: 0
?? [DIAGNOSTIC_COLLECTION] 警告: 生成する診断イベントがありません
warn: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      生成する診断イベントがありません
?? 診断レポート生成：蓄積されたデータがありません
warn: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      診断レポート生成：蓄積されたデータなし
info: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      選択済みウィンドウを使用: 'famires.png' (Handle=265286)
?? LoadingOverlayManager.ShowAsync開始
?? LoadingOverlayView初期化開始
? LoadingOverlayView初期化完了
? ローディングオーバーレイ表示完了
dbug: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      ?? 翻訳状態をキャプチャ中に設定
?? LoadingOverlayManager.HideAsync開始
? ローディングオーバーレイ非表示完了
dbug: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      ??? オーバーレイマネージャーを初期化
?? InPlaceTranslationOverlayManager.InitializeAsync開始 - _isInitialized: True, _disposed: False
?? インプレースオーバーレイマネージャー初期化スキップ (initialized: True, disposed: False)
dbug: Baketa.UI.Services.InPlaceTranslationOverlayManager[0]
      InPlace overlay manager initialization skipped (initialized: True, disposed: False)
dbug: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      ?? StartTranslationRequestEventを発行
?? ViewModelBase.PublishEventAsync開始: StartTranslationRequestEvent (ID: d8075c2c-e958-4e34-b786-3c42ea5c3f60)
?? イベント発行: StartTranslationRequestEvent (ID: d8075c2c-e958-4e34-b786-3c42ea5c3f60)
?? イベント StartTranslationRequestEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: StartTranslationRequestEvent (ID: d8075c2c-e958-4e34-b786-3c42ea5c3f60)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント StartTranslationRequestEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = TranslationFlowEventProcessor
?? デバッグ: TranslationFlowEventProcessor は IEventProcessor<StartTranslationRequestEvent> か? = True
?? デバッグ: TranslationFlowEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: TranslationFlowEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: TranslationFlowEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: TranslationFlowEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: TranslationFlowEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: TranslationFlowEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: TranslationFlowEventProcessor が実装するインターフェース: IDisposable
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: TranslationFlowEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ TranslationFlowEventProcessor でイベント StartTranslationRequestEvent の処理を開始
?? ExecuteProcessorAsync内でHandleAsync呼び出し: TranslationFlowEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ TranslationFlowEventProcessor.HandleAsync() を実行中
?? TranslationFlowEventProcessor.HandleAsync開始: d8075c2c-e958-4e34-b786-3c42ea5c3f60
?? ターゲットウィンドウ: famires.png (Handle=265286)
?? 現在の購読状態: null
info: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      ?? HandleAsync(StartTranslationRequestEvent) 呼び出し開始: d8075c2c-e958-4e34-b786-3c42ea5c3f60
info: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      ?? ターゲットウィンドウ: famires.png (Handle=265286)
info: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      ?? 重複チェック: 現在処理中のウィンドウ数=0
info: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      ? ウィンドウを処理中リストに追加: 265286
info: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      Processing translation start request for window: famires.png (Handle=265286)
dbug: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      Changing translation status to capturing
?? イベント発行: TranslationStatusChangedEvent (ID: 76866c4e-f785-4b66-91d6-8eac10e90cbb)
?? イベント TranslationStatusChangedEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: TranslationStatusChangedEvent (ID: 76866c4e-f785-4b66-91d6-8eac10e90cbb)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント TranslationStatusChangedEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = InlineEventProcessor`1
?? デバッグ: InlineEventProcessor`1 は IEventProcessor<TranslationStatusChangedEvent> か? = True
?? デバッグ: InlineEventProcessor`1 が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: InlineEventProcessor`1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ InlineEventProcessor`1 でイベント TranslationStatusChangedEvent の処理を開始
?? ExecuteProcessorAsync内でHandleAsync呼び出し: InlineEventProcessor`1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ InlineEventProcessor`1.HandleAsync() を実行中
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント TranslationStatusChangedEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
info: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      ?? 翻訳状態変更: Capturing -> Capturing
dbug: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      ?? UI状態更新: IsTranslationActive=True, StartStopText='Stop', StatusClass='active'
? ExecuteProcessorAsync内でHandleAsync完了: InlineEventProcessor`1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ InlineEventProcessor`1 がイベント TranslationStatusChangedEvent を処理しました (処理時間: 3.202ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント TranslationStatusChangedEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      Clearing existing in-place overlays to prevent overlap
?? すべてのインプレースオーバーレイを非表示開始
?? [STOP_DEBUG] 非表示対象オーバーレイ数: 0
?? [STOP_DEBUG] アクティブオーバーレイが存在しません - Stop処理スキップ
dbug: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      Successfully cleared existing in-place overlays
dbug: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      Starting translation process
info: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      Starting continuous translation process for window: famires.png (Handle=265286)
dbug: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      Changing translation status to translating
?? イベント発行: TranslationStatusChangedEvent (ID: 34cb1f76-8af0-4a9e-87af-baf77c428e04)
?? イベント TranslationStatusChangedEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: TranslationStatusChangedEvent (ID: 34cb1f76-8af0-4a9e-87af-baf77c428e04)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント TranslationStatusChangedEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = InlineEventProcessor`1
?? デバッグ: InlineEventProcessor`1 は IEventProcessor<TranslationStatusChangedEvent> か? = True
?? デバッグ: InlineEventProcessor`1 が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: InlineEventProcessor`1
?? ExecuteProcessorAsync内でHandleAsync呼び出し: InlineEventProcessor`1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ InlineEventProcessor`1 でイベント TranslationStatusChangedEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ InlineEventProcessor`1.HandleAsync() を実行中
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント TranslationStatusChangedEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
info: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      ?? 翻訳状態変更: Capturing -> Translating
? ExecuteProcessorAsync内でHandleAsync完了: InlineEventProcessor`1
dbug: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      ?? UI状態更新: IsTranslationActive=True, StartStopText='Stop', StatusClass='active'
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ InlineEventProcessor`1 がイベント TranslationStatusChangedEvent を処理しました (処理時間: 2.1417ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント TranslationStatusChangedEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      Setting up translation result subscription for continuous translation
dbug: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      Starting continuous automatic translation
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? [DIRECT] StartAutomaticTranslationAsync開始 - Hash=32370540
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? [DEBUG] 開始前OCRエンジン状態: IsInitialized=True
?? StartAutomaticTranslationAsync呼び出し - this=Baketa.Application.Services.Translation.TranslationOrchestrationService@32370540
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? [DEBUG] tryブロック開始
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? [DEBUG] Disposedチェック前 - _disposed=False
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? [DEBUG] Disposedチェック後
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? [DEBUG] アクティブチェック前 - IsActive=False
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? [DEBUG] tryブロック終了直前
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? [DEBUG] 自動翻訳開始直前
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 自動翻訳を開始します（直接書き込み）
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? [DEBUG] DebugLogUtility.WriteLog後
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      自動翻訳を開始します
?? ExecuteAutomaticTranslationLoopAsync開始
   ?? 開始時キャンセル要求: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:AutomaticTranslationIntervalMs' が見つからないか型が一致しません。デフォルト値を返します: 100
?? 自動翻訳ループを開始しました（間隔: 500ms）
warn: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      自動翻訳間隔が短すぎるため、500msに調整しました
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      自動翻訳ループを開始しました（間隔: 500ms）
info: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      ? Continuous translation started successfully for window: famires.png
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
info: Baketa.UI.Services.TranslationFlowEventProcessor[0]
      ? 翻訳開始処理が完了しました
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      GPU環境検出開始
? ExecuteProcessorAsync内でHandleAsync完了: TranslationFlowEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ TranslationFlowEventProcessor がイベント StartTranslationRequestEvent を処理しました (処理時間: 75.8261ms)
? ViewModelBase.PublishEventAsync呼び出し完了: StartTranslationRequestEvent
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント StartTranslationRequestEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント StartTranslationRequestEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Infrastructure.Platform.Windows.GPU.GPUEnvironmentDetector[0]
      GPU環境検出を開始
dbug: Baketa.Infrastructure.Platform.Windows.GPU.GPUEnvironmentDetector[0]
      GPU種別判定開始: 検出されたGPU
warn: Baketa.Infrastructure.Platform.Windows.GPU.GPUEnvironmentDetector[0]
      未知のGPU: 検出されたGPU - フォールバック設定により専用GPUとして処理
info: Baketa.Infrastructure.Platform.Windows.GPU.GPUEnvironmentDetector[0]
      GPU環境検出完了: GPU=検出されたGPU, 統合=False, 専用=True
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      GPU環境検出完了: 検出されたGPU (統合=False, 専用=True)
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
info: Baketa.UI.ViewModels.MainOverlayViewModel[0]
      ?? 翻訳が正常に開始されました: 'famires.png' - 総処理時間: 215ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Core.Abstractions.Platform.Windows.IWindowsCapturer[0]
      Windows Graphics Capture APIをサポート、WindowsGraphicsCapturerを使用
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: 74134658-95b1-48de-931c-8ddf80117119)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 74134658-95b1-48de-931c-8ddf80117119)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 0
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 1
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0896ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      Windows Graphics Captureの初期化開始
info: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      ネイティブ Windows Graphics Capture インスタンス初期化 (ActiveInstances=1)
info: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      Windows Graphics Captureが正常に初期化されました
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=9, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534046473431
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=178ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=222ms
?? イベント発行: PipelineDiagnosticEvent (ID: d7ecc0f1-fad7-4fc6-b64d-7e43b626cad5)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: d7ecc0f1-fad7-4fc6-b64d-7e43b626cad5)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 1
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 2
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0323ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=269.0359ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: 413de885-8de5-4aec-bdef-47ee2a3a14f5)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: 413de885-8de5-4aec-bdef-47ee2a3a14f5)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=269.0359ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=8b3b81d2, Mode=Automatic
[00:16:57.151] ?? START [OverallProcessing_0002_001657_151] OverallProcessing: 翻訳実行全体 - ID:8b3b81d2, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=8b3b81d2
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:16:57.198] ?? START [BatchOcrProcessing_0003_001657_198] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:16:57.201
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:16:57.213] ?? START [ImageTileGeneration_0004_001657_213] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: プール用エンジンインスタンス作成開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: 新しいエンジンインスタンス作成開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Models.DefaultModelPathResolver[0]
      DefaultModelPathResolver initialized with base directory: E:\dev\Baketa\Baketa.UI\bin\Debug\net8.0-windows10.0.19041.0\models
info: Baketa.Infrastructure.Memory.Pools.AdvancedImagePool[0]
      ???♂? AdvancedImagePool initialized with capacity: 50
info: Baketa.Infrastructure.OCR.PostProcessing.HybridOcrPostProcessorFactory[0]
      ハイブリッドOCR後処理プロセッサを作成中
info: Baketa.Infrastructure.OCR.PostProcessing.HybridOcrPostProcessorFactory[0]
      ハイブリッドOCR後処理プロセッサ作成完了
info: Baketa.Infrastructure.Performance.GpuMemoryManager[0]
      ?? GpuMemoryManager initialized
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? プール化環境でのエンジン選択 - 環境変数: 'null', 強制本番: False
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? 実際のPaddleOCRエンジン作成（プール化対応）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジン初期化開始 - 型: NonSingletonPaddleOcrEngine
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOCR initialization bottleneck analysis started.
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? Step 1: Instance tracking finished in 0ms.
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? Step 2: Settings validation finished in 0ms.
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      PaddleOCRエンジンの初期化開始 - 言語: jpn, GPU: False, マルチスレッド: False
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? Step 3: Settings preparation finished in 0ms.
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ネイティブライブラリのチェック成功 - OpenCvSharp4 v4.10+ (Size: 1x1)
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? Step 4: Native library check finished in 551ms.
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? UltraThink: PaddleOCRモデル段階的検証開始 - 言語: jpn
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? Phase 1: EnglishV3モデルでの安全性検証
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? EnglishV3モデル取得成功 - 基本的なPaddleOCR動作確認済み
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? Phase 2: 言語別最適モデル選択
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 選択モデル確定: jpn → FullOcrModel
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? Step 5: Model preparation finished in 1890ms.
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 【テスト中】PaddleOCR最適化パラメーターを一時的に無効化 - デフォルト設定で実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? Step 6: Engine initialization finished in 12238ms.
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードで初期化 - ハイブリッドモード無効
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      PaddleOCRエンジンの初期化完了
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? Step 7: Finalization finished in 1ms.
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOCR initialization bottleneck analysis completed. Total time: 14683ms.
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジン作成・初期化完了 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジンインスタンス作成完了 - Hash: 12162820, 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [IMAGE_RESIZE_OPT] 大画像検出（最適化） - 高速リサイズ実行: 1906x782=1,490,492 > 800,000制限
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? [IMAGE_RESIZE_OPT] 高速リサイズ完了: 1396x572=798,512ピクセル (縮小率: 0.733)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [OCR_ENGINE_OPT] PaddleOCR.Run実行開始（最適化）...
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? [OCR_ENGINE_OPT] PaddleOCR.Run成功完了（最適化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR.Run()完了（最適化） - 結果取得完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? OCR処理正常完了（最適化） - Task.WhenAny版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用結果の変換開始: Sdcb.PaddleOCR.PaddleOcrResult
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 単一PaddleOcrResultとして処理
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用結果処理開始: Result 1
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? Regionsプロパティ発見: 件数=17
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用結果変換完了: 0個のテキスト領域
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? テキスト検出専用処理完了 - 検出領域数: 0, 処理時間: 1060ms
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 効率的検出専用処理完了 - 処理時間: 1063.4976ms, 結果数: 0
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 17ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:13.451] ? COMPLETE [ImageTileGeneration_0004_001657_213] Duration: 16237.6ms, Memory: -1,912KB
? PERFORMANCE ALERT: ImageTileGeneration took 16.24 seconds
?? [STAGE-2] タイル分割完了 - 16237.6ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:13.461] ?? START [OcrEngineExecution_0005_001713_461] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: iFFHLjhX1DZN - 時間: 8ms, サイズ: 242677bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:1] 画像ハッシュ生成: iFFHLjhX1DZN - 時間: 43ms, サイズ: 242677bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: iFFHLjhX1DZN
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:1] キャッシュミス - OCR処理開始: iFFHLjhX1DZN
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: c4b21ee5-0c60-465f-b716-1b74d78d4739)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: c4b21ee5-0c60-465f-b716-1b74d78d4739)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 2
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 3
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0626ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 52秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [IMAGE_RESIZE] 大画像検出 - リサイズ実行: 1906x782=1,490,492 > 1,000,000制限
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? [IMAGE_RESIZE] リサイズ完了: 1561x640=999,040ピクセル (縮小率: 0.819)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] Mat Properties: 1561x640, Channels=3, Type=CV_8UC3, Continuous=True
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] Memory Layout: Step=4683, ElemSize=3
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? [MAT_VALIDATION] Mat validation passed: 1561x640, 3ch, CV_8UC3
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [OCR_ENGINE] PaddleOCR.Run実行前状態: Size=1561x640, Type=CV_8UC3, Channels=3, IsContinuous=True
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [OCR_ENGINE] PaddleOCR.Run実行開始...
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_FAILED] Error: PaddlePredictor(Detector) run failed., Exception Type: Exception, Consecutive Failures: 1, Mat Size: 1561x640, Mat Channels: 3, Mat Type: CV_8UC3, Mat Empty: False, Mat Continuous: True, Mat Total Pixels: 999040, Is V4 Model: False, Last OCR Time: 2025/08/26 15:17:13, Consecutive Timeouts: 0, Memory Usage: 12.0 MB, Stack Trace: at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize) -> at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src) -> at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
      System.Exception: PaddlePredictor(Detector) run failed.
         at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize)
         at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src)
         at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__1() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3654
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3677
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_DEBUG] Mat Info: 1561x640, Channels=3, Type=CV_8UC3, Empty=False, Continuous=True
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_SUGGESTION] 検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 1回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
       ---> System.Exception: PaddlePredictor(Detector) run failed.
         at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize)
         at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src)
         at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__1() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3654
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3677
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3724
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      PaddleOCRエンジンでエラーが発生しました。リソースをクリアして再試行します
      System.InvalidOperationException: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 1回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
       ---> System.Exception: PaddlePredictor(Detector) run failed.
         at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize)
         at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src)
         at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__1() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3654
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3677
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3724
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 52秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [IMAGE_RESIZE] 大画像検出 - リサイズ実行: 1906x782=1,490,492 > 1,000,000制限
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? [IMAGE_RESIZE] リサイズ完了: 1561x640=999,040ピクセル (縮小率: 0.819)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] Mat Properties: 1561x640, Channels=3, Type=CV_8UC3, Continuous=True
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] Memory Layout: Step=4683, ElemSize=3
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? [MAT_VALIDATION] Mat validation passed: 1561x640, 3ch, CV_8UC3
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [OCR_ENGINE] PaddleOCR.Run実行前状態: Size=1561x640, Type=CV_8UC3, Channels=3, IsContinuous=True
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [OCR_ENGINE] PaddleOCR.Run実行開始...
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_FAILED] Error: PaddlePredictor(Detector) run failed., Exception Type: Exception, Consecutive Failures: 2, Mat Size: 1561x640, Mat Channels: 3, Mat Type: CV_8UC3, Mat Empty: False, Mat Continuous: True, Mat Total Pixels: 999040, Is V4 Model: False, Last OCR Time: 2025/08/26 15:17:13, Consecutive Timeouts: 0, Memory Usage: 12.0 MB, Stack Trace: at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize) -> at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src) -> at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
      System.Exception: PaddlePredictor(Detector) run failed.
         at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize)
         at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src)
         at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__1() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3654
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3677
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_DEBUG] Mat Info: 1561x640, Channels=3, Type=CV_8UC3, Empty=False, Continuous=True
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_SUGGESTION] 検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 2回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
       ---> System.Exception: PaddlePredictor(Detector) run failed.
         at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize)
         at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src)
         at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__1() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3654
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3677
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3724
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: bef7cf94-d888-478f-b14f-3460d569e879)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: bef7cf94-d888-478f-b14f-3460d569e879)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 3
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 4
?? [DIAGNOSTIC] [Error] OCR: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 2回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 2回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.1153ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 2回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
       ---> System.Exception: PaddlePredictor(Detector) run failed.
         at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize)
         at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src)
         at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__1() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3654
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3677
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3724
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1902
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 2回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
       ---> System.InvalidOperationException: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 2回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
       ---> System.Exception: PaddlePredictor(Detector) run failed.
         at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize)
         at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src)
         at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__1() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3654
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3677
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3724
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1902
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:1] CachedOcrEngine処理エラー - 総時間: 916ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 2回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
       ---> System.InvalidOperationException: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 2回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
       ---> System.Exception: PaddlePredictor(Detector) run failed.
         at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize)
         at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src)
         at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__1() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3654
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3677
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3724
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1902
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 2回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 2回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
       ---> System.InvalidOperationException: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 2回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
       ---> System.Exception: PaddlePredictor(Detector) run failed.
         at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize)
         at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src)
         at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__1() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3654
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3677
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3724
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1902
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:14.386] ? COMPLETE [OcrEngineExecution_0005_001713_461] Duration: 924.4ms, Memory: +4,642KB
?? [STAGE-3] 並列OCR完了 - 932ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:14.388] ?? START [OcrPostProcessing_0006_001714_388] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:14.391] ? COMPLETE [OcrPostProcessing_0006_001714_388] Duration: 3.1ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 4ms (詳細:3.1ms), 結果領域数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? メモリ解放実行中...
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 5ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 5ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 17213ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 17213ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 931ms (5.4%)
  ? ResultMerge: 1ms (0.0%)
  ? TextGrouping: 2ms (0.0%)
  ? ConfidenceReprocessing: 2ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 17213ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 17233.58ms
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 17233.5788ms, 成功: True
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 17233.5788ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:14.448] ? COMPLETE [BatchOcrProcessing_0003_001657_198] Duration: 17250.1ms, Memory: -2,475KB, Info: WindowHandle:0x40C46
? PERFORMANCE ALERT: BatchOcrProcessing took 17.25 seconds
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 17250.0517ms
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=8b3b81d2
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:14.489] ? COMPLETE [OverallProcessing_0002_001657_151] Duration: 17338.0ms, Memory: -2,435KB, Info: ImageType:WindowsImageAdapter
? PERFORMANCE ALERT: OverallProcessing took 17.34 seconds
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: bc77faab-107f-4e5f-83f8-5c553739be8f)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: bc77faab-107f-4e5f-83f8-5c553739be8f)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 4
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 5
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0444ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=10, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534251874929
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=137ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=138ms
?? イベント発行: PipelineDiagnosticEvent (ID: 5bc0cbc3-5eec-4dba-a291-1cd465850aef)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 5bc0cbc3-5eec-4dba-a291-1cd465850aef)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 5
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 6
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.042ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=141.7675ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: b28c044c-bfe4-43a8-b121-3c01fa9c952b)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: b28c044c-bfe4-43a8-b121-3c01fa9c952b)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=141.7675ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=72f6ca3a, Mode=Automatic
[00:17:17.684] ?? START [OverallProcessing_0007_001717_684] OverallProcessing: 翻訳実行全体 - ID:72f6ca3a, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=72f6ca3a
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:17:17.707] ?? START [BatchOcrProcessing_0008_001717_707] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:17:17.709
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:17:17.717] ?? START [ImageTileGeneration_0009_001717_717] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 2）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 2）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 2）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 52秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [IMAGE_RESIZE] 大画像検出 - リサイズ実行: 1906x782=1,490,492 > 1,000,000制限
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? [IMAGE_RESIZE] リサイズ完了: 1561x640=999,040ピクセル (縮小率: 0.819)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] Mat Properties: 1561x640, Channels=3, Type=CV_8UC3, Continuous=True
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] Memory Layout: Step=4683, ElemSize=3
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? [MAT_VALIDATION] Mat validation passed: 1561x640, 3ch, CV_8UC3
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [OCR_ENGINE] PaddleOCR.Run実行前状態: Size=1561x640, Type=CV_8UC3, Channels=3, IsContinuous=True
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [OCR_ENGINE] PaddleOCR.Run実行開始...
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_FAILED] Error: PaddlePredictor(Detector) run failed., Exception Type: Exception, Consecutive Failures: 3, Mat Size: 1561x640, Mat Channels: 3, Mat Type: CV_8UC3, Mat Empty: False, Mat Continuous: True, Mat Total Pixels: 999040, Is V4 Model: False, Last OCR Time: 2025/08/26 15:17:13, Consecutive Timeouts: 0, Memory Usage: 12.0 MB, Stack Trace: at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize) -> at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src) -> at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
      System.Exception: PaddlePredictor(Detector) run failed.
         at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize)
         at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src)
         at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__1() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3654
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3677
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_DEBUG] Mat Info: 1561x640, Channels=3, Type=CV_8UC3, Empty=False, Continuous=True
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_SUGGESTION] 検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 3回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
       ---> System.Exception: PaddlePredictor(Detector) run failed.
         at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize)
         at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src)
         at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__1() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3654
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3677
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3724
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddlePredictor実行失敗: PaddlePredictor(Detector) run failed.。連続失敗: 3回。検出器エラー: 画像の前処理またはサイズ調整が必要。画像品質またはPaddleOCRモデルの確認を推奨
       ---> System.Exception: PaddlePredictor(Detector) run failed.
         at Sdcb.PaddleOCR.PaddleOcrDetector.RunRawCore(Mat src, Size& resizedSize)
         at Sdcb.PaddleOCR.PaddleOcrDetector.Run(Mat src)
         at Sdcb.PaddleOCR.PaddleOcrAll.Run(Mat src, Int32 recognizeBatchSize)
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__1() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3654
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3677
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3724
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 52秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 7ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:17.969] ? COMPLETE [ImageTileGeneration_0009_001717_717] Duration: 251.5ms, Memory: -36KB
?? [STAGE-2] タイル分割完了 - 251.5ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:17.972] ?? START [OcrEngineExecution_0010_001717_972] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: MAOf6MtYMx3b - 時間: 0ms, サイズ: 242431bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:2] 画像ハッシュ生成: MAOf6MtYMx3b - 時間: 24ms, サイズ: 242431bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: MAOf6MtYMx3b
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:2] キャッシュミス - OCR処理開始: MAOf6MtYMx3b
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: 89953243-5d15-4270-9d46-4ec9c8b1ad5d)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 89953243-5d15-4270-9d46-4ec9c8b1ad5d)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 6
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 7
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0416ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 52秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: b269aefe-df9e-4bd9-a08a-3fdee4d1782e)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: b269aefe-df9e-4bd9-a08a-3fdee4d1782e)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 7
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 8
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.1097ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:2] CachedOcrEngine処理エラー - 総時間: 103ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:18.080] ? COMPLETE [OcrEngineExecution_0010_001717_972] Duration: 107.7ms, Memory: +17,887KB
?? [STAGE-3] 並列OCR完了 - 110ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:18.081] ?? START [OcrPostProcessing_0011_001718_081] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:18.082] ? COMPLETE [OcrPostProcessing_0011_001718_081] Duration: 1.0ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 1ms (詳細:1.0ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [STAGE-5] チャンクグルーピング完了 - 2ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 2ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 375ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 375ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 109ms (29.1%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 375ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 375.34ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 375.343ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 375.343ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:18.093] ? COMPLETE [BatchOcrProcessing_0008_001717_707] Duration: 386.2ms, Memory: +17,903KB, Info: WindowHandle:0x40C46
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 386.1728ms
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=72f6ca3a
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:18.099] ? COMPLETE [OverallProcessing_0007_001717_684] Duration: 415.3ms, Memory: +17,927KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
dbug: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      接続プールヘルスチェック: アクティブ=1, キュー=1, 利用率=12.5 %
?? [DIAGNOSTIC] レポート生成開始: reportType='flush'
?? [DIAGNOSTIC] レポートディレクトリチェック開始: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports'
? [DIAGNOSTIC] ディレクトリは既に存在
?? [DIAGNOSTIC] イベント数: 8
?? [DIAGNOSTIC] 生成ファイルパス: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports\flush_20250827_001718_flush_20.json'
?? [DIAGNOSTIC] ROI画像情報統合: 0個
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? ROI画像情報統合完了: 既存=0個, TileStrategy=0個, 合計=0個
?? [DEBUG] SafeFileWriter呼び出し前 - filePath: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports\flush_20250827_001718_flush_20.json'
?? [DEBUG] SafeFileWriter呼び出し前 - jsonContent.Length: 7175
?? [DEBUG] SafeFileWriter呼び出し前 - jsonContent IsNullOrEmpty: False
?? [DEBUG] SafeFileWriter呼び出し前 - filePath IsNullOrEmpty: False
?? [DEBUG] SafeFileWriter.AppendTextSafely実行中...
?? [DEBUG] SafeFileWriter.AppendTextSafely完了
?? [DEBUG] ファイル存在確認: True
?? [DEBUG] ファイルサイズ: 7178 bytes
info: Baketa.Infrastructure.Services.DiagnosticReportGenerator[0]
      診断レポート生成完了: C:\Users\suke0\AppData\Roaming\Baketa\Reports\flush_20250827_001718_flush_20.json, イベント数: 8
dbug: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断データフラッシュ完了: 8イベント, C:\Users\suke0\AppData\Roaming\Baketa\Reports\flush_20250827_001718_flush_20.json
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? [HEALTH_MONITOR] ヘルスチェック実行開始 - 00:17:19.523
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
warn: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      サーバープロセス異常終了を検出 - 再起動を試行
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      ?? 固定ポートモードでサーバー起動開始 (Port 5556)
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      Pythonサーバープロセス起動 - PID: 42920
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: 1b6f495e-08ce-401e-a58e-b8d0ff17a747)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 1b6f495e-08ce-401e-a58e-b8d0ff17a747)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 0
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 1
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0693ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=11, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534288394635
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=173ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=175ms
?? イベント発行: PipelineDiagnosticEvent (ID: 8d29a2a8-77b2-45d9-9b5f-c14fcb612bf3)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 8d29a2a8-77b2-45d9-9b5f-c14fcb612bf3)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 1
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 2
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.047ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=177.7813ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: 7c2d8b7d-683c-4f22-af32-7c3402ba6954)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: 7c2d8b7d-683c-4f22-af32-7c3402ba6954)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=177.7813ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=c9cf4b13, Mode=Automatic
[00:17:21.337] ?? START [OverallProcessing_0012_001721_337] OverallProcessing: 翻訳実行全体 - ID:c9cf4b13, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=c9cf4b13
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:17:21.362] ?? START [BatchOcrProcessing_0013_001721_362] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:17:21.363
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:17:21.373] ?? START [ImageTileGeneration_0014_001721_373] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 52秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 52秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 7ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:21.558] ? COMPLETE [ImageTileGeneration_0014_001721_373] Duration: 185.0ms, Memory: -18,180KB
?? [STAGE-2] タイル分割完了 - 185.0ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:21.561] ?? START [OcrEngineExecution_0015_001721_561] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: 0fIkSUYoR4y5 - 時間: 0ms, サイズ: 242984bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:3] 画像ハッシュ生成: 0fIkSUYoR4y5 - 時間: 23ms, サイズ: 242984bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: 0fIkSUYoR4y5
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:3] キャッシュミス - OCR処理開始: 0fIkSUYoR4y5
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: b7777d34-01a7-4f3b-ba29-5cd43c76771b)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: b7777d34-01a7-4f3b-ba29-5cd43c76771b)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 2
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 3
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0542ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 52秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: f33df07c-3ab5-419a-84c4-aaaae5d025e8)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: f33df07c-3ab5-419a-84c4-aaaae5d025e8)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 3
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 4
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0745ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:3] CachedOcrEngine処理エラー - 総時間: 97ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:21.663] ? COMPLETE [OcrEngineExecution_0015_001721_561] Duration: 101.5ms, Memory: +19,407KB
?? [STAGE-3] 並列OCR完了 - 104ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:21.664] ?? START [OcrPostProcessing_0016_001721_664] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:21.665] ? COMPLETE [OcrPostProcessing_0016_001721_664] Duration: 1.1ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 2ms (詳細:1.1ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 2ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 2ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 303ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 303ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 103ms (34.0%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 303ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 303.96ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 303.9634ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 303.9634ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:21.678] ? COMPLETE [BatchOcrProcessing_0013_001721_362] Duration: 315.9ms, Memory: +1,288KB, Info: WindowHandle:0x40C46
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 315.902ms
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=c9cf4b13
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:21.684] ? COMPLETE [OverallProcessing_0012_001721_337] Duration: 347.1ms, Memory: +1,312KB, Info: ImageType:WindowsImageAdapter
dbug: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      既存接続を再利用: e62a7611
dbug: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      接続をプールに返却: e62a7611
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      サーバー起動成功 - 起動時間: 2006.3694ms
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? [HEALTH_MONITOR] ヘルスチェック結果: ? 異常 - Port: 5556
?? [HEALTH_MONITOR] サーバーヘルスチェック失敗 (1/3) - Port: 5556
warn: Baketa.Infrastructure.Translation.Services.PythonServerHealthMonitor[0]
      ?? サーバーヘルスチェック失敗 (1/3) - Port: 5556
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: e24387e9-5673-490c-8a49-e1bbe2e20ccd)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: e24387e9-5673-490c-8a49-e1bbe2e20ccd)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 4
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 5
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.1367ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=12, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534325236709
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=277ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=279ms
?? イベント発行: PipelineDiagnosticEvent (ID: 4b7ddbab-028b-4c7c-b22b-e7e2b5583740)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 4b7ddbab-028b-4c7c-b22b-e7e2b5583740)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 5
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 6
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0495ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=283.275ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: f7077881-151e-4e40-a18a-ac1aa0c1490d)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: f7077881-151e-4e40-a18a-ac1aa0c1490d)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=283.275ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=90d2a01b, Mode=Automatic
[00:17:25.024] ?? START [OverallProcessing_0017_001725_024] OverallProcessing: 翻訳実行全体 - ID:90d2a01b, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=90d2a01b
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:17:25.050] ?? START [BatchOcrProcessing_0018_001725_050] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:17:25.051
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:17:25.060] ?? START [ImageTileGeneration_0019_001725_060] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 9ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:25.257] ? COMPLETE [ImageTileGeneration_0019_001725_060] Duration: 196.9ms, Memory: -13,134KB
?? [STAGE-2] タイル分割完了 - 196.9ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:25.261] ?? START [OcrEngineExecution_0020_001725_261] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: i1+uIN4KpoE1 - 時間: 0ms, サイズ: 242991bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:4] 画像ハッシュ生成: i1+uIN4KpoE1 - 時間: 27ms, サイズ: 242991bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: i1+uIN4KpoE1
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:4] キャッシュミス - OCR処理開始: i1+uIN4KpoE1
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: 3aae837a-2612-4e7f-9810-9787e17d8bfe)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 3aae837a-2612-4e7f-9810-9787e17d8bfe)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 6
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 7
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0472ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: 43afeffe-0a56-4ddc-be18-143ed532f02d)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 43afeffe-0a56-4ddc-be18-143ed532f02d)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 7
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 8
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0705ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:4] CachedOcrEngine処理エラー - 総時間: 109ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:25.374] ? COMPLETE [OcrEngineExecution_0020_001725_261] Duration: 113.6ms, Memory: +19,391KB
?? [STAGE-3] 並列OCR完了 - 116ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:25.376] ?? START [OcrPostProcessing_0021_001725_376] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:25.377] ? COMPLETE [OcrPostProcessing_0021_001725_376] Duration: 1.2ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 2ms (詳細:1.2ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 2ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 2ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 328ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 328ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 115ms (35.1%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 328ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 329.06ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 329.0622ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 329.0622ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:25.390] ? COMPLETE [BatchOcrProcessing_0018_001725_050] Duration: 340.2ms, Memory: +6,312KB, Info: WindowHandle:0x40C46
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 340.2261ms
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=90d2a01b
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:25.397] ? COMPLETE [OverallProcessing_0017_001725_024] Duration: 373.1ms, Memory: +6,336KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: 65bb9465-32d6-426e-b610-771dcaa349d7)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 65bb9465-32d6-426e-b610-771dcaa349d7)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 8
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 9
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0514ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=13, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534361068040
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=139ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=140ms
?? イベント発行: PipelineDiagnosticEvent (ID: 252fbe64-1c33-43ce-9899-dd0a2b6b12ec)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 252fbe64-1c33-43ce-9899-dd0a2b6b12ec)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 9
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 10
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0488ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=143.2809ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: 4834c8df-9d09-48c6-8d91-007e2eaf1d26)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: 4834c8df-9d09-48c6-8d91-007e2eaf1d26)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=143.2809ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=a5615829, Mode=Automatic
[00:17:28.598] ?? START [OverallProcessing_0022_001728_598] OverallProcessing: 翻訳実行全体 - ID:a5615829, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=a5615829
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:17:28.619] ?? START [BatchOcrProcessing_0023_001728_619] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:17:28.620
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:17:28.627] ?? START [ImageTileGeneration_0024_001728_627] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 6ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:28.806] ? COMPLETE [ImageTileGeneration_0024_001728_627] Duration: 178.2ms, Memory: -17,436KB
?? [STAGE-2] タイル分割完了 - 178.2ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:28.809] ?? START [OcrEngineExecution_0025_001728_809] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: 3vg66m4Pufof - 時間: 0ms, サイズ: 242645bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:5] 画像ハッシュ生成: 3vg66m4Pufof - 時間: 25ms, サイズ: 242645bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: 3vg66m4Pufof
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:5] キャッシュミス - OCR処理開始: 3vg66m4Pufof
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: 0f275c61-00be-4e55-8f77-ae72228d5eb0)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 0f275c61-00be-4e55-8f77-ae72228d5eb0)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 10
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 11
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0526ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: f5b58873-8f08-4e52-ad79-53e435c50359)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: f5b58873-8f08-4e52-ad79-53e435c50359)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 11
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 12
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.145ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:5] CachedOcrEngine処理エラー - 総時間: 96ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:28.910] ? COMPLETE [OcrEngineExecution_0025_001728_809] Duration: 100.8ms, Memory: +19,398KB
?? [STAGE-3] 並列OCR完了 - 103ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:28.912] ?? START [OcrPostProcessing_0026_001728_912] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:28.913] ? COMPLETE [OcrPostProcessing_0026_001728_912] Duration: 1.2ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 2ms (詳細:1.2ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 2ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 1ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 295ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 295ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 102ms (34.6%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 295ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 295.39ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 295.3931ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 295.3931ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:28.925] ? COMPLETE [BatchOcrProcessing_0023_001728_619] Duration: 306.0ms, Memory: +2,018KB, Info: WindowHandle:0x40C46
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 305.9693ms
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=a5615829
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:28.932] ? COMPLETE [OverallProcessing_0022_001728_598] Duration: 333.9ms, Memory: +2,042KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: 9c52d797-9633-4701-92f1-be198c158334)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 9c52d797-9633-4701-92f1-be198c158334)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 12
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 13
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0457ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=14, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534396604575
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=149ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=150ms
?? イベント発行: PipelineDiagnosticEvent (ID: 0003a90c-7d27-4706-8561-fb43d2ad0d92)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 0003a90c-7d27-4706-8561-fb43d2ad0d92)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 13
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 14
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0541ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=152.6155ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: 689d2ff0-b174-4151-a41b-374559a676ad)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: 689d2ff0-b174-4151-a41b-374559a676ad)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=152.6155ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=12333329, Mode=Automatic
[00:17:32.154] ?? START [OverallProcessing_0027_001732_154] OverallProcessing: 翻訳実行全体 - ID:12333329, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=12333329
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:17:32.175] ?? START [BatchOcrProcessing_0028_001732_175] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:17:32.176
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:17:32.185] ?? START [ImageTileGeneration_0029_001732_185] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 6ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:32.369] ? COMPLETE [ImageTileGeneration_0029_001732_185] Duration: 183.8ms, Memory: -28,352KB
?? [STAGE-2] タイル分割完了 - 183.8ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:32.372] ?? START [OcrEngineExecution_0030_001732_372] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: u850mJKgvzQF - 時間: 0ms, サイズ: 242625bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:6] 画像ハッシュ生成: u850mJKgvzQF - 時間: 24ms, サイズ: 242625bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: u850mJKgvzQF
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:6] キャッシュミス - OCR処理開始: u850mJKgvzQF
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: 44697058-179b-4dce-a811-9bbe501facbc)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 44697058-179b-4dce-a811-9bbe501facbc)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 14
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 15
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0555ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: b5f47265-b3aa-4e32-9292-fa79e9721a8e)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: b5f47265-b3aa-4e32-9292-fa79e9721a8e)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 15
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 16
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0892ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:6] CachedOcrEngine処理エラー - 総時間: 94ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:32.471] ? COMPLETE [OcrEngineExecution_0030_001732_372] Duration: 98.4ms, Memory: +18,636KB
?? [STAGE-3] 並列OCR完了 - 100ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:32.472] ?? START [OcrPostProcessing_0031_001732_472] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:32.473] ? COMPLETE [OcrPostProcessing_0031_001732_472] Duration: 1.0ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 1ms (詳細:1.0ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [STAGE-5] チャンクグルーピング完了 - 2ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 2ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 298ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 298ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 99ms (33.2%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 298ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 298.45ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 298.4524ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 298.4524ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:32.484] ? COMPLETE [BatchOcrProcessing_0028_001732_175] Duration: 308.1ms, Memory: -9,656KB, Info: WindowHandle:0x40C46
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 308.1236ms
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=12333329
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:32.489] ? COMPLETE [OverallProcessing_0027_001732_154] Duration: 334.8ms, Memory: -9,640KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: 3ebee03f-5ce2-4bca-8c70-25d2eab36838)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 3ebee03f-5ce2-4bca-8c70-25d2eab36838)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 16
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 17
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0447ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=15, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534432098232
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=149ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=151ms
?? イベント発行: PipelineDiagnosticEvent (ID: c83df218-2509-4fe6-b0fb-34a9fd11d758)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: c83df218-2509-4fe6-b0fb-34a9fd11d758)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 17
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 18
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0353ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=153.3432ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: c197a58c-0e66-4560-9db5-7fd8a3ff6804)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: c197a58c-0e66-4560-9db5-7fd8a3ff6804)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=153.3432ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=63197a74, Mode=Automatic
[00:17:35.703] ?? START [OverallProcessing_0032_001735_703] OverallProcessing: 翻訳実行全体 - ID:63197a74, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=63197a74
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:17:35.725] ?? START [BatchOcrProcessing_0033_001735_725] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:17:35.726
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:17:35.734] ?? START [ImageTileGeneration_0034_001735_734] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 11ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:35.913] ? COMPLETE [ImageTileGeneration_0034_001735_734] Duration: 178.7ms, Memory: -18,876KB
?? [STAGE-2] タイル分割完了 - 178.7ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:35.917] ?? START [OcrEngineExecution_0035_001735_917] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: j2libR3Vr0nt - 時間: 0ms, サイズ: 242956bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:7] 画像ハッシュ生成: j2libR3Vr0nt - 時間: 24ms, サイズ: 242956bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: j2libR3Vr0nt
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:7] キャッシュミス - OCR処理開始: j2libR3Vr0nt
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: 71c0ef7b-6444-45f8-897f-c942e6376fdb)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 71c0ef7b-6444-45f8-897f-c942e6376fdb)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 18
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 19
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0466ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: d811bfac-a1ee-4aed-a2cd-b9cbf7a09c1f)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: d811bfac-a1ee-4aed-a2cd-b9cbf7a09c1f)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 19
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 20
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.1219ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:7] CachedOcrEngine処理エラー - 総時間: 107ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:36.030] ? COMPLETE [OcrEngineExecution_0035_001735_917] Duration: 112.2ms, Memory: +17,910KB
?? [STAGE-3] 並列OCR完了 - 115ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:36.031] ?? START [OcrPostProcessing_0036_001736_031] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:36.032] ? COMPLETE [OcrPostProcessing_0036_001736_031] Duration: 1.0ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 1ms (詳細:1.0ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 2ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 1ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 307ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 307ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 113ms (36.8%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 307ms, チャンク数: 0
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 307.783ms, 成功: True
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 307.78ms
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 307.783ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:36.042] ? COMPLETE [BatchOcrProcessing_0033_001735_725] Duration: 317.2ms, Memory: -908KB, Info: WindowHandle:0x40C46
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 317.1832ms
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=63197a74
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:36.049] ? COMPLETE [OverallProcessing_0032_001735_703] Duration: 345.3ms, Memory: -884KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: d75f6e89-b8be-4882-8b6a-7ac93ce38736)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: d75f6e89-b8be-4882-8b6a-7ac93ce38736)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 20
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 21
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0446ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=16, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534468116283
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=148ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=149ms
?? イベント発行: PipelineDiagnosticEvent (ID: 89ec3248-7fac-4fa0-b268-5065205fa67d)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 89ec3248-7fac-4fa0-b268-5065205fa67d)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 21
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 22
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0573ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=151.6736ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: 6b2b1254-541c-49b2-a40a-4649cfd63441)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: 6b2b1254-541c-49b2-a40a-4649cfd63441)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=151.6736ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=d791f16d, Mode=Automatic
[00:17:39.306] ?? START [OverallProcessing_0037_001739_306] OverallProcessing: 翻訳実行全体 - ID:d791f16d, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=d791f16d
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:17:39.329] ?? START [BatchOcrProcessing_0038_001739_329] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:17:39.330
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:17:39.338] ?? START [ImageTileGeneration_0039_001739_338] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 7ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:39.508] ? COMPLETE [ImageTileGeneration_0039_001739_338] Duration: 169.8ms, Memory: -18,096KB
?? [STAGE-2] タイル分割完了 - 169.8ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:39.512] ?? START [OcrEngineExecution_0040_001739_512] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: hP84dMwd9poj - 時間: 0ms, サイズ: 242373bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:8] 画像ハッシュ生成: hP84dMwd9poj - 時間: 24ms, サイズ: 242373bytes
?? イベント発行: PipelineDiagnosticEvent (ID: 6611f46d-c269-4ec0-af93-8e461257a1e5)
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: hP84dMwd9poj
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:8] キャッシュミス - OCR処理開始: hP84dMwd9poj
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 6611f46d-c269-4ec0-af93-8e461257a1e5)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 22
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 23
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0399ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: 37522168-cf13-43d5-a524-3c2dfe010ad5)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 37522168-cf13-43d5-a524-3c2dfe010ad5)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 23
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 24
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0634ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:8] CachedOcrEngine処理エラー - 総時間: 94ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:39.609] ? COMPLETE [OcrEngineExecution_0040_001739_512] Duration: 97.7ms, Memory: +19,404KB
?? [STAGE-3] 並列OCR完了 - 100ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:39.611] ?? START [OcrPostProcessing_0041_001739_611] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:39.612] ? COMPLETE [OcrPostProcessing_0041_001739_611] Duration: 1.2ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 2ms (詳細:1.2ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 2ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 1ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 283ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 283ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 99ms (35.0%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 283ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 283.89ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 283.8892ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 283.8892ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:39.622] ? COMPLETE [BatchOcrProcessing_0038_001739_329] Duration: 293.0ms, Memory: +1,355KB, Info: WindowHandle:0x40C46
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 292.9702ms
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=d791f16d
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:39.628] ? COMPLETE [OverallProcessing_0037_001739_306] Duration: 322.3ms, Memory: +1,371KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: 827151ae-fbd4-4bad-afa5-ae8518743469)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 827151ae-fbd4-4bad-afa5-ae8518743469)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 24
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 25
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0516ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=17, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534503452349
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=145ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=146ms
?? イベント発行: PipelineDiagnosticEvent (ID: 843984e1-e03d-4fa9-a57a-ce32a9278be1)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 843984e1-e03d-4fa9-a57a-ce32a9278be1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 25
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 26
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0372ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=148.8713ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: 93b5b903-8437-4576-a927-893a2bfd3693)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: 93b5b903-8437-4576-a927-893a2bfd3693)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=148.8713ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=b9e72131, Mode=Automatic
[00:17:42.838] ?? START [OverallProcessing_0042_001742_838] OverallProcessing: 翻訳実行全体 - ID:b9e72131, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=b9e72131
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:17:42.859] ?? START [BatchOcrProcessing_0043_001742_859] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:17:42.860
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:17:42.867] ?? START [ImageTileGeneration_0044_001742_867] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 6ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:43.043] ? COMPLETE [ImageTileGeneration_0044_001742_867] Duration: 176.2ms, Memory: -10,895KB
?? [STAGE-2] タイル分割完了 - 176.2ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:43.047] ?? START [OcrEngineExecution_0045_001743_047] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: xxobBRtSMtqQ - 時間: 0ms, サイズ: 242517bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:9] 画像ハッシュ生成: xxobBRtSMtqQ - 時間: 23ms, サイズ: 242517bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: xxobBRtSMtqQ
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:9] キャッシュミス - OCR処理開始: xxobBRtSMtqQ
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: 4263e997-fb6c-43cc-8a40-5da8ad399757)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 4263e997-fb6c-43cc-8a40-5da8ad399757)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 26
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 27
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0391ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: b3e56d4b-ec9f-4830-ab02-0c830ec5b996)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: b3e56d4b-ec9f-4830-ab02-0c830ec5b996)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 27
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 28
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0662ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:9] CachedOcrEngine処理エラー - 総時間: 87ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:43.138] ? COMPLETE [OcrEngineExecution_0045_001743_047] Duration: 90.5ms, Memory: +19,398KB
?? [STAGE-3] 並列OCR完了 - 92ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:43.139] ?? START [OcrPostProcessing_0046_001743_139] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:43.140] ? COMPLETE [OcrPostProcessing_0046_001743_139] Duration: 1.0ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 1ms (詳細:1.0ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [STAGE-5] チャンクグルーピング完了 - 1ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 1ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 281ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 281ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 91ms (32.4%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 281ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 282.12ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 282.1168ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 282.1168ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:43.150] ? COMPLETE [BatchOcrProcessing_0043_001742_859] Duration: 291.1ms, Memory: +8,551KB, Info: WindowHandle:0x40C46
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 291.0609ms
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=b9e72131
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:43.155] ? COMPLETE [OverallProcessing_0042_001742_838] Duration: 317.7ms, Memory: +8,575KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: 8ab16adf-93d2-4eeb-80a9-aaf22efc6cf5)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 8ab16adf-93d2-4eeb-80a9-aaf22efc6cf5)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 28
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 29
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0475ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=18, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534538624472
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=138ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=139ms
?? イベント発行: PipelineDiagnosticEvent (ID: deec6e98-36eb-441d-873f-10917d22d13d)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: deec6e98-36eb-441d-873f-10917d22d13d)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 29
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 30
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0637ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=142.0839ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: e163ec5c-fa8a-4e12-89aa-902da1a3409f)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: e163ec5c-fa8a-4e12-89aa-902da1a3409f)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=142.0839ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=0db78284, Mode=Automatic
[00:17:46.353] ?? START [OverallProcessing_0047_001746_353] OverallProcessing: 翻訳実行全体 - ID:0db78284, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=0db78284
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:17:46.373] ?? START [BatchOcrProcessing_0048_001746_373] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:17:46.374
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:17:46.384] ?? START [ImageTileGeneration_0049_001746_384] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 7ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:46.561] ? COMPLETE [ImageTileGeneration_0049_001746_384] Duration: 177.7ms, Memory: -19,625KB
?? [STAGE-2] タイル分割完了 - 177.7ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:46.565] ?? START [OcrEngineExecution_0050_001746_565] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: xxobBRtSMtqQ - 時間: 0ms, サイズ: 242517bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:10] 画像ハッシュ生成: xxobBRtSMtqQ - 時間: 25ms, サイズ: 242517bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: xxobBRtSMtqQ
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:10] キャッシュミス - OCR処理開始: xxobBRtSMtqQ
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: 266c605e-8447-4f63-b23d-8345fcb8e694)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 266c605e-8447-4f63-b23d-8345fcb8e694)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 30
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 31
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0545ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: 1e1c38cf-480f-4d66-8b32-c9a825c92439)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 1e1c38cf-480f-4d66-8b32-c9a825c92439)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 31
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 32
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0622ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:10] CachedOcrEngine処理エラー - 総時間: 89ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:46.658] ? COMPLETE [OcrEngineExecution_0050_001746_565] Duration: 93.4ms, Memory: +19,405KB
?? [STAGE-3] 並列OCR完了 - 95ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:46.660] ?? START [OcrPostProcessing_0051_001746_660] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:46.661] ? COMPLETE [OcrPostProcessing_0051_001746_660] Duration: 1.2ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 2ms (詳細:1.2ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [STAGE-5] チャンクグルーピング完了 - 1ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 1ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 287ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 287ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 94ms (32.8%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 287ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 287.61ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 287.6141ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 287.6141ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:46.671] ? COMPLETE [BatchOcrProcessing_0048_001746_373] Duration: 297.6ms, Memory: -181KB, Info: WindowHandle:0x40C46
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 297.5575ms
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=0db78284
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:46.676] ? COMPLETE [OverallProcessing_0047_001746_353] Duration: 322.9ms, Memory: -164KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
dbug: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      接続プールヘルスチェック: アクティブ=1, キュー=1, 利用率=12.5 %
?? [DIAGNOSTIC] レポート生成開始: reportType='flush'
?? [DIAGNOSTIC] レポートディレクトリチェック開始: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports'
? [DIAGNOSTIC] ディレクトリは既に存在
?? [DIAGNOSTIC] イベント数: 32
?? [DIAGNOSTIC] 生成ファイルパス: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports\flush_20250827_001748_flush_20.json'
?? [DIAGNOSTIC] ROI画像情報統合: 0個
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? ROI画像情報統合完了: 既存=0個, TileStrategy=0個, 合計=0個
?? [DEBUG] SafeFileWriter呼び出し前 - filePath: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports\flush_20250827_001748_flush_20.json'
?? [DEBUG] SafeFileWriter呼び出し前 - jsonContent.Length: 24830
?? [DEBUG] SafeFileWriter呼び出し前 - jsonContent IsNullOrEmpty: False
?? [DEBUG] SafeFileWriter呼び出し前 - filePath IsNullOrEmpty: False
?? [DEBUG] SafeFileWriter.AppendTextSafely実行中...
?? [DEBUG] SafeFileWriter.AppendTextSafely完了
?? [DEBUG] ファイル存在確認: True
?? [DEBUG] ファイルサイズ: 24833 bytes
info: Baketa.Infrastructure.Services.DiagnosticReportGenerator[0]
      診断レポート生成完了: C:\Users\suke0\AppData\Roaming\Baketa\Reports\flush_20250827_001748_flush_20.json, イベント数: 32
dbug: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断データフラッシュ完了: 32イベント, C:\Users\suke0\AppData\Roaming\Baketa\Reports\flush_20250827_001748_flush_20.json
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? [HEALTH_MONITOR] ヘルスチェック実行開始 - 00:17:49.515
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: f4e61f02-6f9f-4622-80b8-332cad7275d6)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: f4e61f02-6f9f-4622-80b8-332cad7275d6)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 0
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 1
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0427ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=19, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534573816097
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=149ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=150ms
?? イベント発行: PipelineDiagnosticEvent (ID: 8a1563e0-69f8-4ddd-b744-2166d769ffb8)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 8a1563e0-69f8-4ddd-b744-2166d769ffb8)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 1
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 2
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.051ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=152.873ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
?? イベント発行: CaptureCompletedEvent (ID: a093d05a-d93f-4a3c-a6be-8e57be4dccd9)
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: a093d05a-d93f-4a3c-a6be-8e57be4dccd9)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=152.873ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=f2d66323, Mode=Automatic
[00:17:49.879] ?? START [OverallProcessing_0052_001749_879] OverallProcessing: 翻訳実行全体 - ID:f2d66323, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=f2d66323
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:17:49.904] ?? START [BatchOcrProcessing_0053_001749_904] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:17:49.905
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:17:49.915] ?? START [ImageTileGeneration_0054_001749_915] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 9ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:50.098] ? COMPLETE [ImageTileGeneration_0054_001749_915] Duration: 182.8ms, Memory: -28,445KB
?? [STAGE-2] タイル分割完了 - 182.8ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:50.102] ?? START [OcrEngineExecution_0055_001750_102] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: udNQCGo1eGDB - 時間: 0ms, サイズ: 242668bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:11] 画像ハッシュ生成: udNQCGo1eGDB - 時間: 30ms, サイズ: 242668bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: udNQCGo1eGDB
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:11] キャッシュミス - OCR処理開始: udNQCGo1eGDB
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: 90b17dfd-bda5-415d-a8a4-6fca54bf0ecd)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 90b17dfd-bda5-415d-a8a4-6fca54bf0ecd)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 2
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 3
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.1001ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: aa839286-5d5b-48fa-9739-d9f719d94a8a)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: aa839286-5d5b-48fa-9739-d9f719d94a8a)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 3
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 4
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0671ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:11] CachedOcrEngine処理エラー - 総時間: 125ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:50.232] ? COMPLETE [OcrEngineExecution_0055_001750_102] Duration: 129.7ms, Memory: +18,577KB
?? [STAGE-3] 並列OCR完了 - 132ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:50.233] ?? START [OcrPostProcessing_0056_001750_233] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:50.235] ? COMPLETE [OcrPostProcessing_0056_001750_233] Duration: 1.3ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 2ms (詳細:1.3ms), 結果領域数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? メモリ解放実行中...
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 3ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 3ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 351ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 351ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 131ms (37.3%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 351ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 352.29ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 352.2874ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 352.2874ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:50.268] ? COMPLETE [BatchOcrProcessing_0053_001749_904] Duration: 363.9ms, Memory: -28,721KB, Info: WindowHandle:0x40C46
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 363.879ms
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=f2d66323
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:50.275] ? COMPLETE [OverallProcessing_0052_001749_879] Duration: 396.5ms, Memory: -28,689KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
warn: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      サーバープロセス異常終了を検出 - 再起動を試行
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      ?? 固定ポートモードでサーバー起動開始 (Port 5556)
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      Pythonサーバープロセス起動 - PID: 30148
?? [HEALTH_MONITOR] ヘルスチェック結果: ? 正常 - Port: 5556
? [HEALTH_MONITOR] サーバー復旧確認 - 連続失敗回数リセット (1 → 0)
info: Baketa.Infrastructure.Translation.Services.PythonServerHealthMonitor[0]
      ? サーバー復旧確認 - 連続失敗回数リセット (1 → 0)
dbug: Baketa.Infrastructure.Translation.Services.PythonServerHealthMonitor[0]
      ?? [PHASE2] サーキットブレーカー統計 - State: Closed, FailureRate: 0.00 %, TotalExecutions: 0
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: 24b1adf6-2005-45e3-8b42-402f9dd331ac)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 24b1adf6-2005-45e3-8b42-402f9dd331ac)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 4
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 5
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0488ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=20, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534610495853
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=168ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=169ms
?? イベント発行: PipelineDiagnosticEvent (ID: ed5c5ef9-653f-4091-9b5e-7dfc6cd34fa8)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: ed5c5ef9-653f-4091-9b5e-7dfc6cd34fa8)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 5
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 6
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0407ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=171.8824ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: a9cdf394-5db3-4856-a06c-6e29629a9713)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: a9cdf394-5db3-4856-a06c-6e29629a9713)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=171.8824ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=ada8e5d1, Mode=Automatic
[00:17:53.548] ?? START [OverallProcessing_0057_001753_548] OverallProcessing: 翻訳実行全体 - ID:ada8e5d1, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=ada8e5d1
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:17:53.575] ?? START [BatchOcrProcessing_0058_001753_575] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:17:53.576
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:17:53.586] ?? START [ImageTileGeneration_0059_001753_586] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 10ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:53.787] ? COMPLETE [ImageTileGeneration_0059_001753_586] Duration: 201.6ms, Memory: +26KB
?? [STAGE-2] タイル分割完了 - 201.6ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:53.791] ?? START [OcrEngineExecution_0060_001753_791] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: y2b+hlM0usGj - 時間: 0ms, サイズ: 242682bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:12] 画像ハッシュ生成: y2b+hlM0usGj - 時間: 33ms, サイズ: 242682bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: y2b+hlM0usGj
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:12] キャッシュミス - OCR処理開始: y2b+hlM0usGj
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: 48298151-05f1-4cdf-abba-ea3cefc752cf)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 48298151-05f1-4cdf-abba-ea3cefc752cf)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 6
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 7
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0677ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: 32369974-4aa8-473b-a840-a71b29f3dd20)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 32369974-4aa8-473b-a840-a71b29f3dd20)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 7
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 8
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.067ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:12] CachedOcrEngine処理エラー - 総時間: 131ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:53.928] ? COMPLETE [OcrEngineExecution_0060_001753_791] Duration: 136.5ms, Memory: +18,107KB
?? [STAGE-3] 並列OCR完了 - 139ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:53.929] ?? START [OcrPostProcessing_0061_001753_929] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:53.931] ? COMPLETE [OcrPostProcessing_0061_001753_929] Duration: 1.2ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 2ms (詳細:1.2ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 2ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 2ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 357ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 357ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 138ms (38.7%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 357ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 357.61ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 357.6094ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 357.6094ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:53.945] ? COMPLETE [BatchOcrProcessing_0058_001753_575] Duration: 369.8ms, Memory: +18,181KB, Info: WindowHandle:0x40C46
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 369.7916ms
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=ada8e5d1
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:53.952] ? COMPLETE [OverallProcessing_0057_001753_548] Duration: 404.1ms, Memory: +18,202KB, Info: ImageType:WindowsImageAdapter
dbug: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      既存接続を再利用: e62a7611
dbug: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      接続をプールに返却: e62a7611
info: Baketa.Infrastructure.Translation.Local.OptimizedPythonTranslationEngine[0]
      サーバー起動成功 - 起動時間: 2005.1225ms
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: 6d5556d4-ffea-4919-b00e-399343df7bfa)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 6d5556d4-ffea-4919-b00e-399343df7bfa)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 8
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 9
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0374ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=21, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534646829337
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=133ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=135ms
?? イベント発行: PipelineDiagnosticEvent (ID: bc4ce32b-b27b-4bd7-b137-43baaf4a6870)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: bc4ce32b-b27b-4bd7-b137-43baaf4a6870)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 9
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 10
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0615ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=137.4641ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: 60bf99fd-e575-4d3b-bb47-ceb6376408eb)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: 60bf99fd-e575-4d3b-bb47-ceb6376408eb)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=137.4641ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=cb05a6e5, Mode=Automatic
[00:17:57.174] ?? START [OverallProcessing_0062_001757_174] OverallProcessing: 翻訳実行全体 - ID:cb05a6e5, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=cb05a6e5
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:17:57.194] ?? START [BatchOcrProcessing_0063_001757_194] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:17:57.195
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:17:57.203] ?? START [ImageTileGeneration_0064_001757_203] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 6ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:17:57.370] ? COMPLETE [ImageTileGeneration_0064_001757_203] Duration: 166.5ms, Memory: -18,341KB
?? [STAGE-2] タイル分割完了 - 166.5ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:17:57.373] ?? START [OcrEngineExecution_0065_001757_373] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: odkGRSTIer1n - 時間: 0ms, サイズ: 242558bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:13] 画像ハッシュ生成: odkGRSTIer1n - 時間: 24ms, サイズ: 242558bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: odkGRSTIer1n
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:13] キャッシュミス - OCR処理開始: odkGRSTIer1n
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: f0cbf64e-b3e4-40e9-bb8e-89a571ac81bb)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: f0cbf64e-b3e4-40e9-bb8e-89a571ac81bb)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 10
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 11
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.038ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: 7b764b01-0abd-4ed0-919b-f446f88fe666)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 7b764b01-0abd-4ed0-919b-f446f88fe666)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 11
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 12
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0636ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:13] CachedOcrEngine処理エラー - 総時間: 91ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:17:57.469] ? COMPLETE [OcrEngineExecution_0065_001757_373] Duration: 95.7ms, Memory: +19,398KB
?? [STAGE-3] 並列OCR完了 - 97ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:17:57.470] ?? START [OcrPostProcessing_0066_001757_470] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:17:57.471] ? COMPLETE [OcrPostProcessing_0066_001757_470] Duration: 1.1ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 2ms (詳細:1.1ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 2ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 2ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 278ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 278ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 96ms (34.5%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 278ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 278.74ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 278.7364ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 278.7364ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:17:57.483] ? COMPLETE [BatchOcrProcessing_0063_001757_194] Duration: 288.5ms, Memory: +1,114KB, Info: WindowHandle:0x40C46
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 288.5152ms
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=cb05a6e5
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:17:57.490] ? COMPLETE [OverallProcessing_0062_001757_174] Duration: 315.7ms, Memory: +1,138KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: a6fe89c6-2684-478a-91d7-b0c7baef51c4)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: a6fe89c6-2684-478a-91d7-b0c7baef51c4)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 12
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 13
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0365ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=22, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534682018805
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=147ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=148ms
?? イベント発行: PipelineDiagnosticEvent (ID: aaf799f6-d6ac-48b6-921d-4f52683aef4b)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: aaf799f6-d6ac-48b6-921d-4f52683aef4b)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 13
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 14
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0614ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=150.4425ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: 183a7137-88b8-4d0a-9d20-bea54b323aab)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: 183a7137-88b8-4d0a-9d20-bea54b323aab)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=150.4425ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=50b61e6b, Mode=Automatic
[00:18:00.701] ?? START [OverallProcessing_0067_001800_701] OverallProcessing: 翻訳実行全体 - ID:50b61e6b, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=50b61e6b
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:18:00.726] ?? START [BatchOcrProcessing_0068_001800_726] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:18:00.728
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:18:00.737] ?? START [ImageTileGeneration_0069_001800_737] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 7ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:18:00.919] ? COMPLETE [ImageTileGeneration_0069_001800_737] Duration: 181.7ms, Memory: -10,878KB
?? [STAGE-2] タイル分割完了 - 181.7ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:18:00.923] ?? START [OcrEngineExecution_0070_001800_923] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: C7gj3FkbvXwn - 時間: 0ms, サイズ: 242964bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:14] 画像ハッシュ生成: C7gj3FkbvXwn - 時間: 27ms, サイズ: 242964bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: C7gj3FkbvXwn
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:14] キャッシュミス - OCR処理開始: C7gj3FkbvXwn
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: 7851d022-da4c-4e7c-8fc1-1e5a5ff9089e)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 7851d022-da4c-4e7c-8fc1-1e5a5ff9089e)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 14
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 15
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0408ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: ab420f7d-d6d0-4e9f-ab27-21eee74feba7)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: ab420f7d-d6d0-4e9f-ab27-21eee74feba7)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 15
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 16
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0954ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:14] CachedOcrEngine処理エラー - 総時間: 108ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:18:01.036] ? COMPLETE [OcrEngineExecution_0070_001800_923] Duration: 112.7ms, Memory: +19,406KB
?? [STAGE-3] 並列OCR完了 - 115ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:18:01.038] ?? START [OcrPostProcessing_0071_001801_038] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:18:01.039] ? COMPLETE [OcrPostProcessing_0071_001801_038] Duration: 1.3ms, Memory: +8KB
?? [STAGE-4] マージ完了 - 2ms (詳細:1.3ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 2ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 2ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 314ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 314ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 114ms (36.3%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 314ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 314.45ms
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 314.4462ms, 成功: True
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 314.4462ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:18:01.053] ? COMPLETE [BatchOcrProcessing_0068_001800_726] Duration: 326.3ms, Memory: +8,567KB, Info: WindowHandle:0x40C46
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 326.3034ms
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=50b61e6b
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:18:01.060] ? COMPLETE [OverallProcessing_0067_001800_701] Duration: 359.2ms, Memory: +8,591KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: e0434820-bc78-436b-90ca-24abc7183361)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: e0434820-bc78-436b-90ca-24abc7183361)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 16
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 17
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0461ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=23, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534718205308
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=179ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=181ms
?? イベント発行: PipelineDiagnosticEvent (ID: 8f4c8bc6-448d-4775-bbc7-36e22900e65d)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 8f4c8bc6-448d-4775-bbc7-36e22900e65d)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 17
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 18
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0462ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=184.2295ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: 15548ec7-6a50-4dc8-85c1-bbdebe9a68de)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: 15548ec7-6a50-4dc8-85c1-bbdebe9a68de)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=184.2295ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=e6b903e2, Mode=Automatic
[00:18:04.315] ?? START [OverallProcessing_0072_001804_315] OverallProcessing: 翻訳実行全体 - ID:e6b903e2, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=e6b903e2
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:18:04.337] ?? START [BatchOcrProcessing_0073_001804_337] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:18:04.339
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:18:04.347] ?? START [ImageTileGeneration_0074_001804_347] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 6ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:18:04.515] ? COMPLETE [ImageTileGeneration_0074_001804_347] Duration: 168.3ms, Memory: -19,629KB
?? [STAGE-2] タイル分割完了 - 168.3ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:18:04.518] ?? START [OcrEngineExecution_0075_001804_518] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: hRM4ghhw0k6x - 時間: 0ms, サイズ: 242601bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:15] 画像ハッシュ生成: hRM4ghhw0k6x - 時間: 26ms, サイズ: 242601bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: hRM4ghhw0k6x
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:15] キャッシュミス - OCR処理開始: hRM4ghhw0k6x
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: bd74dc2c-31ca-4eaa-b2bd-c3ba2960ac23)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: bd74dc2c-31ca-4eaa-b2bd-c3ba2960ac23)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 18
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 19
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0507ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: db1be3cf-3c09-48af-8466-0fa4a5a52ac2)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: db1be3cf-3c09-48af-8466-0fa4a5a52ac2)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 19
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 20
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.056ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:15] CachedOcrEngine処理エラー - 総時間: 99ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:18:04.621] ? COMPLETE [OcrEngineExecution_0075_001804_518] Duration: 103.2ms, Memory: +18,642KB
?? [STAGE-3] 並列OCR完了 - 105ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:18:04.623] ?? START [OcrPostProcessing_0076_001804_623] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:18:04.624] ? COMPLETE [OcrPostProcessing_0076_001804_623] Duration: 1.0ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 2ms (詳細:1.0ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 1ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 1ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 286ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 286ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 104ms (36.4%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 286ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 286.66ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 286.659ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 286.659ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:18:04.634] ? COMPLETE [BatchOcrProcessing_0073_001804_337] Duration: 296.8ms, Memory: -941KB, Info: WindowHandle:0x40C46
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 296.77ms
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=e6b903e2
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:18:04.640] ? COMPLETE [OverallProcessing_0072_001804_315] Duration: 324.8ms, Memory: -909KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: 1605e40b-4d9f-4281-ae32-b317064ede8c)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 1605e40b-4d9f-4281-ae32-b317064ede8c)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 20
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 21
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0392ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=24, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534753533882
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=127ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=128ms
?? イベント発行: PipelineDiagnosticEvent (ID: 035b012b-f958-40af-b615-fa0075a11db9)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 035b012b-f958-40af-b615-fa0075a11db9)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 21
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 22
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0355ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=130.5514ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: 84c0b08e-b817-4fb2-8d23-2ccb29528c77)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: 84c0b08e-b817-4fb2-8d23-2ccb29528c77)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=130.5514ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=03d477e1, Mode=Automatic
[00:18:07.845] ?? START [OverallProcessing_0077_001807_845] OverallProcessing: 翻訳実行全体 - ID:03d477e1, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=03d477e1
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:18:07.865] ?? START [BatchOcrProcessing_0078_001807_865] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:18:07.866
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:18:07.874] ?? START [ImageTileGeneration_0079_001807_874] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 5ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:18:08.045] ? COMPLETE [ImageTileGeneration_0079_001807_874] Duration: 171.8ms, Memory: -27,601KB
?? [STAGE-2] タイル分割完了 - 171.8ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:18:08.049] ?? START [OcrEngineExecution_0080_001808_049] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: o+VxM4mV1qBP - 時間: 0ms, サイズ: 242526bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:16] 画像ハッシュ生成: o+VxM4mV1qBP - 時間: 23ms, サイズ: 242526bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: o+VxM4mV1qBP
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:16] キャッシュミス - OCR処理開始: o+VxM4mV1qBP
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: 68fa9145-b75d-483a-a0e8-49a3eabbc5fb)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 68fa9145-b75d-483a-a0e8-49a3eabbc5fb)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 22
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 23
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0419ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: c08f8080-d7e8-4610-bf06-e45acf0a29ab)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: c08f8080-d7e8-4610-bf06-e45acf0a29ab)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 23
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 24
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0536ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:16] CachedOcrEngine処理エラー - 総時間: 91ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:18:08.144] ? COMPLETE [OcrEngineExecution_0080_001808_049] Duration: 95.2ms, Memory: +17,894KB
?? [STAGE-3] 並列OCR完了 - 97ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:18:08.145] ?? START [OcrPostProcessing_0081_001808_145] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:18:08.147] ? COMPLETE [OcrPostProcessing_0081_001808_145] Duration: 1.1ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 2ms (詳細:1.1ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 1ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 1ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 282ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 282ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 96ms (34.0%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 282ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 282.90ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 282.903ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 282.903ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:18:08.158] ? COMPLETE [BatchOcrProcessing_0078_001807_865] Duration: 293.1ms, Memory: -9,634KB, Info: WindowHandle:0x40C46
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 293.1038ms
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=03d477e1
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:18:08.165] ? COMPLETE [OverallProcessing_0077_001807_845] Duration: 320.0ms, Memory: -9,610KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: ec5e6420-6a13-40fd-b3c5-8141655ded61)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: ec5e6420-6a13-40fd-b3c5-8141655ded61)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 24
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 25
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0407ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=25, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534788713646
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=126ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=127ms
?? イベント発行: PipelineDiagnosticEvent (ID: 4e6d2bb3-5e7a-483e-9354-4899d1b51856)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 4e6d2bb3-5e7a-483e-9354-4899d1b51856)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 25
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 26
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.044ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=129.7298ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: 54d8cc72-4492-42a4-8e35-262c203364d4)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: 54d8cc72-4492-42a4-8e35-262c203364d4)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=129.7298ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=02d6933a, Mode=Automatic
[00:18:11.361] ?? START [OverallProcessing_0082_001811_361] OverallProcessing: 翻訳実行全体 - ID:02d6933a, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=02d6933a
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:18:11.381] ?? START [BatchOcrProcessing_0083_001811_381] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:18:11.382
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:18:11.389] ?? START [ImageTileGeneration_0084_001811_389] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 6ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:18:11.554] ? COMPLETE [ImageTileGeneration_0084_001811_389] Duration: 165.1ms, Memory: -18,111KB
?? [STAGE-2] タイル分割完了 - 165.1ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:18:11.558] ?? START [OcrEngineExecution_0085_001811_558] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: 45gU8uAaBPRr - 時間: 0ms, サイズ: 242393bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:17] 画像ハッシュ生成: 45gU8uAaBPRr - 時間: 23ms, サイズ: 242393bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: 45gU8uAaBPRr
?? イベント発行: PipelineDiagnosticEvent (ID: 7ce36a7a-b32b-4679-a41b-d030fe4bf69d)
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:17] キャッシュミス - OCR処理開始: 45gU8uAaBPRr
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 7ce36a7a-b32b-4679-a41b-d030fe4bf69d)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 26
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 27
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0442ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: 4af11d30-1521-4ed9-a2a8-daf9316f0a77)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 4af11d30-1521-4ed9-a2a8-daf9316f0a77)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 27
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 28
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0609ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:17] CachedOcrEngine処理エラー - 総時間: 89ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:18:11.651] ? COMPLETE [OcrEngineExecution_0085_001811_558] Duration: 93.1ms, Memory: +19,398KB
?? [STAGE-3] 並列OCR完了 - 95ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:18:11.652] ?? START [OcrPostProcessing_0086_001811_652] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:18:11.653] ? COMPLETE [OcrPostProcessing_0086_001811_652] Duration: 1.0ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 1ms (詳細:1.0ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 2ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 2ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 273ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 273ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 94ms (34.4%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 273ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 273.77ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 273.7699ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 273.7699ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:18:11.664] ? COMPLETE [BatchOcrProcessing_0083_001811_381] Duration: 282.9ms, Memory: +1,340KB, Info: WindowHandle:0x40C46
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 282.9012ms
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=02d6933a
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:18:11.669] ? COMPLETE [OverallProcessing_0082_001811_361] Duration: 307.8ms, Memory: +1,372KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: 68c82314-a7c5-4610-8735-8e9d69fcdf13)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 68c82314-a7c5-4610-8735-8e9d69fcdf13)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 28
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 29
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0408ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=26, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534823738466
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=143ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=145ms
?? イベント発行: PipelineDiagnosticEvent (ID: 85ed5d35-53e3-4b59-874f-1ee0e4f816ab)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 85ed5d35-53e3-4b59-874f-1ee0e4f816ab)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 29
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 30
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0404ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=147.1796ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: 837998ff-ad60-4c41-ab21-810b329556ae)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: 837998ff-ad60-4c41-ab21-810b329556ae)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=147.1796ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=3cdaed73, Mode=Automatic
[00:18:14.868] ?? START [OverallProcessing_0087_001814_868] OverallProcessing: 翻訳実行全体 - ID:3cdaed73, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=3cdaed73
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:18:14.890] ?? START [BatchOcrProcessing_0088_001814_890] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:18:14.891
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:18:14.899] ?? START [ImageTileGeneration_0089_001814_899] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 7ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:18:15.069] ? COMPLETE [ImageTileGeneration_0089_001814_899] Duration: 170.2ms, Memory: -10,885KB
?? [STAGE-2] タイル分割完了 - 170.2ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:18:15.073] ?? START [OcrEngineExecution_0090_001815_073] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: R9DfQ7frtTl7 - 時間: 0ms, サイズ: 242622bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:18] 画像ハッシュ生成: R9DfQ7frtTl7 - 時間: 24ms, サイズ: 242622bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: R9DfQ7frtTl7
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:18] キャッシュミス - OCR処理開始: R9DfQ7frtTl7
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: db22315d-dabf-49b2-9931-f0d93fea26c5)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: db22315d-dabf-49b2-9931-f0d93fea26c5)
?? デバッグ: eventProcessors.Count = 1
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 30
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 31
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0434ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: 8f1c9145-f21d-49f6-9768-bc1a800c845e)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 8f1c9145-f21d-49f6-9768-bc1a800c845e)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 31
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 32
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0594ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:18] CachedOcrEngine処理エラー - 総時間: 98ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:18:15.175] ? COMPLETE [OcrEngineExecution_0090_001815_073] Duration: 102.4ms, Memory: +19,407KB
?? [STAGE-3] 並列OCR完了 - 104ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:18:15.176] ?? START [OcrPostProcessing_0091_001815_176] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:18:15.177] ? COMPLETE [OcrPostProcessing_0091_001815_176] Duration: 1.1ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 1ms (詳細:1.1ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 1ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 1ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 288ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 288ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 103ms (35.8%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 288ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 288.45ms
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 288.4451ms, 成功: True
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 288.4451ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:18:15.187] ? COMPLETE [BatchOcrProcessing_0088_001814_890] Duration: 297.6ms, Memory: +8,568KB, Info: WindowHandle:0x40C46
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 297.5726ms
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=3cdaed73
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:18:15.194] ? COMPLETE [OverallProcessing_0087_001814_868] Duration: 326.0ms, Memory: +8,584KB, Info: ImageType:WindowsImageAdapter
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?????? [ADAPTER] CaptureWindowAsync呼び出されました！HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      ?? 適応的キャプチャサービスアダプター: CaptureWindowAsync呼び出され - HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ開始: HWND=0x40C46
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      適応的キャプチャ開始: HWND=0x40C46
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャッシュされたGPU環境情報を使用
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      最適戦略選択開始
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      最適戦略選択開始: GPU=検出されたGPU, 統合=False, 専用=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen戦略適用可能性: False (統合GPU: False, DX11: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.ROIBasedCaptureStrategy[0]
      ROIBased戦略適用判定: True (専用GPU: True, MaxTexture: 16384)
info: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略選択: ROIBased
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      選択された戦略: ROIBased
dbug: Baketa.Infrastructure.Platform.Windows.Capture.CaptureStrategyFactory[0]
      戦略順序生成完了: 4個の戦略
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略実行中: DirectFullScreen
?? イベント発行: PipelineDiagnosticEvent (ID: 31cdddc2-24a1-4ce7-8393-8cd28af0aaa9)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 31cdddc2-24a1-4ce7-8393-8cd28af0aaa9)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 32
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 33
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0425ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      キャプチャオプションを設定: Quality=100, IncludeCursor=False, UseDwm=True
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      フルスクリーン判定: Window=1920x789, Screen=2560x1080, IsFullScreen=False
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      通常ウィンドウを検出、ウィンドウキャプチャを実行
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャを開始: 0x00040C46（Windows Graphics Capture）
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      キャプチャセッションを作成しました: SessionId=27, WindowHandle=0x00040C46
dbug: Baketa.Infrastructure.Platform.Windows.Capture.NativeWindowsCaptureWrapper[0]
      フレームキャプチャ成功: 1906x782, Timestamp=3534858743492
dbug: Baketa.Infrastructure.Platform.Windows.WindowsGraphicsCapturer[0]
      ウィンドウキャプチャが完了: 1906x782
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      ウィンドウキャプチャ完了: 処理時間=123ms
dbug: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreen最適化キャプチャ成功: 1906x782
info: Baketa.Infrastructure.Platform.Windows.Capture.Strategies.DirectFullScreenCaptureStrategy[0]
      DirectFullScreenキャプチャ成功: サイズ=1906x782, 処理時間=124ms
?? イベント発行: PipelineDiagnosticEvent (ID: a7707119-6e2b-4358-9de5-5aa8bd7f36cd)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: a7707119-6e2b-4358-9de5-5aa8bd7f36cd)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
?? [DIAGNOSTIC_PROCESSOR] イベント受信: ScreenCapture - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: ScreenCapture, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: ScreenCapture
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: ScreenCapture, 現在キューサイズ: 33
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 34
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: ScreenCapture
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: ScreenCapture
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0428ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      戦略成功: DirectFullScreen
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      メトリクス記録: 戦略=DirectFullScreen, 処理時間=126.674ms, リトライ=0
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      キャプチャ完了イベント発行準備
dbug: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? [CAPTURE_FIX] WindowsImageAdapter変換成功 - Type: WindowsImageAdapter
?? イベント発行: CaptureCompletedEvent (ID: b07e2ae2-527c-4ce2-b1ec-268923952da7)
?? イベント CaptureCompletedEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: CaptureCompletedEvent (ID: b07e2ae2-527c-4ce2-b1ec-268923952da7)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント CaptureCompletedEvent のプロセッサが登録されていません
info: Baketa.Application.Services.Capture.AdaptiveCaptureService[0]
      ?? CaptureCompletedEvent発行完了: 1906x782
info: Baketa.Application.Services.Capture.AdaptiveCaptureServiceAdapter[0]
      適応的ウィンドウキャプチャ成功: 戦略=DirectFullScreen, 処理時間=126.674ms
?? [EXECUTE_TRANSLATION] ExecuteTranslationAsync呼び出し開始: ID=ecfcae62, Mode=Automatic
[00:18:18.365] ?? START [OverallProcessing_0092_001818_365] OverallProcessing: 翻訳実行全体 - ID:ecfcae62, Mode:Automatic
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳システム可用性チェック: True
?? 座標ベース翻訳条件評価結果: True
   ?? coordinateAvailable: True
   ?? hasWindowHandle: True
   ??? isAdvancedImage: True
dbug: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ?? 座標ベース翻訳処理を実行: ID=ecfcae62
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? 座標ベース翻訳処理開始 - 画像: 1906x782, ウィンドウ: 0x40C46
?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] ProcessWithCoordinateBasedTranslationAsync開始 - 画像: 1906x782
[00:18:18.386] ?? START [BatchOcrProcessing_0093_001818_386] BatchOcrProcessing: バッチOCR処理 - 画像:1906x782
?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [BATCH-DEBUG] _performanceAnalyzer != null: True
?? [BATCH-DEBUG] _performanceAnalyzer型: AsyncPerformanceAnalyzer
?? [BATCH-DEBUG] ProcessBatchAsync呼び出し開始 - 00:18:18.387
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理開始直前 - CancellationToken.IsCancellationRequested: False
?? [PROCESS-BATCH] 入力画像型: WindowsImageAdapter (Baketa.Infrastructure.Platform.Adapters.WindowsImageAdapter)
?? [PROCESS-BATCH] 入力画像サイズ: 1906x782, Format: Rgba32
?? [STAGE-0] ProcessBatchInternalAsync開始 - 画像: 1906x782
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ?? Starting measurement for operation: BatchOcrProcessor.ProcessBatch
?? [ULTRA-DEBUG] 408行目完了 - stageTimer.Restart()実行済み
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 高性能バッチOCR処理開始 - 画像: 1906x782, ウィンドウ: 40C46
?? [ULTRA-DEBUG] 409行目実行直前 - 実行フロー確認
?? [STAGE-1] 並列OCR開始 - 画像サイズ: 1906x782
?? [ULTRA-DEBUG] 409行目実行完了 - STAGE-1ログ出力済み
?? [STAGE-2] タイル分割開始 - 目標サイズ: 1024x1024
[00:18:18.395] ?? START [ImageTileGeneration_0094_001818_395] ImageTileGeneration: タイル分割処理 - 画像:1906x782, 目標サイズ:1024
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? OcrRegionGenerator使用による戦略的領域生成開始
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? OCR領域生成開始 - 戦略: AdaptiveTile, 画像: 1906x782, 戦略クラス: AdaptiveTileStrategy
dbug: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? AdaptiveTileStrategy開始 - 画像: 1906x782
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? CachedOcrEngine: DetectTextRegionsAsync - ベースエンジンに委譲
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: DetectTextRegionsAsync実行（効率的な検出専用実装）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? PaddleOcrEngine.DetectTextRegionsAsync開始 - 高速検出専用モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? ExecuteTextDetectionOnlyAsync開始 - 高速検出モード
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 検出専用前処理完了: 1906x782 → 1906x782
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? PaddleOCR検出専用実行開始
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 最適化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ? 最適化タイムアウト設定: 15秒（検出専用高速化）
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 最適化検出タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION_OPT] 実行前Mat詳細（防御的コピー最適化版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR_OPT] PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskOptimizedでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理（最適化）でエラー発生、通常版にフォールバック
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（最適化版）（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass105_0.<ExecuteOcrInSeparateTaskOptimized>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3882
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTaskOptimized(Mat processedMat, CancellationToken cancellationToken, Int32 timeoutSeconds) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4006
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2171
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      検出専用処理でエラー発生、再試行を実行
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2055
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      テキスト検出処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: 検出専用処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: 検出専用エンジンをプールに返却 - Hash: 12162820
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      テキスト検出エラー
      Baketa.Core.Abstractions.OCR.OcrException: テキスト検出処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternal(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2080
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteDetectionOnlyInternalOptimized(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 2188
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteTextDetectionOnlyAsync(Mat mat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1982
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4141
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 4171
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 235
         at Baketa.Application.Services.CachedOcrEngine.DetectTextRegionsAsync(IImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 236
         at Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy.DetectTextRegionsAsync(IAdvancedImage image, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\Strategies\AdaptiveTileStrategy.cs:line 99
?? [EXTRACT] 画像領域抽出開始 - 座標: (0,0), サイズ: 1906x782
warn: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? テキスト検出結果が空 - 文字分割回避のため、時間はかかるが全画面OCR処理を継続
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ?? [PROPER_APPROACH] 全画面OCR戦略を開始 - 画像: 1906x782 (文字分割回避)
info: Baketa.Infrastructure.OCR.Strategies.AdaptiveTileStrategy[0]
      ? [PROPER_APPROACH] 全画面OCR領域生成完了 - 1つの完全な領域 (時間はかかるが正確)
dbug: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ?? 戦略による領域生成完了 - 領域数: 1
?? [EXTRACT] 画像領域抽出完了 - 実行時間: 6ms
info: Baketa.Infrastructure.OCR.Strategies.OcrRegionGenerator[0]
      ? OCR領域生成完了 - 戦略: AdaptiveTile, 成功: 1/1, エラー: 0
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? 戦略的領域生成完了 - 戦略: AdaptiveTile, 領域数: 1
[00:18:18.571] ? COMPLETE [ImageTileGeneration_0094_001818_395] Duration: 175.9ms, Memory: -19,867KB
?? [STAGE-2] タイル分割完了 - 175.9ms, 1個のタイル
?? [STAGE-3] 並列OCR実行開始 - タイル数: 1, 並列度: 16
?? [TILE-0] OCR開始 - 実際のタイルサイズ: 1906x782
[00:18:18.574] ?? START [OcrEngineExecution_0095_001818_574] OcrEngineExecution: PaddleOCR実行 - Tile0, サイズ:1906x782
?? [TILE-0] OCRエンジン実行直前
?? [STAGE-3] 並列OCRタスク待機開始
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? 画像ハッシュ生成: MAOf6MtYMx3b - 時間: 0ms, サイズ: 242431bytes
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:19] 画像ハッシュ生成: MAOf6MtYMx3b - 時間: 24ms, サイズ: 242431bytes
dbug: Baketa.Application.Services.Cache.AdvancedOcrCacheService[0]
      ?? キャッシュミス: MAOf6MtYMx3b
dbug: Baketa.Application.Services.CachedOcrEngine[0]
      ?? [Req:19] キャッシュミス - OCR処理開始: MAOf6MtYMx3b
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンプールから取得 - 型: NonSingletonPaddleOcrEngine, Hash: 12162820
?? イベント発行: PipelineDiagnosticEvent (ID: 6d9aa91a-f157-420c-bd63-07809bee476d)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 6d9aa91a-f157-420c-bd63-07809bee476d)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Information
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 34
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 35
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0389ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? シングルモードでOCR実行
info: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [CONFIG_UNIFIED] DetectionThreshold統一設定適用: 0.6 → 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [DETECTION_THRESHOLD_DEBUG] PaddleOCR実行時設定値:
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 言語: jpn
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 検出閾値: 0.6
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? 認識閾値: 0.3
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? GPU使用: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? マルチスレッド: False
warn: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
         ?? Image サイズ: 1906x782
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理開始: プロファイル=暗い背景, サイズ=1906x782
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 色ベースマスキング適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 色ベースマスキング完了（プール効率: HitRate=0.0 %）
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? 適応的二値化適用中（プール使用）...
dbug: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ? 適応的二値化完了（プール効率: HitRate=0.0 %）
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ?? ゲーム最適化処理完了: ColorMasking=True, AdaptiveThreshold=True, OCR精度向上=True/True/True/True, PoolObjectsUsed=0, MemoryEfficiency=0.0 %
info: Baketa.Infrastructure.Imaging.Services.GameOptimizedPreprocessingService[0]
      ゲーム最適化前処理完了: プロファイル=暗い背景
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      シングルスレッドOCRエンジンで処理実行
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? 強化OCR実行開始 - Mat防御的コピー版
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ??? 解像度ベースタイムアウト: 1906x782(1,490,492px) → 35秒 (V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? タイムアウト設定: 35秒 (基本=35, V4=False)
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? OCRエンジン実行中 - 新分離タスク
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [MAT_VALIDATION] 実行前Mat詳細（防御的コピー版）: Size=Size { Width = 1906, Height = 782 }, Type=CV_8UC3, Channels=3, Empty=False, IsContinuous=True, Step=5718
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [PADDLE_PREDICTOR_ERROR] PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      ?? [GEMINI_MAT_FIX] ExecuteOcrInSeparateTaskでエラー発生 - safeMatクリーンアップ完了
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
?? イベント発行: PipelineDiagnosticEvent (ID: 28e68023-3f9d-4747-81a0-cc5acd1809a0)
?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: PipelineDiagnosticEvent (ID: 28e68023-3f9d-4747-81a0-cc5acd1809a0)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の処理を開始 (プロセッサ数: 1)
?? デバッグ: eventProcessors.Count = 1
?? デバッグ: 登録されたプロセッサ = DiagnosticEventProcessor
?? デバッグ: DiagnosticEventProcessor は IEventProcessor<PipelineDiagnosticEvent> か? = True
?? デバッグ: DiagnosticEventProcessor が実装するインターフェース: IEventProcessor`1
?? デバッグ: 明示的型チェック後の Count = 1
?? 実際に処理するプロセッサ: DiagnosticEventProcessor
?? ExecuteProcessorAsync内でHandleAsync呼び出し: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor でイベント PipelineDiagnosticEvent の処理を開始
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? プロセッサ DiagnosticEventProcessor.HandleAsync() を実行中
?? [DIAGNOSTIC_PROCESSOR] イベント受信: OCR - Error
?? [DIAGNOSTIC_PROCESSOR] 診断収集サービスが動作中 - 処理開始
?? [DIAGNOSTIC_COLLECTION] CollectDiagnosticAsync呼び出し - Stage: OCR, IsCollecting: True, Disposed: False
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積開始 - Stage: OCR
?? [DIAGNOSTIC_COLLECTION] ProcessDiagnosticEventAsync開始 - Stage: OCR, 現在キューサイズ: 35
?? [DIAGNOSTIC_COLLECTION] イベント追加完了 - 新キューサイズ: 36
?? [DIAGNOSTIC] [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
?? [DIAGNOSTIC_COLLECTION] 即座にイベント蓄積完了 - Stage: OCR
?? [DIAGNOSTIC_PROCESSOR] 診断イベント収集完了: OCR
fail: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断イベント: [Error] OCR: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
? ExecuteProcessorAsync内でHandleAsync完了: DiagnosticEventProcessor
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? プロセッサ DiagnosticEventProcessor がイベント PipelineDiagnosticEvent を処理しました (処理時間: 0.0721ms)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント PipelineDiagnosticEvent の非ブロッキング処理を開始しました (プロセッサ数: 1)
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ? イベント PipelineDiagnosticEvent の非同期処理が完了しました (プロセッサ数: 1)
fail: Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine[0]
      OCR処理中にエラーが発生: InvalidOperationException
      System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
fail: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ? PooledOcrService: OCR処理でエラーが発生 - エンジン: NonSingletonPaddleOcrEngine
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ?? PaddleOcrEnginePoolPolicy: エンジン返却処理開始 - Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ?? PaddleOcrEngineFactory: エンジンクリーンアップ開始 - 型: NonSingletonPaddleOcrEngine
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Factory.PaddleOcrEngineFactory[0]
      ? PaddleOcrEngineFactory: エンジンクリーンアップ完了
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Pool.PaddleOcrEnginePoolPolicy[0]
      ? PaddleOcrEnginePoolPolicy: エンジン返却処理完了 - プールに復帰 Hash: 12162820
dbug: Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService[0]
      ?? PooledOcrService: エンジンをプールに返却 - Hash: 12162820
fail: Baketa.Application.Services.CachedOcrEngine[0]
      ? [Req:19] CachedOcrEngine処理エラー - 総時間: 87ms
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
?? [TILE-0] OCRエンジン例外: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
fail: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      OCRエンジン例外 - Tile 0
      Baketa.Core.Abstractions.OCR.OcrException: OCR処理中にエラーが発生しました: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
       ---> System.InvalidOperationException: PaddleOCR連続失敗のため一時的に無効化中（失敗回数: 3）
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.<>c__DisplayClass104_0.<ExecuteOcrInSeparateTask>b__0() in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3569
         at System.Threading.Tasks.Task`1.InnerInvoke()
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
      --- End of stack trace from previous location ---
         at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)
         at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
      --- End of stack trace from previous location ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrInSeparateTask(Mat processedMat, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 3762
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.ExecuteOcrAsync(Mat mat, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 1847
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 495
         --- End of inner exception stack trace ---
         at Baketa.Infrastructure.OCR.PaddleOCR.Engine.PaddleOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Engine\PaddleOcrEngine.cs:line 674
         at Baketa.Infrastructure.OCR.PaddleOCR.Services.PooledOcrService.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Infrastructure\OCR\PaddleOCR\Services\PooledOcrService.cs:line 110
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, Nullable`1 regionOfInterest, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 166
         at Baketa.Application.Services.CachedOcrEngine.RecognizeAsync(IImage image, IProgress`1 progressCallback, CancellationToken cancellationToken) in E:\dev\Baketa\Baketa.Application\Services\CachedOcrEngine.cs:line 74
         at Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor.<>c__DisplayClass23_1.<<ProcessBatchInternalAsync>b__0>d.MoveNext() in E:\dev\Baketa\Baketa.Infrastructure\OCR\BatchProcessing\BatchOcrProcessor.cs:line 491
[00:18:18.666] ? COMPLETE [OcrEngineExecution_0095_001818_574] Duration: 91.7ms, Memory: +19,403KB
?? [STAGE-3] 並列OCR完了 - 93ms全体時間, タイル数: 1
?? [STAGE-4] タイル結果マージ開始
[00:18:18.667] ?? START [OcrPostProcessing_0096_001818_667] OcrPostProcessing: タイル結果マージ - タイル数:1, 画像:1906x782
[00:18:18.668] ? COMPLETE [OcrPostProcessing_0096_001818_667] Duration: 0.9ms, Memory: +0KB
?? [STAGE-4] マージ完了 - 1ms (詳細:0.9ms), 結果領域数: 0
?? [STAGE-5] テキストチャンクのグルーピング開始
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync呼び出し前 - TextRegions数: 0
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? テキスト領域なし - 空のチャンクリストを返却
?? [CRITICAL_DEBUG] GroupTextIntoChunksAsync完了 - チャンク数: 0
?? [STAGE-5] チャンクグルーピング完了 - 1ms, チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理開始
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync呼び出し前 - 入力チャンク数: 0
?? [CRITICAL_DEBUG] ReprocessLowConfidenceChunksAsync完了 - 出力チャンク数: 0
?? [STAGE-6] 信頼度ベース再処理完了 - 2ms, チャンク数: 0
?? [STAGE-7] 誤認識修正処理開始（スキップモード）
?? [STAGE-7] 誤認識修正処理完了 - 0ms (スキップ), 最終チャンク数: 0
?? [STAGE-FINAL] ProcessBatchInternalAsync完了 - 総実行時間: 283ms

?? [PERF-SUMMARY] OCR処理完了 - 全体時間: 283ms
?? [PERF-BREAKDOWN] 段階別処理時間:
  ? タイル分割: 0ms (0.0%)
  ? ParallelOCR: 92ms (32.5%)
  ? ResultMerge: 0ms (0.0%)
  ? TextGrouping: 0ms (0.0%)
  ? ConfidenceReprocessing: 0ms (0.0%)
  ? MisrecognitionCorrection: 0ms (0.0%)
?? [PERF-SUMMARY] 最終結果: 0個のテキストチャンク

info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ? バッチOCR処理完了 - 処理時間: 283ms, チャンク数: 0
dbug: Baketa.Infrastructure.Performance.AsyncPerformanceAnalyzer[0]
      ? Operation completed successfully: BatchOcrProcessor.ProcessBatch in 283.47ms
?? [BATCH-PERF] ?? BatchOcr パフォーマンス測定完了 - 実行時間: 283.4669ms, 成功: True
info: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? BatchOcr パフォーマンス測定完了 - 実行時間: 283.4669ms, 成功: True
?? [BATCH-DEBUG] measurement.IsSuccessful=True, batchResult.Count=0
?? [BATCH-DEBUG] ProcessBatchInternalAsyncは成功したが、結果が0個
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り値準備 - IsSuccessful=True, Count=0
?? [CRITICAL_RETURN_DEBUG] ProcessBatchAsync戻り直前 - 戻り値Count=0
?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, CancellationToken.IsCancellationRequested: False
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [CRITICAL_FIX] バッチOCR処理完了直後 - ChunkCount: 0, IsCancellationRequested: False
[00:18:18.679] ? COMPLETE [BatchOcrProcessing_0093_001818_386] Duration: 292.7ms, Memory: -414KB, Info: WindowHandle:0x40C46
?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ? バッチOCR完了 - チャンク数: 0, 処理時間: 292.6792ms
?? [DEBUG] SelectMany実行開始 - textChunks.Count=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行を再開 - バッチ処理最適化済み
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] PublishOcrCompletedEventAsync呼び出し開始: チャンク数=0
?? [DEBUG] SelectMany実行完了 - positionedResults作成成功
?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
?? [DEBUG] 条件判定: positionedResults.Count=0, 条件結果=False
?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] TextResults検証: チャンク数=0, positionedResults数=0
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? OCR結果が0件のため、OCR完了イベントの発行をスキップ
dbug: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [DEBUG] OCR結果が0件のため、OCR完了イベントの発行をスキップ
info: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? [PHASE_2_2] OCR完了イベント発行完了 - 後続処理は非同期で並列実行
warn: Baketa.Application.Services.Translation.CoordinateBasedTranslationService[0]
      ?? テキストチャンクが0個のため、オーバーレイ表示をスキップ
info: Baketa.Application.Services.Translation.TranslationOrchestrationService[0]
      ? 座標ベース翻訳処理完了: ID=ecfcae62
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'UI:TranslationLanguage' が見つからないか型が一致しません。デフォルト値を返します: 英語
[00:18:18.684] ? COMPLETE [OverallProcessing_0092_001818_365] Duration: 319.1ms, Memory: -398KB, Info: ImageType:WindowsImageAdapter
dbug: Baketa.Infrastructure.Translation.Local.ConnectionPool.FixedSizeConnectionPool[0]
      接続プールヘルスチェック: アクティブ=1, キュー=1, 利用率=12.5 %
?? [DIAGNOSTIC] レポート生成開始: reportType='flush'
?? [DIAGNOSTIC] レポートディレクトリチェック開始: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports'
? [DIAGNOSTIC] ディレクトリは既に存在
?? [DIAGNOSTIC] イベント数: 36
?? [DIAGNOSTIC] 生成ファイルパス: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports\flush_20250827_001818_flush_20.json'
?? [DIAGNOSTIC] ROI画像情報統合: 0個
dbug: Baketa.Infrastructure.OCR.BatchProcessing.BatchOcrProcessor[0]
      ?? ROI画像情報統合完了: 既存=0個, TileStrategy=0個, 合計=0個
?? [DEBUG] SafeFileWriter呼び出し前 - filePath: 'C:\Users\suke0\AppData\Roaming\Baketa\Reports\flush_20250827_001818_flush_20.json'
?? [DEBUG] SafeFileWriter呼び出し前 - jsonContent.Length: 27852
?? [DEBUG] SafeFileWriter呼び出し前 - jsonContent IsNullOrEmpty: False
?? [DEBUG] SafeFileWriter呼び出し前 - filePath IsNullOrEmpty: False
?? [DEBUG] SafeFileWriter.AppendTextSafely実行中...
?? [DEBUG] SafeFileWriter.AppendTextSafely完了
?? [DEBUG] ファイル存在確認: True
?? [DEBUG] ファイルサイズ: 27855 bytes
info: Baketa.Infrastructure.Services.DiagnosticReportGenerator[0]
      診断レポート生成完了: C:\Users\suke0\AppData\Roaming\Baketa\Reports\flush_20250827_001818_flush_20.json, イベント数: 36
dbug: Baketa.Infrastructure.Services.DiagnosticCollectionService[0]
      診断データフラッシュ完了: 36イベント, C:\Users\suke0\AppData\Roaming\Baketa\Reports\flush_20250827_001818_flush_20.json
?? ExitButtonClick呼び出し
?? アプリケーション終了を実行
?? 自動翻訳ループ実行中 - キャンセル: False
   ?? 単発翻訳実行中: False
dbug: Baketa.Core.Services.EnhancedSettingsService[0]
      設定キー 'Translation:PostTranslationCooldownSeconds' が見つからないか型が一致しません。デフォルト値を返します: 3
?? ViewModelBase.PublishEventAsync開始: ConfirmationRequestEvent (ID: 8b00c0bc-210e-47cb-8d8b-faa69ac8ba53)
?? イベント発行: ConfirmationRequestEvent (ID: 8b00c0bc-210e-47cb-8d8b-faa69ac8ba53)
?? イベント ConfirmationRequestEvent のプロセッサが登録されていません
dbug: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント発行: ConfirmationRequestEvent (ID: 8b00c0bc-210e-47cb-8d8b-faa69ac8ba53)
warn: Baketa.Core.Events.Implementation.EventAggregator[0]
      ?? イベント ConfirmationRequestEvent のプロセッサが登録されていません
? ViewModelBase.PublishEventAsync呼び出し完了: ConfirmationRequestEvent
[00:18:19.204] ? COMPLETE [OverallProcessing_0001_001640_022] Duration: 99181.7ms, Memory: +36,911KB
? PERFORMANCE ALERT: OverallProcessing took 99.18 seconds
[00:18:19.206] ? アプリケーション起動完了 - 総時間: 99.18秒

================================================================================
?? PERFORMANCE SUMMARY
===================================================
OverallProcessing: 122705.3ms total, 6135.3ms avg, 20 calls
  - アプリケーション起動全体: 99181.7ms
  - 翻訳実行全体 - ID:8b3b81d2, Mode:Automatic: 17338.0ms
  - 翻訳実行全体 - ID:72f6ca3a, Mode:Automatic: 415.3ms
  - 翻訳実行全体 - ID:ada8e5d1, Mode:Automatic: 404.1ms
  - 翻訳実行全体 - ID:f2d66323, Mode:Automatic: 396.5ms
  - 翻訳実行全体 - ID:90d2a01b, Mode:Automatic: 373.1ms
  - 翻訳実行全体 - ID:50b61e6b, Mode:Automatic: 359.2ms
  - 翻訳実行全体 - ID:c9cf4b13, Mode:Automatic: 347.1ms
  - 翻訳実行全体 - ID:63197a74, Mode:Automatic: 345.3ms
  - 翻訳実行全体 - ID:12333329, Mode:Automatic: 334.8ms
  - 翻訳実行全体 - ID:a5615829, Mode:Automatic: 333.9ms
  - 翻訳実行全体 - ID:3cdaed73, Mode:Automatic: 326.0ms
  - 翻訳実行全体 - ID:e6b903e2, Mode:Automatic: 324.8ms
  - 翻訳実行全体 - ID:0db78284, Mode:Automatic: 322.9ms
  - 翻訳実行全体 - ID:d791f16d, Mode:Automatic: 322.3ms
  - 翻訳実行全体 - ID:03d477e1, Mode:Automatic: 320.0ms
  - 翻訳実行全体 - ID:ecfcae62, Mode:Automatic: 319.1ms
  - 翻訳実行全体 - ID:b9e72131, Mode:Automatic: 317.7ms
  - 翻訳実行全体 - ID:cb05a6e5, Mode:Automatic: 315.7ms
  - 翻訳実行全体 - ID:02d6933a, Mode:Automatic: 307.8ms
BatchOcrProcessing: 22916.7ms total, 1206.1ms avg, 19 calls
  - バッチOCR処理 - 画像:1906x782: 17250.1ms
  - バッチOCR処理 - 画像:1906x782: 386.2ms
  - バッチOCR処理 - 画像:1906x782: 369.8ms
  - バッチOCR処理 - 画像:1906x782: 363.9ms
  - バッチOCR処理 - 画像:1906x782: 340.2ms
  - バッチOCR処理 - 画像:1906x782: 326.3ms
  - バッチOCR処理 - 画像:1906x782: 317.2ms
  - バッチOCR処理 - 画像:1906x782: 315.9ms
  - バッチOCR処理 - 画像:1906x782: 308.1ms
  - バッチOCR処理 - 画像:1906x782: 306.0ms
  - バッチOCR処理 - 画像:1906x782: 297.6ms
  - バッチOCR処理 - 画像:1906x782: 297.6ms
  - バッチOCR処理 - 画像:1906x782: 296.8ms
  - バッチOCR処理 - 画像:1906x782: 293.1ms
  - バッチOCR処理 - 画像:1906x782: 293.0ms
  - バッチOCR処理 - 画像:1906x782: 292.7ms
  - バッチOCR処理 - 画像:1906x782: 291.1ms
  - バッチOCR処理 - 画像:1906x782: 288.5ms
  - バッチOCR処理 - 画像:1906x782: 282.9ms
ImageTileGeneration: 19519.3ms total, 1027.3ms avg, 19 calls
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 16237.6ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 251.5ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 201.6ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 196.9ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 185.0ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 183.8ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 182.8ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 181.7ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 178.7ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 178.2ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 177.7ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 176.2ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 175.9ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 171.8ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 170.2ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 169.8ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 168.3ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 166.5ms
  - タイル分割処理 - 画像:1906x782, 目標サイズ:1024: 165.1ms
OcrEngineExecution: 2800.4ms total, 147.4ms avg, 19 calls
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 924.4ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 136.5ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 129.7ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 113.6ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 112.7ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 112.2ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 107.7ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 103.2ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 102.4ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 101.5ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 100.8ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 98.4ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 97.7ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 95.7ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 95.2ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 93.4ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 93.1ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 91.7ms
  - PaddleOCR実行 - Tile0, サイズ:1906x782: 90.5ms
OcrPostProcessing: 23.0ms total, 1.2ms avg, 19 calls
  - タイル結果マージ - タイル数:1, 画像:1906x782: 3.1ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.3ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.3ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.2ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.2ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.2ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.2ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.2ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.1ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.1ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.1ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.1ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.0ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.0ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.0ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.0ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.0ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 1.0ms
  - タイル結果マージ - タイル数:1, 画像:1906x782: 0.9ms

?? TOTAL MEASURED TIME: 167964.7ms (168.0s)

================================================================================

[00:18:19.214] ?? Performance Analysis Session Ended at 2025-08-27 00:18:19
info: Baketa.UI.App[0]
      プロセス終了処理開始
info: Baketa.UI.App[0]
      プロセス終了処理完了
